 AS V1.42 Beta [Bld 232] - Source File emu8085mon_RevB03_8k.asm - Page 1 - 12/29/2022 20:41:37


       1/       0 :                     	page	0
       2/       0 :                     	CPU	Z80
       3/       0 :                     ;;; 
       4/       0 :                     ;;; Universal Monitor for Zilog Z80
       5/       0 :                     ;;;   Copyright (C) 2019,2020,2021 Haruo Asano
       6/       0 :                     ;;;
       7/       0 :                     
       8/       0 :                     ;;; 2022.10.10 It was added functions by A.honda
       9/       0 :                     ;;; Rev.B01	add trace command
      10/       0 :                     ;;; Rev.B02	add disassemble commnand
      11/       0 :                     ;;; Rev.B3	add assemble command and PaloAltoTinyBASIC
      12/       0 :                     ;;;                and GAME80 interpreter and GAME80 compiler
      13/       0 :                     
      14/       0 :                     ;;; memory map and console I/O adjusted by Gazelle
      15/       0 :                     ;;; 2022.12.13 first relrase as Rev.B03
      16/       0 :                     ;;;
      17/       0 :                     ;;; original source
      18/       0 :                     ;;; https://electrelic.com/electrelic/node/1317
      19/       0 :                     ;;; https://github.com/akih-san/EMUZ80-MON
      20/       0 :                     
      21/       0 :                     ;;; Constants
      22/       0 : =0DH                 CR	EQU	0DH
      23/       0 : =0AH                 LF	EQU	0AH
      24/       0 : =8H                  BS	EQU	08H
      25/       0 : =7FH                 DEL	EQU	7FH
      26/       0 : =1BH                 ESC	equ	1BH
      27/       0 : =28H                 BUFLEN	equ	40
      28/       0 : =7H                  NUMLEN	equ	7
      29/       0 : =8H                  F_bitSize	equ	8
      30/       0 : =4H                  NO_UPPER	equ	00000100b
      31/       0 : =2H                  NO_LF		equ	00000010b
      32/       0 : =1H                  NO_CR		equ	00000001b
      33/       0 :                     
      34/       0 :                     ;;;
      35/       0 :                     ;;; Memory switch
      36/       0 :                     ;;;
      37/       0 :                     
      38/       0 : =0H                  Fullram = 0
      39/       0 : =0H                  RAM12K = 0
      40/       0 : =1H                  RAM8K = 1
      41/       0 : =0H                  BACKDOOR = 0
      42/       0 : =1H                  UART8251 = 1
      43/       0 : =0H                  UARTPIC = 0
      44/       0 : =0H                  UARTMEM = 0
      45/       0 :                     
      46/       0 : =>FALSE              	IF	Fullram
      47/       0 :                     ; MEMORY MAP for MEZ80RAM
      48/       0 :                     WORK_B	equ	0FF00H	; work area FF00-FFFF
      49/       0 :                     STACKM	equ	0D000H	; monitor stack
      50/       0 :                     STACK	equ	0CF00H	; user stack
      51/       0 :                     ;ROM_B	equ	0D000H	;
      52/       0 :                     RAM_B	equ	08000H	;MEZ80RAM RAM base address
      53/       0 :                     RAM_E	equ	0CFFFH	;MEZ80RAM RAM END address
      54/       0 :                     ;IO_B	equ	0E000H	;
      55/       0 : [46]                 	ENDIF
      56/       0 :                     
      57/       0 : =>FALSE              	IF	RAM12K
      58/       0 :                     ;; ROM48K RAM12K for PIC18F47Q84
      59/       0 :                     UARTDR	EQU	0FF00H	; UART DATA REGISTOR
      60/       0 :                     UARTCR	EQU	0FF01H	; UART CONTROL REGISTOR
      61/       0 :                     WORK_B	equ	0EF00H	; work area EF00-EFFF
      62/       0 :                     STACKM	equ	0EF00H	; monitor stack
      63/       0 :                     STACK	equ	0EEC0H	; user stack
      64/       0 :                     ROM_B	equ	0000H	;EMUZ80_Q84 ROM base address
      65/       0 :                     RAM_B	equ	0C000H	;EMUZ80_Q84 RAM base address
      66/       0 :                     RAM_E	equ	0EFFFH	;EMUZ80_Q84 RAM END address
      67/       0 :                     IO_B	equ	0F000H	;EMUZ80_Q84 I/O base address
      68/       0 : [57]                 	ENDIF
      69/       0 :                     
      70/       0 : =>TRUE               	IF	RAM8K
      71/       0 :                     ; ORIGINAL MEMORY MAP for PIC18F47Q84
      72/       0 : =0E000H              UARTDR	EQU	0E000H	; UART DATA REGISTOR
      73/       0 : =0E001H              UARTCR	EQU	0E001H	; UART CONTROL REGISTOR
      74/       0 : =9F00H               WORK_B	equ	9F00H	; work area 9F00-9FFF
      75/       0 : =9F00H               STACKM	equ	9F00H	; monitor stack
      76/       0 : =9EC0H               STACK	equ	9EC0H	; user stack
      77/       0 : =0H                  ROM_B	equ	0000H	;EMUZ80_Q84 ROM base address
      78/       0 : =8000H               RAM_B	equ	8000H	;EMUZ80_Q84 RAM base address
      79/       0 : =9FFFH               RAM_E	equ	9FFFH	;EMUZ80_Q84 RAM END address
      80/       0 : =0E000H              IO_B	equ	0E000H	;EMUZ80_Q84 I/O base address
      81/       0 : [70]                 	ENDIF
      82/       0 :                     
      83/       0 : =3200H               BASIC_TOP	equ	3200H
      84/       0 : =3200H               BASIC_CST	equ	3200H	; basic cold start
      85/       0 : =3203H               BASIC_WST	equ	3203H	; basic warm start
      86/       0 :                     
      87/       0 : =>FALSE              	IF	RAM12K
      88/       0 :                     TIM0_CTL0	equ	0F800H	; timer0 control0 register
      89/       0 :                     TIM0_CTL1	equ	0F801H	; timer0 control1 register
      90/       0 :                     TIMER0_CNTL	equ	0F810H	; timer0 16bit counter LSB
      91/       0 :                     TIMER0_CNTH	equ	0F811H	; timer0 16bit counter MSB
      92/       0 :                     TIMER0_SCTL	equ	0F820H	; timer0 seconds counter LSB
      93/       0 :                     TIMER0_SCTH	equ	0F821H	; timer0 seconds counter MSB
      94/       0 :                     TIMER0_INITC	equ	87e1h	; timer adjust count number
      95/       0 : [87]                 	ENDIF
      96/       0 :                     
      97/       0 : =>FALSE              	IF	Fullram
      98/       0 :                     ENTRY	EQU	0D000H		; Entry point
      99/       0 : =>TRUE               	ELSE
     100/       0 : =40H                 ENTRY	EQU	0040H		; Entry point
     101/       0 : [97]                 	ENDIF
     102/       0 :                     
     103/       0 : =2000H               RAM_SIZ	EQU	(RAM_E + 1) - RAM_B
     104/       0 :                     
     105/       0 : =5B00H               PATB_TOP	equ	5B00H
     106/       0 : =5B00H               PATB_CST	equ	5B00H	; basic cold start
     107/       0 : =5B03H               PATB_WST	equ	5B03H	; basic warm start
     108/       0 :                     
     109/       0 : =5400H               GM80_CST	equ	5400H	; basic cold start
     110/       0 : =5403H               GM80_WST	equ	5403H	; basic warm start
     111/       0 :                     ;;; 
     112/       0 :                     ;;; ROM area
     113/       0 :                     ;;;
     114/       0 :                     start:
     115/       0 : =>FALSE              	IF	Fullram
     116/       0 :                     
     117/       0 :                     	org	ENTRY
     118/       0 :                     
     119/       0 :                     	ld	a,0c3h
     120/       0 :                     	ld	(00h),a
     121/       0 :                     	ld	(08h),a
     122/       0 :                     	ld	(10h),a
     123/       0 :                     	ld	(18h),a
     124/       0 :                     	ld	(30h),a
     125/       0 :                     	ld	(38h),a
     126/       0 :                     	ld	hl,CSTART
     127/       0 :                     	ld	(01h),hl
     128/       0 :                     	ld	hl,CONOUT
     129/       0 :                     	ld	(09h),hl
     130/       0 :                     	ld	hl,CONIN
     131/       0 :                     	ld	(11h),hl
     132/       0 :                     	ld	hl,CONST
     133/       0 :                     	ld	(19h),hl
     134/       0 :                     	ld	hl,RST30H_IN
     135/       0 :                     	ld	(31h),hl
     136/       0 :                     	ld	hl,RST38H_IN
     137/       0 :                     	ld	(39h),hl
     138/       0 :                     	jp	CSTART
     139/       0 :                     
     140/       0 : =>TRUE               	ELSE
     141/       0 :                     
     142/       0 :                     	ORG	ROM_B	; (RST 00H)
     143/       0 :                     
     144/       0 :                     E_CSTART:
     145/       0 : C3 40 00            	JP	cold_st
     146/       3 :                     
     147/       3 :                     E_WSTART:
     148/       3 : C3 F2 29            	JP	API01
     149/       6 :                     
     150/       6 : 00 00               	db	0008H - $ dup(00H)
     151/       8 :                     ;	ORG	0008H	; (RST 08H)
     152/       8 : =>FALSE              	IF	BACKDOOR
     153/       8 :                     	JP	RST08H
     154/       8 : =>TRUE               	ELSE
     155/       8 : C3 F9 30            	JP	CONOUT
     156/       B : [152]                	ENDIF
     157/       B :                     
     158/       B : 00 00 00 00 00      	db	0010H - $ dup(00H)
     159/      10 :                     ;	ORG	0010H	; (RST 10H)
     160/      10 : =>FALSE              	IF	BACKDOOR
     161/      10 :                     	JP	RST10H
     162/      10 : =>TRUE               	ELSE
     163/      10 : C3 EA 30            	JP	CONIN
     164/      13 : [160]                	ENDIF
     165/      13 :                     
     166/      13 : 00 00 00 00 00      	db	0018H - $ dup(00H)	; nop
     167/      18 :                     ;	ORG	0018H	; (RST 18H)
     168/      18 : =>FALSE              	IF	BACKDOOR
     169/      18 :                     	JP	RST18H
     170/      18 : =>TRUE               	ELSE
     171/      18 : C3 F4 30            	jp	CONST
     172/      1B : [168]                	ENDIF
     173/      1B :                     
     174/      1B : 00 00 00 00 00      	db	0020H - $ dup(00H)	; nop
     175/      20 :                     ;	ORG	0020H	; (RST 20H)
     176/      20 : =>FALSE              	IF	BACKDOOR
     177/      20 :                     	JP	RST20H
     178/      20 : =>TRUE               	ELSE
     179/      20 : C9                  	RET
     180/      21 : [176]                	ENDIF
     181/      21 :                     
     182/      21 : 00 00 00 00 00 00   	db	0028H - $ dup(00H)	; nop
               27 : 00                
     183/      28 :                     ;	ORG	0028H	; (RST 28H)
     184/      28 : =>FALSE              	IF	BACKDOOR
     185/      28 :                     	RET
     186/      28 : =>TRUE               	ELSE
     187/      28 : C9                  	RET
     188/      29 : [184]                	ENDIF
     189/      29 :                     
     190/      29 : 00 00 00 00 00 00   	db	0030H - $ dup(00H)	; nop
               2F : 00                
     191/      30 :                     ;	ORG	0030H
     192/      30 : =>FALSE              	IF	BACKDOOR
     193/      30 :                     	JP	RST30H
     194/      30 : =>TRUE               	ELSE
     195/      30 : C3 A7 29            	JP	RST30H_IN
     196/      33 : [192]                	ENDIF
     197/      33 :                     
     198/      33 : 00 00 00 00 00      	db	0038H - $ dup(00H)	; nop
     199/      38 :                     ;	ORG	0038H
     200/      38 : =>FALSE              	IF	BACKDOOR
     201/      38 :                     	JP	RST38H;
     202/      38 : =>TRUE               	ELSE
     203/      38 : C3 3B 2A            	JP	RST38H_IN
     204/      3B : [200]                	ENDIF
     205/      3B :                     
     206/      3B :                     	;;
     207/      3B :                     	;; Entry point
     208/      3B :                     	;;
     209/      3B :                     
     210/      3B : 00 00 00 00 00      	db	ENTRY - $ dup(00H)
     211/      40 :                     	;	ORG	ENTRY
     212/      40 :                     
     213/      40 :                     cold_st:
     214/      40 : C3 43 00            	jp	CSTART
     215/      43 :                     
     216/      43 : =>FALSE              	IF	BACKDOOR
     217/      43 :                     ;;;
     218/      43 :                     ;;; RST 08H Handler
     219/      43 :                     ;;;
     220/      43 :                     RST08H:
     221/      43 :                     
     222/      43 :                     	ld	(save_hl), hl	; save hl
     223/      43 :                     	ld	hl, (stealRST08)
     224/      43 :                     	jp	jmp_rst				;jr	jmp_rst
     225/      43 :                     
     226/      43 :                     ;;;
     227/      43 :                     ;;; RST 10H Handler
     228/      43 :                     ;;;
     229/      43 :                     RST10H:
     230/      43 :                     
     231/      43 :                     	ld	(save_hl), hl	; save hl
     232/      43 :                     	ld	hl, (stealRST10)
     233/      43 :                     	jp	jmp_rst				;jr	jmp_rst
     234/      43 :                     
     235/      43 :                     ;;;
     236/      43 :                     ;;; RST 18H Handler
     237/      43 :                     ;;;
     238/      43 :                     RST18H:
     239/      43 :                     
     240/      43 :                     	ld	(save_hl), hl	; save hl
     241/      43 :                     	ld	hl, (stealRST18)
     242/      43 :                     	jp	jmp_rst				;jr	jmp_rst
     243/      43 :                     
     244/      43 :                     ;;;
     245/      43 :                     ;;; RST 20H Handler
     246/      43 :                     ;;;
     247/      43 :                     RST20H:
     248/      43 :                     
     249/      43 :                     	ld	(save_hl), hl	; save hl
     250/      43 :                     	ld	hl, (stealRST20)
     251/      43 :                     	jp	jmp_rst				;jr	jmp_rst
     252/      43 :                     
     253/      43 :                     ;;;
     254/      43 :                     ;;; RST 28H Handler
     255/      43 :                     ;;;
     256/      43 :                     RST28H:
     257/      43 :                     
     258/      43 :                     	ld	(save_hl), hl	; save hl
     259/      43 :                     	ld	hl, (stealRST28)
     260/      43 :                     	jp	jmp_rst				;jr	jmp_rst
     261/      43 :                     
     262/      43 :                     ;;;
     263/      43 :                     ;;; RST 30H Handler
     264/      43 :                     ;;;
     265/      43 :                     RST30H:
     266/      43 :                     
     267/      43 :                     	ld	(save_hl), hl	; save hl
     268/      43 :                     	ld	hl, (stealRST30)
     269/      43 :                     	jp	jmp_rst				;jr	jmp_rst
     270/      43 :                     
     271/      43 :                     ;;;
     272/      43 :                     ;;; RST 38H Handler
     273/      43 :                     ;;;
     274/      43 :                     RST38H:
     275/      43 :                     
     276/      43 :                     	ld	(save_hl), hl	; save hl
     277/      43 :                     	ld	hl, (stealRST38)
     278/      43 :                     jmp_rst:
     279/      43 :                     	push	hl		; set jump address
     280/      43 :                     	ld	hl, (save_hl)	; restore hl
     281/      43 :                     RST20H_IN:
     282/      43 :                     RST28H_IN:
     283/      43 :                     	ret			; jump (stealRST38)
     284/      43 : [216]                	ENDIF	;ELSE BACKDOOR
     285/      43 : [115]                	ENDIF	;ELSE Fullram
     286/      43 :                     ;;;
     287/      43 :                     ;;; Universal Monitor Z80 Cold start
     288/      43 :                     ;;;
     289/      43 :                     
     290/      43 :                     CSTART:
     291/      43 : F3                  	DI
     292/      44 : 31 00 9F            	LD	SP,STACKM	; monitor stask defines STACKM
     293/      47 :                     
     294/      47 : 21 00 80            	LD	HL,RAM_B
     295/      4A : 22 00 9F            	LD	(DSADDR),HL
     296/      4D : 22 07 9F            	LD	(SADDR),HL
     297/      50 : 22 05 9F            	LD	(GADDR),HL
     298/      53 : 22 4B 9F            	ld	(asm_adr),HL
     299/      56 : 22 4D 9F            	ld	(tasm_adr),HL
     300/      59 : 3E 49               	LD	A,'I'
     301/      5B : 32 09 9F            	LD	(HEXMOD),A
     302/      5E :                     	
     303/      5E : =>FALSE              	IF	BACKDOOR
     304/      5E :                     	; init back door RST XXH entory point
     305/      5E :                     	ld	hl, CONOUT		; RST 08H : CONOUT
     306/      5E :                     	ld	(stealRST08), hl
     307/      5E :                     	ld	hl, CONIN
     308/      5E :                     	ld	(stealRST10), hl	; RST 10H : CONIN
     309/      5E :                     	ld	hl, CONST
     310/      5E :                     	ld	(stealRST18), hl	; RST 18H : CONST
     311/      5E :                     	ld	hl, RST20H_IN
     312/      5E :                     	ld	(stealRST20), hl
     313/      5E :                     	ld	hl, RST28H_IN
     314/      5E :                     	ld	(stealRST28), hl
     315/      5E :                     	ld	hl, RST30H_IN
     316/      5E :                     	ld	(stealRST30), hl
     317/      5E :                     	ld	hl, RST38H_IN
     318/      5E :                     	ld	(stealRST38), hl
     319/      5E : [303]                	ENDIF
     320/      5E :                     
     321/      5E :                     	;; Initialize register value
     322/      5E : AF                  	XOR	A
     323/      5F : 21 0C 9F            	LD	HL,REG_B
     324/      62 : 06 1A               	LD	B,REG_E-REG_B
     325/      64 :                     IR0:
     326/      64 : 77                  	LD	(HL),A
     327/      65 : 23                  	INC	HL
     328/      66 : 05                  	DEC	B			;Z80 CODE DJNZ	IR0 ############
     329/      67 : C2 64 00            	JP	NZ,IR0			;###############################
     330/      6A : 21 C0 9E            	LD	HL,STACK		; user stack define STACK
     331/      6D : 22 20 9F            	LD	(REGSP),HL
     332/      70 : 21 00 80            	ld	hl, RAM_B
     333/      73 : 22 22 9F            	ld	(REGPC), HL		; set program counter
     334/      76 :                     
     335/      76 : 06 08               	ld	b, F_bitSize
     336/      78 : 3E 2E               	ld	a, '.'
     337/      7A : 21 60 9F            	ld	hl, F_bit
     338/      7D :                     ir00:
     339/      7D : 77                  	ld	(hl), a
     340/      7E : 23                  	inc	hl
     341/      7F : 05                  	DEC	B			;Z80 CODE djnz	ir00 ###########; init F_bit string
     342/      80 : C2 7D 00            	JP	NZ,IR00			;###############################
     343/      83 : AF                  	xor	a
     344/      84 : 77                  	ld	(hl), a		; delimiter
     345/      85 :                     
     346/      85 :                     ; init dbg work area
     347/      85 :                     
     348/      85 : 06 14               	LD	B, dbg_wend - dbg_wtop
     349/      87 : 21 37 9F            	ld	hl,dbg_wtop	
     350/      8A : AF                  	XOR	A
     351/      8B :                     
     352/      8B :                     dbg_wini:
     353/      8B : 77                  	ld	(hl), a
     354/      8C : 23                  	inc	hl
     355/      8D : 05                  	DEC	B			;Z80 CODE DJNZ	dbg_wini #######
     356/      8E : C2 8B 00            	JP	NZ,dbg_wini		;###############################
     357/      91 :                     
     358/      91 : 3E 49               	ld	a, 'I'
     359/      93 : 32 31 9F            	ld	(TM_mode), a	; default call_in mode
     360/      96 : 3E 4E               	ld	a, 'N'
     361/      98 : 32 30 9F            	ld	(TP_mode), a	; default display reg mode
     362/      9B : 2E 00               	ld	l, 0
     363/      9D : 65                  	ld	h, l
     364/      9E : 22 32 9F            	ld	(TC_cnt), hl	; clear trace step counter to 0
     365/      A1 : AF                  	xor	a
     366/      A2 : 32 36 9F            	ld	(fever_t), a	; clear flag trace forever
     367/      A5 :                     	; init bp, tp, gstop address & opcode
     368/      A5 : 21 00 80            	ld	hl, RAM_B
     369/      A8 : 22 39 9F            	ld	(tpt1_adr), hl
     370/      AB : 22 3D 9F            	ld	(tpt2_adr), hl
     371/      AE : 22 41 9F            	ld	(bpt1_adr), hl
     372/      B1 : 22 45 9F            	ld	(bpt2_adr), hl
     373/      B4 : 22 49 9F            	ld	(tmpb_adr), hl
     374/      B7 : 7E                  	ld	a, (hl)
     375/      B8 : 32 38 9F            	ld	(tpt1_op), a
     376/      BB : 32 3C 9F            	ld	(tpt2_op), a
     377/      BE : 32 40 9F            	ld	(bpt1_op), a
     378/      C1 : 32 44 9F            	ld	(bpt2_op), a
     379/      C4 : 32 48 9F            	ld	(tmpb_op), a
     380/      C7 :                     	
     381/      C7 :                     ;; Opening message
     382/      C7 :                     
     383/      C7 : 21 0D 2E            	LD	HL,OPNMSG
     384/      CA : CD 23 28            	CALL	STROUT
     385/      CD :                     ;	EI
     386/      CD :                     
     387/      CD :                     WSTART:
     388/      CD : AF                  	xor	a
     389/      CE : 32 69 9F            	ld	(ky_flg), a	; clear skip LF flag
     390/      D1 :                     
     391/      D1 : 21 4A 2E            	LD	HL,PROMPT
     392/      D4 : CD 23 28            	CALL	STROUT
     393/      D7 : CD 88 28            	CALL	GETLIN
     394/      DA : CD 3B 29            	CALL	SKIPSP
     395/      DD : B7                  	OR	A
     396/      DE : CA CD 00            	JP	Z,WSTART	;JR	Z, WSTART
     397/      E1 :                     
     398/      E1 : FE 41               	CP	'A'
     399/      E3 : CA C1 1A            	JP	Z, line_asm
     400/      E6 : FE 44               	CP	'D'
     401/      E8 : CA 67 07            	JP	Z, DUMP
     402/      EB : FE 47               	CP	'G'
     403/      ED : CA 01 15            	JP	Z, GO
     404/      F0 : FE 53               	CP	'S'
     405/      F2 : CA AC 15            	JP	Z, SETM
     406/      F5 :                     
     407/      F5 : FE 4C               	CP	'L'
     408/      F7 : CA 2C 16            	JP	Z, LOADH
     409/      FA : FE 50               	CP	'P'
     410/      FC : CA 1B 17            	JP	Z, SAVEH
     411/      FF :                     
     412/      FF : FE 52               	CP	'R'
     413/     101 : CA 06 18            	JP	Z, REG
     414/     104 :                     
     415/     104 : FE 23               	cp	'#'
     416/     106 : CA 2A 01            	jp	Z, Launcher
     417/     109 :                     
     418/     109 : FE 42               	cp	'B'
     419/     10B : CA B7 02            	jp	z, brk_cmd	; break point command
     420/     10E :                     	
     421/     10E : FE 54               	cp	'T'
     422/     110 : CA 88 03            	jp	z, trace_cmd	; trace point command
     423/     113 :                     
     424/     113 : FE 3F               	cp	'?'
     425/     115 : CA 21 01            	jp	z, command_hlp	; command help message
     426/     118 :                     
     427/     118 :                     ERR:
     428/     118 : 21 67 2E            	LD	HL,ERRMSG
     429/     11B : CD 23 28            	CALL	STROUT
     430/     11E : C3 CD 00            	JP	WSTART		;JR	WSTART
     431/     121 :                     
     432/     121 :                     ;;
     433/     121 :                     ;; command help
     434/     121 :                     ;;
     435/     121 :                     command_hlp:
     436/     121 :                     
     437/     121 : 21 40 2C            	LD	HL, cmd_hlp
     438/     124 : CD 23 28            	CALL	STROUT
     439/     127 : C3 CD 00            	JP	WSTART			;JR	WSTART
     440/     12A :                     
     441/     12A :                     ;;
     442/     12A :                     ;; Launch appended program
     443/     12A :                     ;;
     444/     12A :                     Launcher:
     445/     12A : 23                  	INC	HL
     446/     12B : CD 3B 29            	CALL	SKIPSP		; A <- next char
     447/     12E : B7                  	OR	A
     448/     12F : CA 18 01            	JP	Z,ERR		;JR	Z,ERR
     449/     132 :                     
     450/     132 :                     	; check L or number
     451/     132 :                     	
     452/     132 : FE 4C               	cp	'L'
     453/     134 : CA 5E 01            	JP	Z,LST_PRG	;JR	Z,LST_PRG	; list append program
     454/     137 :                     
     455/     137 :                     	; check number
     456/     137 :                     
     457/     137 : CD 40 02            	call	GET_NUM		; return BC : number
     458/     13A : DA 18 01            	JP	C,ERR		;JR	C, ERR
     459/     13D :                     
     460/     13D :                     	; check number
     461/     13D : 79                  	LD	A, C
     462/     13E : FE 11               	CP	(lanch1 - ApendTBL)/2 +1	; a < 17 ?
     463/     140 : D2 18 01            	JP	NC, ERR
     464/     143 : B7                  	OR	A				; check '0'
     465/     144 : CA 18 01            	JP	Z, ERR
     466/     147 :                     
     467/     147 :                     	; A <- append program No.
     468/     147 :                     
     469/     147 : 3D                  	DEC	A	; 0 <= A <= 0FH
     470/     148 : 17                  	RLA		; A = A * 2
     471/     149 : 16 00               	LD	D, 0
     472/     14B : 5F                  	LD	E, A
     473/     14C : 21 7C 01            	LD	HL, ApendTBL
     474/     14F : 19                  	ADD	HL, DE	; get lanch address point
     475/     150 : 5E                  	LD	E, (HL)
     476/     151 : 23                  	INC	HL
     477/     152 : 56                  	LD	D, (HL)	; DE : JUMP POINT
     478/     153 :                     
     479/     153 :                     	; Jump to append program
     480/     153 :                     	
     481/     153 : EB                  	EX	DE, HL
     482/     154 : 5E                  	LD	E, (HL)
     483/     155 : 23                  	INC	HL
     484/     156 : 56                  	LD	D, (HL)	; DE : jump address
     485/     157 : 7A                  	LD	A, D
     486/     158 : B3                  	OR	E	; address check
     487/     159 : CA 18 01            	JP	Z,ERR		;JR	Z,ERR	; jump address NULL
     488/     15C : EB                  	EX	DE, HL
     489/     15D : E9                  	JP	(HL)	; lanch append program
     490/     15E :                     	
     491/     15E :                     	; List out append program
     492/     15E :                     LST_PRG:
     493/     15E :                     	; get address to DE
     494/     15E : 21 7C 01            	LD	HL, ApendTBL
     495/     161 :                     
     496/     161 :                     LST_PRG1:
     497/     161 : 5E                  	LD	E, (HL)
     498/     162 : 23                  	INC	HL
     499/     163 : 56                  	LD	D, (HL)
     500/     164 : 23                  	INC	HL
     501/     165 :                     
     502/     165 : E5                  	PUSH	HL			;#### ADDED ####################
     503/     166 : D5                  	PUSH	DE
     504/     167 : E1                  	POP	HL			;Z80 CODE POP	IX #############; IX <-DE
     505/     168 : 7E                  	LD	A,(HL)			;Z80 CODE LD	A, (IX+0) ######
     506/     169 : 23                  	INC	HL			;###############################
     507/     16A : B6                  	OR	(HL)			;Z80 CODE OR	(IX+1) #########
     508/     16B : E1                  	POP	HL			;#### ADDED ####################
     509/     16C : CA 79 01            	JP	Z,LST_END		;JR	Z, LST_END
     510/     16F : 13                  	INC	DE
     511/     170 : 13                  	INC	DE	; get string address
     512/     171 :                     	
     513/     171 : EB                  	EX	DE, HL
     514/     172 : CD 23 28            	CALL	STROUT
     515/     175 : EB                  	EX	DE, HL
     516/     176 : C3 61 01            	JP	lst_PRG1		;JR	LST_PRG1
     517/     179 :                     
     518/     179 :                     LST_END:
     519/     179 : C3 CD 00            	JP	WSTART
     520/     17C :                     	
     521/     17C :                     ; Append program launch table
     522/     17C :                     ;
     523/     17C :                     ApendTBL:
     524/     17C : 9C 01               	dw	lanch1
     525/     17E : B0 01               	dw	lanch2
     526/     180 : C6 01               	dw	lanch3
     527/     182 : E8 01               	dw	lanch4
     528/     184 : 0C 02               	dw	lanch5
     529/     186 : 20 02               	dw	lanch6
     530/     188 : 36 02               	dw	lanch7
     531/     18A : 36 02               	dw	lanch8
     532/     18C : 36 02               	dw	lanch9
     533/     18E : 36 02               	dw	lanch10
     534/     190 : 36 02               	dw	lanch11
     535/     192 : 36 02               	dw	lanch12
     536/     194 : 36 02               	dw	lanch13
     537/     196 : 36 02               	dw	lanch14
     538/     198 : 36 02               	dw	lanch15
     539/     19A : 36 02               	dw	lanch16
     540/     19C :                     	
     541/     19C :                     lanch1:
     542/     19C : 00 32               	dw	BASIC_CST
     543/     19E : 31 2E 20 47 42 41   	DB	"1. GBASIC Start",CR,LF,00H
              1A4 : 53 49 43 20 53 74 
              1AA : 61 72 74 0D 0A 00 
     544/     1B0 :                     lanch2:
     545/     1B0 : 03 32               	dw	BASIC_WST
     546/     1B2 : 32 2E 20 47 42 41   	DB	"2. GBASIC Restart",CR,LF,00H
              1B8 : 53 49 43 20 52 65 
              1BE : 73 74 61 72 74 0D 
              1C4 : 0A 00             
     547/     1C6 :                     
     548/     1C6 :                     lanch3:
     549/     1C6 : 00 5B               	dw	PATB_CST
     550/     1C8 : 33 2E 20 50 61 6C   	DB	"3. Palo Alto Tiny BASIC Start",CR,LF,00H
              1CE : 6F 20 41 6C 74 6F 
              1D4 : 20 54 69 6E 79 20 
              1DA : 42 41 53 49 43 20 
              1E0 : 53 74 61 72 74 0D 
              1E6 : 0A 00             
     551/     1E8 :                     		
     552/     1E8 :                     lanch4:
     553/     1E8 : 03 5B               	dw	PATB_WST
     554/     1EA : 34 2E 20 50 61 6C   	DB	"4. Palo Alto Tiny BASIC Restart",CR,LF,00H
              1F0 : 6F 20 41 6C 74 6F 
              1F6 : 20 54 69 6E 79 20 
              1FC : 42 41 53 49 43 20 
              202 : 52 65 73 74 61 72 
              208 : 74 0D 0A 00       
     555/     20C :                     
     556/     20C :                     lanch5:
     557/     20C : 00 54               	dw	GM80_CST
     558/     20E : 35 2E 20 47 41 4D   	DB	"5. GAME80 Start",CR,LF,00H
              214 : 45 38 30 20 53 74 
              21A : 61 72 74 0D 0A 00 
     559/     220 :                     		
     560/     220 :                     lanch6:
     561/     220 : 03 54               	dw	GM80_WST
     562/     222 : 36 2E 20 47 41 4D   	DB	"6. GAME80 Restart",CR,LF,00H
              228 : 45 38 30 20 52 65 
              22E : 73 74 61 72 74 0D 
              234 : 0A 00             
     563/     236 :                     
     564/     236 :                     lanch7:
     565/     236 :                     lanch8:
     566/     236 :                     lanch9:
     567/     236 :                     lanch10:
     568/     236 :                     lanch11:
     569/     236 :                     lanch12:
     570/     236 :                     lanch13:
     571/     236 :                     lanch14:
     572/     236 :                     lanch15:
     573/     236 :                     lanch16:
     574/     236 : 00 00               	dw	0
     575/     238 :                     
     576/     238 :                     GET_dNUM:
     577/     238 : D5                  	push	de
     578/     239 : E5                  	push	hl
     579/     23A : CD 40 02            	call	GET_NUM
     580/     23D : E1                  	pop	hl
     581/     23E : D1                  	pop	de
     582/     23F : C9                  	ret
     583/     240 :                     
     584/     240 :                     	; get number
     585/     240 :                     	; input HL : string buffer
     586/     240 :                     	;
     587/     240 :                     	; Return
     588/     240 :                     	; CF =1 : Error
     589/     240 :                     	; BC: Calculation result
     590/     240 :                     
     591/     240 :                     GET_NUM:
     592/     240 : AF                  	XOR	A		; Initialize C
     593/     241 : 47                  	LD	B, A
     594/     242 : 4F                  	LD	C, A		; clear BC
     595/     243 :                     	
     596/     243 :                     GET_NUM0:
     597/     243 : CD 3B 29            	CALL	SKIPSP		; A <- next char
     598/     246 : B7                  	OR	A
     599/     247 : C8                  	RET	Z		; ZF=1, ok! buffer end
     600/     248 :                     
     601/     248 : CD 67 02            	CALL	GET_BI
     602/     24B : D8                  	RET	C
     603/     24C :                     
     604/     24C : F5                  	push	af
     605/     24D : 32 9F 9F            	LD	(alt_A),A		;Z80 CODE ;AF <> AF' ##########; save A
     606/     250 : F1                  	pop	af
     607/     251 : CD 78 02            	CALL	MUL_10		; BC = BC * 10
     608/     254 : D8                  	RET	C		; overflow error
     609/     255 : 3A 9F 9F            	LD	A,(alt_A)		;Z80 CODE ;AF <> AF' ##########; restor A
     610/     258 :                     
     611/     258 : E5                  	push	hl
     612/     259 : 16 00               	ld	d, 0
     613/     25B : 5F                  	ld	e, a
     614/     25C :                     
     615/     25C : 60                  	ld	h, b
     616/     25D : 69                  	ld	l, c
     617/     25E : 19                  	add	hl, de
     618/     25F : 44                  	ld	b, h
     619/     260 : 4D                  	ld	c, l		; result: BC = BC * 10 + A
     620/     261 : E1                  	pop	hl
     621/     262 : D8                  	RET	C		; overflow error
     622/     263 :                     				; result: BC = BC * 10 + A
     623/     263 : 23                  	INC	HL
     624/     264 : C3 43 02            	JP	GET_NUM0	;JR	GET_NUM0
     625/     267 :                     ;
     626/     267 :                     ; Make binary to A
     627/     267 :                     ; ERROR if CF=1
     628/     267 :                     ;
     629/     267 :                     GET_BI:
     630/     267 : B7                  	OR	A
     631/     268 : CA 76 02            	JP	Z,UP_BI		;JR	Z, UP_BI
     632/     26B : FE 30               	CP	'0'
     633/     26D : D8                  	RET	C
     634/     26E :                     	
     635/     26E : FE 3A               	CP	'9'+1	; ASCII':'
     636/     270 : D2 76 02            	JP	NC,UP_BI	;JR	NC, UP_BI
     637/     273 : D6 30               	SUB	'0'	; Make binary to A
     638/     275 : C9                  	RET
     639/     276 :                     
     640/     276 :                     UP_BI:
     641/     276 : 37                  	SCF		; Set CF
     642/     277 : C9                  	RET
     643/     278 :                     
     644/     278 :                     ;
     645/     278 :                     ; multiply by 10
     646/     278 :                     ; BC = BC * 10
     647/     278 :                     MUL_10:
     648/     278 : E5                  	push	hl
     649/     279 : D5                  	push	de			;#### added #################
     650/     27A : 57                  	ld	d,a			;#### do not use push af ####
     651/     27B :                     
     652/     27B : C5                  	push	bc
     653/     27C : 79                  	LD	A,C			;Z80 CODE SLA	C ##############
     654/     27D : 81                  	ADD	A,C			;###############################
     655/     27E : 4F                  	LD	C,A			;###############################
     656/     27F : 78                  	LD	A,B			;Z80 CODE RL	B; 2BC #########
     657/     280 : 88                  	ADC	A,B			;###############################
     658/     281 : 47                  	LD	B,A			;###############################
     659/     282 : 79                  	LD	A,C			;Z80 CODE SLA	C ##############
     660/     283 : 81                  	ADD	A,C			;###############################
     661/     284 : 4F                  	LD	C,A			;###############################
     662/     285 : 78                  	LD	A,B			;Z80 CODE RL	B; 4BC #########
     663/     286 : 88                  	ADC	A,B			;###############################
     664/     287 : 47                  	LD	B,A			;###############################
     665/     288 : E1                  	pop	hl		; hl = bc
     666/     289 : 09                  	add	hl, bc
     667/     28A : E5                  	push	hl
     668/     28B : C1                  	pop	bc		; 5BC
     669/     28C : 79                  	LD	A,C			;Z80 CODE SLA	C ##############
     670/     28D : 81                  	ADD	A,C			;###############################
     671/     28E : 4F                  	LD	C,A			;###############################
     672/     28F : 78                  	LD	A,B			;Z80 CODE RL	B; 10BC ########
     673/     290 : 88                  	ADC	A,B			;###############################
     674/     291 : 47                  	LD	B,A			;###############################
     675/     292 : 7A                  	ld	a,d			;#### do not use pop af ########
     676/     293 : D1                  	pop	de			;#### added ####################
     677/     294 :                     
     678/     294 : E1                  	pop	hl
     679/     295 : C9                  	RET			; result : BC = BC * 10
     680/     296 :                     ;
     681/     296 :                     ; list break point
     682/     296 :                     ;
     683/     296 :                     b_list:
     684/     296 : 3A 3F 9F            	ld	a, (bpt1_f)
     685/     299 : B7                  	or	a
     686/     29A : CA A5 02            	jp	z,b_list1		;jr	z, b_list1
     687/     29D :                     
     688/     29D : 2A 41 9F            	ld	hl, (bpt1_adr)
     689/     2A0 : 3E 31               	ld	a, '1'
     690/     2A2 : CD 6E 03            	call	b_msg_out
     691/     2A5 :                     
     692/     2A5 :                     b_list1:
     693/     2A5 : 3A 43 9F            	ld	a, (bpt2_f)
     694/     2A8 : B7                  	or	a
     695/     2A9 : CA CD 00            	jp	z, WSTART
     696/     2AC :                     
     697/     2AC : 2A 45 9F            	ld	hl, (bpt2_adr)
     698/     2AF : 3E 32               	ld	a, '2'
     699/     2B1 : CD 6E 03            	call	b_msg_out
     700/     2B4 : C3 CD 00            	JP	WSTART
     701/     2B7 :                     
     702/     2B7 :                     
     703/     2B7 :                     ;;; 
     704/     2B7 :                     ;;; break point command
     705/     2B7 :                     ;;; 
     706/     2B7 :                     brk_cmd:
     707/     2B7 : 23                  	INC	HL
     708/     2B8 : CD 3B 29            	CALL	SKIPSP		; A <- next char
     709/     2BB : B7                  	OR	A
     710/     2BC : CA 96 02            	jp	z,b_list	;JR	Z,b_list	; only type "B"
     711/     2BF :                     
     712/     2BF : 01 3F 9F            	ld	bc, bpt1_f
     713/     2C2 : FE 31               	cp	'1'
     714/     2C4 : CA D7 02            	jp	z,set_bp1	;jr	z, set_bp1
     715/     2C7 :                     
     716/     2C7 : 01 43 9F            	ld	bc, bpt2_f
     717/     2CA : FE 32               	cp	'2'
     718/     2CC : CA D7 02            	jp	z,set_bp1	;jr	z, set_bp1
     719/     2CF :                     
     720/     2CF : FE 43               	cp	'C'	;clear?
     721/     2D1 : CA 1E 03            	jp	z,bp_clr	;jr	z, bp_clr
     722/     2D4 : C3 18 01            	jp	ERR
     723/     2D7 :                     
     724/     2D7 :                     set_bp1:
     725/     2D7 : E5                  	PUSH	HL			;#### ADDED ####################
     726/     2D8 : F5                  	PUSH	AF			;Z80 CODE EX	AF,AF' #########
     727/     2D9 : 2A 9E 9F            	LD	HL,(alt_AF)		;###############################
     728/     2DC : E5                  	PUSH	HL			;###############################
     729/     2DD : F1                  	POP	AF			;###############################
     730/     2DE : E1                  	POP	HL			;###############################
     731/     2DF : 22 9E 9F            	LD	(alt_AF),HL		;###############################
     732/     2E2 : E1                  	POP	HL			;###############################
     733/     2E3 :                     
     734/     2E3 : 23                  	INC	HL
     735/     2E4 : CD 3B 29            	CALL	SKIPSP		; A <- next char
     736/     2E7 : B7                  	OR	A
     737/     2E8 : CA 47 03            	jp	z,bp_LOT	;JR	Z, bp_LOT 	;; No address input -> list out
     738/     2EB : FE 2C               	cp	','
     739/     2ED : C2 18 01            	jp	nz, ERR
     740/     2F0 :                     
     741/     2F0 : 23                  	INC	HL
     742/     2F1 : CD 3B 29            	CALL	SKIPSP
     743/     2F4 : C5                  	push	bc
     744/     2F5 : CD 4C 29            	CALL	RDHEX		; 1st arg.
     745/     2F8 : E1                  	pop	hl		; hl <- bc
     746/     2F9 : DA 18 01            	jp	c, ERR
     747/     2FC :                     
     748/     2FC : CD 05 03            	call	setbpadr
     749/     2FF : DA 18 01            	jp	c, ERR
     750/     302 : C3 CD 00            	JP	WSTART
     751/     305 :                     
     752/     305 :                     
     753/     305 :                     ; hl : point of bp flag( bpt1_f or bpt2_f)
     754/     305 :                     ; de : break point address
     755/     305 :                     
     756/     305 :                     ; check ram area, and set berak point
     757/     305 :                     ; 
     758/     305 :                     setbpadr:
     759/     305 : =>FALSE              	IF	Fullram
     760/     305 : =>TRUE               	ELSE
     761/     305 : 7A                  	ld	a, d
     762/     306 : FE 80               	cp	RAM_B >> 8	; a - 0C0H
     763/     308 : DA 1C 03            	jp	c, chkERR	; ROM area
     764/     30B : FE E0               	cp	IO_B >> 8	; a - 0F0H
     765/     30D : D2 1C 03            	jp	nc, chkERR	; I/O area
     766/     310 : [759]                	ENDIF
     767/     310 : 3E 01               	ld	a,1
     768/     312 : 77                  	ld	(hl), a	; set flag
     769/     313 : 23                  	inc	hl
     770/     314 : 1A                  	ld	a, (de)		; get opcode
     771/     315 : 77                  	ld	(hl), a		; save opcode
     772/     316 : 23                  	inc	hl
     773/     317 : 73                  	ld	(hl), e ; set break point low address
     774/     318 : 23                  	inc	hl
     775/     319 : 72                  	ld	(hl), d ; set break point high address
     776/     31A : B7                  	or	a	; reset carry
     777/     31B : C9                  	ret
     778/     31C :                     
     779/     31C :                     chkERR:
     780/     31C : 37                  	scf	;set carry
     781/     31D : C9                  	ret
     782/     31E :                     
     783/     31E :                     ; clear break point
     784/     31E :                     
     785/     31E :                     bp_clr:
     786/     31E : 23                  	INC	HL
     787/     31F : CD 3B 29            	CALL	SKIPSP		; A <- next char
     788/     322 : B7                  	OR	A
     789/     323 : CA 3B 03            	jp	z,b_aclr	;JR	Z,b_aclr	; all clear
     790/     326 :                     
     791/     326 : 01 3F 9F            	ld	bc, bpt1_f
     792/     329 : FE 31               	cp	'1'
     793/     32B : CA 36 03            	jp	z,bp_clr1	;jr	z, bp_clr1
     794/     32E :                     
     795/     32E : 01 43 9F            	ld	bc, bpt2_f
     796/     331 : FE 32               	cp	'2'
     797/     333 : C2 18 01            	jp	nz, ERR
     798/     336 :                     
     799/     336 :                     bp_clr1:
     800/     336 : AF                  	xor	a
     801/     337 : 02                  	ld	(bc), a
     802/     338 : C3 CD 00            	JP	WSTART
     803/     33B :                     
     804/     33B :                     b_aclr:
     805/     33B : AF                  	xor	a
     806/     33C : 01 3F 9F            	ld	bc, bpt1_f
     807/     33F : 02                  	ld	(bc), a
     808/     340 : 01 43 9F            	ld	bc, bpt2_f
     809/     343 : 02                  	ld	(bc), a
     810/     344 : C3 CD 00            	JP	WSTART
     811/     347 :                     
     812/     347 :                     ; when no address input. list out BP
     813/     347 :                     ;
     814/     347 :                     ; bc : break pointer buffer offset
     815/     347 :                     bp_LOT:
     816/     347 : 0A                  	ld	a, (bc)		; set break point?
     817/     348 : B7                  	or	a
     818/     349 : CA CD 00            	jp	z, WSTART	; no break point setting
     819/     34C :                     
     820/     34C : F5                  	PUSH	AF			;Z80 CODE EX	AF,AF' #########
     821/     34D : 2A 9E 9F            	LD	HL,(alt_AF)		;## HL destroyed it's OK here ##
     822/     350 : E5                  	PUSH	HL			;###############################
     823/     351 : F1                  	POP	AF			;###############################
     824/     352 : E1                  	POP	HL			;###############################
     825/     353 : 22 9E 9F            	LD	(alt_AF),HL		;###############################
     826/     356 : 2A 41 9F            	ld	hl, (bpt1_adr)
     827/     359 : FE 31               	cp	'1'
     828/     35B : CA 61 03            	jp	z,l_b2			;jr	z, l_b2
     829/     35E : 2A 45 9F            	ld	hl, (bpt2_adr)
     830/     361 :                     l_b2:
     831/     361 : CD 6E 03            	call	b_msg_out
     832/     364 : C3 CD 00            	JP	WSTART
     833/     367 :                     
     834/     367 : 42 50 28 00         bp_msg1:	db	"BP(",00H
     835/     36B : 29 3A 00            bp_msg2:	db	"):",00H
     836/     36E :                     
     837/     36E :                     b_msg_out:
     838/     36E : E5                  	push	hl
     839/     36F : F5                  	push	af
     840/     370 : 21 67 03            	ld	hl, bp_msg1
     841/     373 : CD 23 28            	call	STROUT
     842/     376 : F1                  	pop	af
     843/     377 : CD F9 30            	call	CONOUT
     844/     37A : 21 6B 03            	ld	hl, bp_msg2
     845/     37D : CD 23 28            	call	STROUT
     846/     380 : E1                  	pop	hl
     847/     381 : CD 2D 28            	call	HEXOUT4
     848/     384 : CD 71 28            	call	CRLF	
     849/     387 : C9                  	ret
     850/     388 :                     
     851/     388 :                     ;;; 
     852/     388 :                     ;;; trace command
     853/     388 :                     ;;; 
     854/     388 :                     trace_cmd:
     855/     388 :                     
     856/     388 :                     ; T[address][,step]
     857/     388 :                     ; TP[ON | OFF]
     858/     388 :                     ; TM[I | S]
     859/     388 :                     
     860/     388 :                     ; init steps
     861/     388 : E5                  	push	hl
     862/     389 : 2E 00               	ld	l, 0
     863/     38B : 26 00               	ld	h, 0
     864/     38D : 22 32 9F            	ld	(TC_cnt), hl	; clear trace step counter to 0
     865/     390 : 2A 22 9F            	ld	hl,(REGPC)
     866/     393 : 22 34 9F            	ld	(tmpT), hl	; init temp address
     867/     396 : AF                  	xor	a
     868/     397 : 32 36 9F            	ld	(fever_t), a	; clear flag trace forever
     869/     39A :                     
     870/     39A : E1                  	pop	hl
     871/     39B : 23                  	inc	hl
     872/     39C : CD 3B 29            	CALL	SKIPSP
     873/     39F : CD 4C 29            	CALL	RDHEX		; 1st arg.
     874/     3A2 : D2 55 04            	jp	nc, tadr_chk
     875/     3A5 : CD 3B 29            	CALL	SKIPSP
     876/     3A8 : 7E                  	ld	a, (hl)
     877/     3A9 : B7                  	or	a
     878/     3AA : CA 84 04            	jp	z, t_op1	; only 1 step trace, check opcode
     879/     3AD : FE 2C               	cp	','
     880/     3AF : CA 69 04            	jp	z, stp_chk	; steps check
     881/     3B2 :                     
     882/     3B2 : FE 50               	cp	'P'
     883/     3B4 : CA 08 04            	jp	z,tp_cmd	;jr	z, tp_cmd
     884/     3B7 : FE 4D               	cp	'M'
     885/     3B9 : C2 18 01            	jp	nz, ERR
     886/     3BC :                     	
     887/     3BC :                     	; tm_cmd
     888/     3BC :                     	
     889/     3BC : 23                  	inc	hl
     890/     3BD : CD 3B 29            	CALL	SKIPSP		; A <- next char
     891/     3C0 :                     dip_TM:
     892/     3C0 : 21 FA 03            	ld	hl, tm_msg_i
     893/     3C3 : FE 49               	cp	'I'
     894/     3C5 : CA DA 03            	jp	z,set_TM	;jr	z, set_TM
     895/     3C8 : 21 00 04            	ld	hl, tm_msg_s
     896/     3CB : FE 53               	cp	'S'
     897/     3CD : CA DA 03            	jp	z,set_TM	;jr	z, set_TM
     898/     3D0 : B7                  	or	a
     899/     3D1 : C2 18 01            	jp	nz, ERR
     900/     3D4 :                     
     901/     3D4 :                     ;display T mode
     902/     3D4 : 3A 31 9F            	ld	a, (TM_mode)
     903/     3D7 : C3 C0 03            	jp	dip_TM		;jr	dip_TM
     904/     3DA :                     
     905/     3DA :                     ;set TM mode and display
     906/     3DA :                     set_TM:
     907/     3DA : 32 31 9F            	ld	(TM_mode),a
     908/     3DD : E5                  	push	hl
     909/     3DE : 21 EB 03            	ld	hl, tm_msg_0
     910/     3E1 : CD 23 28            	call	STROUT
     911/     3E4 : E1                  	pop	hl
     912/     3E5 : CD 23 28            	call	STROUT
     913/     3E8 : C3 CD 00            	jp	WSTART
     914/     3EB :                     
     915/     3EB :                     tm_msg_0:
     916/     3EB : 54 4D 20 6D 6F 64   	db	"TM mode:<CALL ", 00h
              3F1 : 65 3A 3C 43 41 4C 
              3F7 : 4C 20 00          
     917/     3FA :                     tm_msg_i:
     918/     3FA : 49 4E 3E 0D 0A 00   	db	"IN>", CR, LF, 00h
     919/     400 :                     tm_msg_s:
     920/     400 : 53 4B 49 50 3E 0D   	db	"SKIP>", CR, LF, 00h
              406 : 0A 00             
     921/     408 :                     	
     922/     408 :                     	
     923/     408 :                     	; tp_cmd
     924/     408 :                     tp_cmd:	
     925/     408 : 23                  	inc	hl
     926/     409 : CD 3B 29            	CALL	SKIPSP		; A <- next char
     927/     40C : B7                  	or	a
     928/     40D : C2 16 04            	jp	nz,tp_n1	;jr	nz, tp_n1
     929/     410 : 3A 30 9F            	ld	a, (TP_mode)
     930/     413 : C3 1F 04            	jp	tp_n2		;jr	tp_n2
     931/     416 :                     	
     932/     416 :                     tp_n1:
     933/     416 : FE 4F               	cp	'O'
     934/     418 : C2 18 01            	jp	nz, ERR
     935/     41B : 23                  	inc	hl
     936/     41C : CD 3B 29            	CALL	SKIPSP		; A <- next char
     937/     41F :                     
     938/     41F :                     tp_n2:
     939/     41F : 21 4A 04            	ld	hl, tp_msg_on
     940/     422 : FE 4E               	cp	'N'
     941/     424 : CA 2F 04            	jp	z,tp_md_on	;jr	z, tp_md_on
     942/     427 :                     
     943/     427 : 21 4F 04            	ld	hl, tp_msg_off
     944/     42A : FE 46               	cp	'F'
     945/     42C : C2 18 01            	jp	nz, ERR
     946/     42F :                     
     947/     42F :                     tp_md_on:
     948/     42F :                     	; set trace mode and display mode
     949/     42F : 32 30 9F            	ld	(TP_mode), a
     950/     432 : E5                  	push	hl
     951/     433 : 21 40 04            	ld	hl, tp_msg_0
     952/     436 : CD 23 28            	call	STROUT
     953/     439 : E1                  	pop	hl
     954/     43A : CD 23 28            	call	STROUT
     955/     43D : C3 CD 00            	jp	WSTART
     956/     440 :                     
     957/     440 :                     tp_msg_0:
     958/     440 : 54 50 20 6D 6F 64   	db	"TP mode: ", 00h
              446 : 65 3A 20 00       
     959/     44A :                     tp_msg_on:
     960/     44A : 4F 4E 0D 0A 00      	db	"ON", CR, LF, 00h
     961/     44F :                     tp_msg_off:
     962/     44F : 4F 46 46 0D 0A 00   	db	"OFF", CR, LF, 00h
     963/     455 :                     
     964/     455 :                     tadr_chk:
     965/     455 : EB                  	EX	DE,HL			;Z80 CODE ld	(tmpT), de #####; set start address
     966/     456 : 22 34 9F            	LD	(tmpT),HL		;###############################
     967/     459 : EB                  	EX	DE,HL			;###############################
     968/     45A : CD 3B 29            	CALL	SKIPSP		; A <- next char
     969/     45D : B7                  	or	a
     970/     45E : CA 84 04            	jp	z,t_op1		;jr	z, t_op1	; 1step trace
     971/     461 : FE 2C               	cp	','
     972/     463 : CA 69 04            	jp	z,stp_chk	;jr	z, stp_chk
     973/     466 : C3 18 01            	jp	ERR
     974/     469 :                     
     975/     469 :                     stp_chk:
     976/     469 : 23                  	inc	hl
     977/     46A : CD 3B 29            	CALL	SKIPSP		; A <- next char
     978/     46D : B7                  	or	a
     979/     46E : CA 18 01            	jp	z, ERR
     980/     471 : FE 2D               	cp	'-'
     981/     473 : CA 8A 04            	jp	z,chk_fevre	;jr	z, chk_fevre
     982/     476 :                     
     983/     476 :                     ; check steps
     984/     476 :                     
     985/     476 : CD 40 02            	call	GET_NUM		; get steps to BC
     986/     479 : DA 18 01            	JP	C, ERR		; number error
     987/     47C :                     
     988/     47C :                     t_op11:
     989/     47C : 60                  	LD	H,B			;Z80 CODE ld	(TC_cnt), bc	; set trace step counter
     990/     47D : 69                  	LD	L,C			;## HL destroyed it's ok here ##
     991/     47E : 22 32 9F            	LD	(TC_cnt),HL		;###############################
     992/     481 : C3 A0 04            	jp	t_op_chk
     993/     484 :                     
     994/     484 :                     t_op1:
     995/     484 : 01 01 00            	ld	bc, 1
     996/     487 : C3 7C 04            	jp	t_op11		;jr	t_op11
     997/     48A :                     
     998/     48A :                     chk_fevre:
     999/     48A : 23                  	inc	hl
    1000/     48B : CD 3B 29            	CALL	SKIPSP		; A <- next char
    1001/     48E : FE 31               	cp	'1'
    1002/     490 : C2 18 01            	jp	nz, ERR
    1003/     493 : 23                  	inc	hl
    1004/     494 : CD 3B 29            	CALL	SKIPSP		; A <- next char
    1005/     497 : B7                  	or	a
    1006/     498 : C2 18 01            	jp	nz, ERR		; not "-1" then error
    1007/     49B : 3E 01               	ld	a, 1
    1008/     49D : 32 36 9F            	ld	(fever_t), a	; set flag trace forever
    1009/     4A0 :                     
    1010/     4A0 :                     t_op_chk:
    1011/     4A0 : 2A 34 9F            	ld	hl, (tmpT)	; get PC address
    1012/     4A3 : 7E                  	ld	a, (hl)		; get opcode
    1013/     4A4 :                     	
    1014/     4A4 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1015/     4A4 :                     ;;;
    1016/     4A4 :                     ;;; branch opecode check
    1017/     4A4 :                     ;;;
    1018/     4A4 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1019/     4A4 :                     
    1020/     4A4 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1021/     4A4 :                     ; 2 insertion Trace code(TC) 
    1022/     4A4 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1023/     4A4 :                     INSTC2:
    1024/     4A4 :                     	; check 1 byte machine code: branch (RET CC)
    1025/     4A4 :                     
    1026/     4A4 : 01 08 00            	ld	bc, RETCC_TBLE - RETCC_TBLS
    1027/     4A7 : 21 6F 06            	ld	hl, RETCC_TBLS
    1028/     4AA : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    1029/     4AD : C2 C3 04            	jp	nz,next_bc1		;jr	nz, next_bc1	; not RET CC
    1030/     4B0 :                     
    1031/     4B0 :                     	; RET CC
    1032/     4B0 :                     	; trace operation:
    1033/     4B0 :                     	;   1. ea = *REGSP; *ea = TC;
    1034/     4B0 :                     	;   2. ea = *REGPC; *(ea+1) = TC;
    1035/     4B0 :                     
    1036/     4B0 :                     	; 1
    1037/     4B0 : 0E 01               	ld	c, 1		; first TC point
    1038/     4B2 : CD 33 06            	call	insBRK_sp
    1039/     4B5 : DA EA 05            	jp	c, err_trace_seq
    1040/     4B8 :                     	
    1041/     4B8 :                     	; 2
    1042/     4B8 : 0E 02               	ld	c, 2		; second TC point
    1043/     4BA : CD 11 06            	call	insBRK_1op
    1044/     4BD : DA EA 05            	jp	c, err_trace_seq
    1045/     4C0 :                     
    1046/     4C0 : C3 E7 05            	jp	END_INS_TC
    1047/     4C3 :                     
    1048/     4C3 :                     	; check 2 byte machine code: branch (JR CC, Relative Value)
    1049/     4C3 :                     next_bc1:
    1050/     4C3 :                     
    1051/     4C3 : 01 05 00            	ld	bc, JRCC_TBLE - JRCC_TBLS
    1052/     4C6 : 21 77 06            	ld	hl, JRCC_TBLS
    1053/     4C9 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    1054/     4CC : C2 E8 04            	jp	nz,next_bc2		;jr	nz, next_bc2	; not JR CC
    1055/     4CF :                     
    1056/     4CF :                     	; JR CC, nn
    1057/     4CF :                     	; trace operation:
    1058/     4CF :                     	;   1. ea = *REGPC; *(ea + 2 + *(ea+1)) = TC;
    1059/     4CF :                     	;   2. ea = *REGPC; *(ea+2) = TC;
    1060/     4CF :                     
    1061/     4CF :                     	; 1
    1062/     4CF : 0E 01               	ld	c, 1		; first TC point
    1063/     4D1 : 2A 34 9F            	ld	hl, (tmpT)
    1064/     4D4 : CD FE 05            	call	Rel_adr_c
    1065/     4D7 : CD 41 06            	call	inadr_chk_and_wrt
    1066/     4DA : DA EA 05            	jp	c, err_trace_seq
    1067/     4DD :                     
    1068/     4DD :                     	; 2
    1069/     4DD : 0E 02               	ld	c, 2		; second TC point
    1070/     4DF : CD 17 06            	call	insBRK_2op
    1071/     4E2 : DA EA 05            	jp	c, err_trace_seq
    1072/     4E5 :                     
    1073/     4E5 : C3 E7 05            	jp	END_INS_TC
    1074/     4E8 :                     
    1075/     4E8 :                     	; check 3 byte machine code: branch JP CC, nnnn 16bit literal)
    1076/     4E8 :                     
    1077/     4E8 :                     next_bc2:
    1078/     4E8 : 01 08 00            	ld	bc, JPCC_TBLE - JPCC_TBLS
    1079/     4EB : 21 7C 06            	ld	hl, JPCC_TBLS
    1080/     4EE : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    1081/     4F1 : C2 F9 04            	jp	nz,next_bc21		;jr	nz, next_bc21		; not JP CCC
    1082/     4F4 :                     
    1083/     4F4 :                     	; JP CC, nnnn
    1084/     4F4 :                     	; trace operation:
    1085/     4F4 :                     	;   1. ea = *REGPC; *((short *)(ea+1)) = TC;
    1086/     4F4 :                     	;   2. ea = *REGPC; *(ea+3) = TC;
    1087/     4F4 :                     
    1088/     4F4 : 0E 01               	ld	c, 1		; first TC point
    1089/     4F6 : C3 0F 05            	jp	next_bc222		;jr	next_bc222
    1090/     4F9 :                     
    1091/     4F9 :                     	; check 3 byte machine code: branch (CALL CC, nnnn 16bit literal)
    1092/     4F9 :                     
    1093/     4F9 :                     next_bc21:
    1094/     4F9 : 01 08 00            	ld	bc, CLCC_TBLE - CLCC_TBLS
    1095/     4FC : 21 84 06            	ld	hl, CLCC_TBLS
    1096/     4FF : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    1097/     502 : C2 20 05            	jp	nz,INSTC1		;jr	nz, INSTC1		; not CALL CCC
    1098/     505 :                     
    1099/     505 :                     	; CALL CC, nnnn
    1100/     505 :                     	; trace operation:
    1101/     505 :                     	; TM_mode = 'I'
    1102/     505 :                     	;   1. ea = *REGPC; *((short *)(ea+1)) = TC;
    1103/     505 :                     	;   2. ea = *REGPC; *(ea+3) = TC;
    1104/     505 :                     	;
    1105/     505 :                     	; TM_mode = 'S'
    1106/     505 :                     	;   2. ea = *REGPC; *(ea+3) = TC;
    1107/     505 :                     
    1108/     505 : 0E 01               	ld	c, 1		; first TC point
    1109/     507 : 3A 31 9F            	ld	a, (TM_mode)
    1110/     50A : FE 53               	cp	'S'
    1111/     50C : CA 17 05            	jp	z,next_bc22	;jr	z, next_bc22	; skip insertion 1.
    1112/     50F :                     
    1113/     50F :                     next_bc222:
    1114/     50F :                     	; 1. ea = *REGPC; *((char *)(ea+1)) = TC;
    1115/     50F : CD 27 06            	call	insBRK_brp
    1116/     512 : DA EA 05            	jp	c, err_trace_seq
    1117/     515 :                     	
    1118/     515 :                     next_bc221:
    1119/     515 :                     	; 2. ea = *REGPC; *(ea+3) = TC;
    1120/     515 : 0E 02               	ld	c, 2		; second TC point
    1121/     517 :                     next_bc22:
    1122/     517 : CD 1D 06            	call	insBRK_3op
    1123/     51A : DA EA 05            	jp	c, err_trace_seq
    1124/     51D :                     
    1125/     51D : C3 E7 05            	jp	END_INS_TC
    1126/     520 :                     
    1127/     520 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1128/     520 :                     ; 1 insertion Trace code(TC) 
    1129/     520 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1130/     520 :                     INSTC1:
    1131/     520 :                     	; check 1 byte machine code: branch (return)
    1132/     520 : FE C9               	cp	0C9H		; RET ?
    1133/     522 : C2 30 05            	jp	nz,next_bc3		;jr	nz, next_bc3	; not RET
    1134/     525 :                     
    1135/     525 :                     	; RET
    1136/     525 :                     	; trace operation:
    1137/     525 :                     	;   ea = *REGSP; *ea = TC;
    1138/     525 : 0E 01               	ld	c, 1		; first TC point
    1139/     527 : CD 33 06            	call	insBRK_sp
    1140/     52A : DA EA 05            	jp	c, err_trace_seq
    1141/     52D : C3 E7 05            	jp	END_INS_TC
    1142/     530 :                     
    1143/     530 :                     	; check RST p
    1144/     530 :                     next_bc3:
    1145/     530 : 01 08 00            	ld	bc, RST_TBLE - RST_TBLS
    1146/     533 : 21 8C 06            	ld	hl, RST_TBLS
    1147/     536 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    1148/     539 : C2 47 05            	jp	nz,next_bc4		;jr	nz, next_bc4		; not RST p
    1149/     53C :                     
    1150/     53C :                     	; RST p
    1151/     53C :                     	; can't trace: skip trace
    1152/     53C :                     	; trace operation:
    1153/     53C :                     	;   ea = *REGPC; *(ea+1) = TC;
    1154/     53C :                     ;	ld	hl, RST_DMSG
    1155/     53C :                     ;	call	STROUT		; message out "DETECT RST OPCODE"
    1156/     53C : 0E 01               	ld	c, 1		; first TC point
    1157/     53E : CD 11 06            	call	insBRK_1op
    1158/     541 : DA EA 05            	jp	c, err_trace_seq
    1159/     544 :                     	
    1160/     544 : C3 E7 05            	jp	END_INS_TC
    1161/     547 :                     
    1162/     547 :                     ;RST_DMSG:
    1163/     547 :                     ;	db	"(RST nn) WILL BE SKIPPED. AND TRACE NEXT OPCODE", CR, LF,00
    1164/     547 :                     
    1165/     547 :                     	; check code 0EDH
    1166/     547 :                     next_bc4:
    1167/     547 : FE ED               	cp	0EDH		; CODE 0EDH ?
    1168/     549 : C2 63 05            	jp	nz,next_bc5	;jr	nz, next_bc5	; not 0EDH
    1169/     54C :                     
    1170/     54C : 23                  	inc	hl
    1171/     54D : 7E                  	ld	a, (hl)
    1172/     54E : FE 45               	cp	45H		; RETN?
    1173/     550 : CA 58 05            	jp	z,next_bc6	;jr	z, next_bc6	; yes, RETN
    1174/     553 : FE 4D               	cp	4DH		; RETI?
    1175/     555 : C2 63 05            	jp	nz,next_bc5	;jr	nz, next_bc5	; not RETN
    1176/     558 :                     
    1177/     558 :                     	; trace operation:
    1178/     558 :                     	;   ea = *REGSP; *ea = TC;
    1179/     558 :                     next_bc6:
    1180/     558 : 0E 01               	ld	c, 1		; first TC point
    1181/     55A : CD 33 06            	call	insBRK_sp
    1182/     55D : DA EA 05            	jp	c,err_trace_seq	;jr	c, err_trace_seq
    1183/     560 : C3 E7 05            	jp	END_INS_TC	;jr	END_INS_TC
    1184/     563 :                     
    1185/     563 :                     	; check JP (HL)
    1186/     563 :                     next_bc5:
    1187/     563 : 2A 34 9F            	ld	hl, (tmpT)
    1188/     566 : 7E                  	ld	a, (hl)
    1189/     567 :                     
    1190/     567 : FE E9               	cp	0E9H		; JP (HL) ?
    1191/     569 : C2 7A 05            	jp	nz,next_bc7	;jr	nz, next_bc7	; not JP (HL)
    1192/     56C :                     
    1193/     56C :                     	; JP (HL)
    1194/     56C :                     	; trace operation:
    1195/     56C :                     	;   ea = *REGHL; *ea = TC;
    1196/     56C : 2A 12 9F            	ld	hl, (REGHL)
    1197/     56F :                     djphl:
    1198/     56F : 0E 01               	ld	c, 1		; first TC point
    1199/     571 : CD 41 06            	call	inadr_chk_and_wrt
    1200/     574 : DA EA 05            	jp	c,err_trace_seq	;jr	c, err_trace_seq
    1201/     577 : C3 E7 05            	jp	END_INS_TC	;jr	END_INS_TC
    1202/     57A :                     
    1203/     57A :                     	; check JP (IX)
    1204/     57A :                     next_bc7:
    1205/     57A : FE DD               	cp	0DDH		; 1st OPOCDE 0DDH ?
    1206/     57C : C2 8C 05            	jp	nz,next_bc8	;jr	nz, next_bc8	; no 0DDH
    1207/     57F : 23                  	inc	hl
    1208/     580 : 7E                  	ld	a, (hl)
    1209/     581 : FE E9               	cp	0E9H		; JP (IX) ?
    1210/     583 : C2 8C 05            	jp	nz,next_bc8	;jr	nz, next_bc8	; not JP (IX)
    1211/     586 :                     
    1212/     586 :                     	; JP (IX)
    1213/     586 :                     	; trace operation:
    1214/     586 :                     	;   ea = *REGIX; *ea = TC;
    1215/     586 : 2A 1C 9F            	ld	hl, (REGIX)
    1216/     589 : C3 6F 05            	jp	djphl		;jr	djphl
    1217/     58C :                     
    1218/     58C :                     	; check JP (IY)
    1219/     58C :                     next_bc8:
    1220/     58C : 2A 34 9F            	ld	hl, (tmpT)
    1221/     58F : 7E                  	ld	a, (hl)
    1222/     590 :                     
    1223/     590 : FE FD               	cp	0FDH		; 1st OPOCDE 0FDH ?
    1224/     592 : C2 A2 05            	jp	nz,next_bc9	;jr	nz, next_bc9	; no 0FDH
    1225/     595 : 23                  	inc	hl
    1226/     596 : 7E                  	ld	a, (hl)
    1227/     597 : FE E9               	cp	0E9H		; JP (IX) ?
    1228/     599 : C2 A2 05            	jp	nz,next_bc9	;jr	nz, next_bc9	; not JP (IX)
    1229/     59C :                     
    1230/     59C :                     	; JP (IY)
    1231/     59C :                     	; trace operation:
    1232/     59C :                     	;   ea = *REGIY; *ea = TC;
    1233/     59C : 2A 1E 9F            	ld	hl, (REGIY)
    1234/     59F : C3 6F 05            	jp	djphl		;jr	djphl
    1235/     5A2 :                     
    1236/     5A2 :                     	; check JR relative
    1237/     5A2 :                     next_bc9:
    1238/     5A2 : 2A 34 9F            	ld	hl, (tmpT)
    1239/     5A5 : 7E                  	ld	a, (hl)
    1240/     5A6 : FE 18               	cp	18H		; JR relative ?
    1241/     5A8 : C2 B9 05            	jp	nz,next_bc10	;jr	nz, next_bc10	; not JR relative
    1242/     5AB :                     
    1243/     5AB :                     	; JR Relative
    1244/     5AB :                     	; trace operation:
    1245/     5AB :                     	;   ea = *REGPC; *(ea + 2 + *(ea+1)) = TC;
    1246/     5AB : 0E 01               	ld	c, 1		; first TC point
    1247/     5AD : CD FE 05            	call	Rel_adr_c
    1248/     5B0 : CD 41 06            	call	inadr_chk_and_wrt
    1249/     5B3 : DA EA 05            	jp	c,err_trace_seq	;jr	c, err_trace_seq
    1250/     5B6 : C3 E7 05            	jp	END_INS_TC	;jr	END_INS_TC
    1251/     5B9 :                     
    1252/     5B9 :                     	; check JP literal
    1253/     5B9 :                     next_bc10:
    1254/     5B9 : FE C3               	cp	0C3H		; JP literal ?
    1255/     5BB : C2 C9 05            	jp	nz,next_bc11	;jr	nz, next_bc11	; not JP literal
    1256/     5BE :                     
    1257/     5BE :                     	; JP literal
    1258/     5BE :                     	; trace operation:
    1259/     5BE :                     	; ea = *REGPC; *((char *)(ea+1)) = TC;
    1260/     5BE : 0E 01               	ld	c, 1		; first TC point
    1261/     5C0 : CD 27 06            	call	insBRK_brp
    1262/     5C3 : DA EA 05            	jp	c,err_trace_seq	;jr	c, err_trace_seq
    1263/     5C6 : C3 E7 05            	jp	END_INS_TC	;jr	END_INS_TC
    1264/     5C9 :                     
    1265/     5C9 :                     	; check call literal
    1266/     5C9 :                     next_bc11:
    1267/     5C9 : FE CD               	cp	0CDH		; CALL literal ?
    1268/     5CB : C2 94 06            	jp	nz, INS2	; no, check not branch opcode 
    1269/     5CE :                     
    1270/     5CE :                     	; CALL literal
    1271/     5CE :                     	; trace operation:
    1272/     5CE :                     	; TM_mode = 'I'
    1273/     5CE :                     	;   ea = *REGPC; *((short *)(ea+1)) = TC;
    1274/     5CE :                     	; TM_mode = 'S'
    1275/     5CE :                     	;   2. ea = *REGPC; *(ea+3) = TC;
    1276/     5CE :                     
    1277/     5CE : 0E 01               	ld	c, 1		; first TC point
    1278/     5D0 : 3A 31 9F            	ld	a, (TM_mode)
    1279/     5D3 : FE 53               	cp	'S'
    1280/     5D5 : CA C9 05            	jp	z,next_bc11	;jr	z, next_bc111	; yes, TM_mode='S'
    1281/     5D8 :                     
    1282/     5D8 :                     	; TM_mode = 'I'
    1283/     5D8 :                     	; ea = *REGPC; *((char *)(ea+1)) = TC;
    1284/     5D8 : CD 27 06            	call	insBRK_brp
    1285/     5DB : DA EA 05            	jp	c,err_trace_seq	;jr	c, err_trace_seq
    1286/     5DE : C3 E7 05            	jp	END_INS_TC	;jr	END_INS_TC
    1287/     5E1 :                     
    1288/     5E1 :                     	; TM_mode = 'S'
    1289/     5E1 :                     	; ea = *REGPC; *(ea+3) = TC;
    1290/     5E1 :                     next_bc111:
    1291/     5E1 : CD 1D 06            	call	insBRK_3op
    1292/     5E4 : DA EA 05            	jp	c,err_trace_seq	;jr	c, err_trace_seq
    1293/     5E7 :                     
    1294/     5E7 :                     END_INS_TC:
    1295/     5E7 : C3 48 15            	jp	G0	; go, trace operation
    1296/     5EA :                     
    1297/     5EA :                     err_trace_seq:
    1298/     5EA : 21 F4 05            	ld	hl, terr_msg
    1299/     5ED : CD 23 28            	call	STROUT
    1300/     5F0 : C3 CD 00            	JP	WSTART
    1301/     5F3 : FF                  	rst	38h
    1302/     5F4 :                     ;	
    1303/     5F4 : 41 64 72 20 45 52   terr_msg:	db	"Adr ERR", CR, LF, 00H
              5FA : 52 0D 0A 00       
    1304/     5FE :                     
    1305/     5FE :                     ;--------------------------------------
    1306/     5FE :                     ; 2 byte machine code branch
    1307/     5FE :                     ; - 2nd byte is Relative address
    1308/     5FE :                     ; - input hl : opecode address
    1309/     5FE :                     ; - output hl : target address
    1310/     5FE :                     ;--------------------------------------
    1311/     5FE :                     Rel_adr_c:
    1312/     5FE : 23                  	inc	hl
    1313/     5FF : 5E                  	ld	e, (hl)		; e = 2nd operand
    1314/     600 : 23                  	inc	hl		; hl = PC + 2
    1315/     601 : 16 FF               	ld	d, 0ffh
    1316/     603 : C5                  	push	bc 			;Z80 CODE bit	7, e		; test msb bit
    1317/     604 : 47                  	ld	b,a 			;## DO NOT USE PUSH AF #########
    1318/     605 : 7B                  	ld	a,e 			;###############################
    1319/     606 : E6 80               	and	80h 			;###############################
    1320/     608 : 78                  	ld	a,b 			;###############################
    1321/     609 : C1                  	pop	bc; 			;## DO NOT USE POP AF ##########
    1322/     60A : C2 0F 06            	jp	nz,exp_msb	;jr	nz, exp_msb	; 
    1323/     60D : 16 00               	ld	d, 0
    1324/     60F :                     exp_msb:
    1325/     60F : 19                  	add	hl, de
    1326/     610 : C9                  	ret
    1327/     611 :                     
    1328/     611 :                     ;--------------------------------------
    1329/     611 :                     ; 1 byte op code, insert TC
    1330/     611 :                     ; ea = *REGPC; *(ea+1) = TC
    1331/     611 :                     ;--------------------------------------
    1332/     611 :                     insBRK_1op:
    1333/     611 :                     ;	ld	hl, (REGPC)
    1334/     611 : 2A 34 9F            	ld	hl, (tmpT)
    1335/     614 : C3 22 06            	jp	ib1			;jr	ib1
    1336/     617 :                     
    1337/     617 :                     ;--------------------------------------
    1338/     617 :                     ; 2 byte op code, insert TC
    1339/     617 :                     ; ea = *REGPC; *(ea+2) = TC
    1340/     617 :                     ;--------------------------------------
    1341/     617 :                     insBRK_2op:
    1342/     617 :                     ;	ld	hl, (REGPC)
    1343/     617 : 2A 34 9F            	ld	hl, (tmpT)
    1344/     61A : C3 21 06            	jp	ib2			;jr	ib2
    1345/     61D :                     
    1346/     61D :                     ;--------------------------------------
    1347/     61D :                     ; 3 byte op code, insert TC
    1348/     61D :                     ; ea = *REGPC; *(ea+3) = TC;
    1349/     61D :                     ;--------------------------------------
    1350/     61D :                     insBRK_3op:
    1351/     61D :                     ;	ld	hl, (REGPC)
    1352/     61D : 2A 34 9F            	ld	hl, (tmpT)
    1353/     620 :                     ib3:
    1354/     620 : 23                  	inc	hl
    1355/     621 :                     ib2:
    1356/     621 : 23                  	inc	hl
    1357/     622 :                     ib1:
    1358/     622 : 23                  	inc	hl
    1359/     623 : CD 41 06            	call	inadr_chk_and_wrt
    1360/     626 : C9                  	ret
    1361/     627 :                     
    1362/     627 :                     ;--------------------------------------
    1363/     627 :                     ; 3 byte op code, insert TC in branch point
    1364/     627 :                     ; ea = *REGPC; *((char *)(ea+1)) = TC;
    1365/     627 :                     ;--------------------------------------
    1366/     627 :                     insBRK_brp:
    1367/     627 :                     ;	ld	hl, (REGPC)
    1368/     627 : 2A 34 9F            	ld	hl, (tmpT)
    1369/     62A : 23                  	inc	hl
    1370/     62B : 5E                  	ld	e, (hl)
    1371/     62C : 23                  	inc	hl
    1372/     62D : 56                  	ld	d, (hl)
    1373/     62E : EB                  	ex	de,  hl
    1374/     62F : CD 41 06            	call	inadr_chk_and_wrt
    1375/     632 : C9                  	ret
    1376/     633 :                     
    1377/     633 :                     ;--------------------------------------
    1378/     633 :                     ; insert TC at SP
    1379/     633 :                     ; ea = *REGSP; *ea = TC;
    1380/     633 :                     ;--------------------------------------
    1381/     633 :                     insBRK_sp:
    1382/     633 : EB                  	EX	HL,DE			;Z80 CODE ld	de, (REGSP) ####
    1383/     634 : 2A 20 9F            	LD	HL,(REGSP)		;###############################
    1384/     637 : EB                  	EX	HL,DE			;###############################
    1385/     638 : 1A                  	ld	a, (de)
    1386/     639 : 6F                  	ld	l, a
    1387/     63A : 13                  	inc	de
    1388/     63B : 1A                  	ld	a, (de)
    1389/     63C : 67                  	ld	h, a		; hl = *sp
    1390/     63D : CD 41 06            	call	inadr_chk_and_wrt
    1391/     640 : C9                  	ret
    1392/     641 :                     
    1393/     641 :                     ;--------------------------------------
    1394/     641 :                     ; check (HL) is RAM AREA
    1395/     641 :                     ; insert Trace code at (HL)
    1396/     641 :                     ;--------------------------------------
    1397/     641 :                     inadr_chk_and_wrt:
    1398/     641 : 7C                  	ld	a, h
    1399/     642 : =>FALSE              	IF	Fullram
    1400/     642 : =>TRUE               	ELSE
    1401/     642 : FE 80               	cp	RAM_B >> 8		; 80H
    1402/     644 : DA 6D 06            	jp	c,NO_RAM_AREA	;jr	c, NO_RAM_AREA
    1403/     647 : FE 9F               	cp	RAM_E >> 8		; 8FH
    1404/     649 : D2 6D 06            	jp	nc,NO_RAM_AREA		;jr	nc, NO_RAM_AREA
    1405/     64C : [1399]               	ENDIF
    1406/     64C : 79                  	ld	a, c
    1407/     64D : FE 01               	cp	1		;first save?
    1408/     64F : C2 60 06            	jp	nz,icka1	;jr	nz, icka1
    1409/     652 : 11 37 9F            	ld	de, tpt1_f
    1410/     655 : 12                  	ld	(de), a		; set trace ON
    1411/     656 : 22 39 9F            	ld	(tpt1_adr), hl
    1412/     659 : 7E                  	ld	a, (hl)		; get opcode
    1413/     65A : 32 38 9F            	ld	(tpt1_op), a	; save opcode
    1414/     65D : C3 6B 06            	jp	icka_end	;jr	icka_end
    1415/     660 :                     icka1:
    1416/     660 : 11 3B 9F            	ld	de, tpt2_f
    1417/     663 : 12                  	ld	(de), a		; set trace ON
    1418/     664 : 22 3D 9F            	ld	(tpt2_adr), hl
    1419/     667 : 7E                  	ld	a, (hl)		; get opcode
    1420/     668 : 32 3C 9F            	ld	(tpt2_op), a	; save opcode
    1421/     66B :                     icka_end:
    1422/     66B : AF                  	xor	a
    1423/     66C : C9                  	ret
    1424/     66D :                     
    1425/     66D :                     NO_RAM_AREA:
    1426/     66D : 37                  	SCF
    1427/     66E : C9                  	ret
    1428/     66F :                     
    1429/     66F :                     
    1430/     66F :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;
    1431/     66F :                     ; 2 insertion TC TABLE
    1432/     66F :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;
    1433/     66F :                     ;
    1434/     66F :                     ; 1 byte machine code: branch (RET CC)
    1435/     66F :                     RETCC_TBLS:
    1436/     66F : C0                  	DB	0C0H	; RET	NZ
    1437/     670 : C8                  	DB	0C8H	; RET	Z
    1438/     671 : D0                  	DB	0D0H	; RET	NC
    1439/     672 : D8                  	DB	0D8H	; RET	C
    1440/     673 : E0                  	DB	0E0H	; RET	PO
    1441/     674 : E8                  	DB	0E8H	; RET	PE
    1442/     675 : F0                  	DB	0F0H	; RET	P
    1443/     676 : F8                  	DB	0F8H	; RET	M
    1444/     677 :                     RETCC_TBLE:
    1445/     677 :                     
    1446/     677 :                     ; 2 byte machine code: branch (JR CC, Relative)
    1447/     677 :                     JRCC_TBLS:
    1448/     677 : 10                  	DB	10H	; DJNZ	$
    1449/     678 :                     JRCC_TBLS1:
    1450/     678 : 20                  	DB	20H	; JR	NZ,$
    1451/     679 : 28                  	DB	28H	; JR	Z,$
    1452/     67A : 30                  	DB	30H	; JR	NC,$
    1453/     67B : 38                  	DB	38H	; JR	C,$
    1454/     67C :                     JRCC_TBLE:
    1455/     67C :                     
    1456/     67C :                     ; 3 byte machine code: branch (JP CC, 16bit literal)
    1457/     67C :                     JPCC_TBLS:
    1458/     67C : C2                  	DB	0C2H	; JP	NZ,1234H
    1459/     67D : CA                  	DB	0CAH	; JP	Z,1234H
    1460/     67E : D2                  	DB	0D2H	; JP	NC,1234H
    1461/     67F : DA                  	DB	0DAH	; JP	C,1234H
    1462/     680 : E2                  	DB	0E2H	; JP	PO,1234H
    1463/     681 : EA                  	DB	0EAH	; JP	PE,1234H
    1464/     682 : F2                  	DB	0F2H	; JP	P,1234H
    1465/     683 : FA                  	DB	0FAH	; JP	M,1234H
    1466/     684 :                     JPCC_TBLE:
    1467/     684 :                     
    1468/     684 :                     ; (call 16bit literal)
    1469/     684 :                     CLCC_TBLS:
    1470/     684 : C4                  	DB	0C4H	; CALL	NZ,1234H
    1471/     685 : CC                  	DB	0CCH	; CALL	Z,1234H
    1472/     686 : D4                  	DB	0D4H	; CALL	NC,1234H
    1473/     687 : DC                  	DB	0DCH	; CALL	C,1234H
    1474/     688 : E4                  	DB	0E4H	; CALL	PO,1234H
    1475/     689 : EC                  	DB	0ECH	; CALL	PE,1234H
    1476/     68A : F4                  	DB	0F4H	; CALL	P,1234H
    1477/     68B : FC                  	DB	0FCH	; CALL	M,1234H
    1478/     68C :                     CLCC_TBLE:
    1479/     68C :                     
    1480/     68C :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;
    1481/     68C :                     ; 1 insertion TC TABLE
    1482/     68C :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;
    1483/     68C :                     
    1484/     68C :                     ; restart
    1485/     68C :                     RST_TBLS:
    1486/     68C : C7                  	DB	0C7H	; RST	00H
    1487/     68D : CF                  	DB	0CFH	; RST	08H
    1488/     68E : D7                  	DB	0D7H	; RST	10H
    1489/     68F : DF                  	DB	0DFH	; RST	18H
    1490/     690 : E7                  	DB	0E7H	; RST	20H
    1491/     691 : EF                  	DB	0EFH	; RST	28H
    1492/     692 : F7                  	DB	0F7H	; RST	30H
    1493/     693 : FF                  	DB	0FFH	; RST	38H
    1494/     694 :                     RST_TBLE:
    1495/     694 :                     
    1496/     694 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1497/     694 :                     ;;;
    1498/     694 :                     ;;; machine code check(except branch)
    1499/     694 :                     ;;;
    1500/     694 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1501/     694 :                     INS2:
    1502/     694 :                     
    1503/     694 :                     	; 2byte machine code search
    1504/     694 : 01 12 00            	ld	bc, TWO_OPTBL_E - TWO_OPTBL
    1505/     697 : 21 43 07            	ld	hl, TWO_OPTBL
    1506/     69A : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    1507/     69D : CA 1E 07            	jp	z, meet_op2
    1508/     6A0 :                     
    1509/     6A0 :                     	; 3byte machine code search
    1510/     6A0 : 01 08 00            	ld	bc, THREE_OPTBL_E - THREE_OPTBL
    1511/     6A3 : 21 55 07            	ld	hl, THREE_OPTBL
    1512/     6A6 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    1513/     6A9 : CA 29 07            	jp	z, meet_op3
    1514/     6AC :                     
    1515/     6AC :                     	; check 0CBH
    1516/     6AC :                     	
    1517/     6AC :                     	; readjust hl
    1518/     6AC : 2A 34 9F            	ld	hl, (tmpT)
    1519/     6AF :                     
    1520/     6AF : FE CB               	cp	0CBH		; opecode 0CBH?
    1521/     6B1 : CA 1E 07            	jp	z,meet_op2	;jr	z, meet_op2
    1522/     6B4 :                     	
    1523/     6B4 :                     	; check 0DDH
    1524/     6B4 : FE DD               	cp	0ddh		; opecode 0DDH?
    1525/     6B6 : CA C6 06            	jp	z,meet_dd	;jr	z, meet_dd
    1526/     6B9 :                     	
    1527/     6B9 :                     	; check 0EDH
    1528/     6B9 : FE ED               	cp	0edh		; opecode 0EDH?
    1529/     6BB : CA F0 06            	jp	z,meet_ed	;jr	z, meet_ed
    1530/     6BE :                     
    1531/     6BE :                     	; check 0FDH
    1532/     6BE : FE FD               	cp	0fdh		; opecode 0FDH?
    1533/     6C0 : CA C6 06            	jp	z,meet_dd	;jr	z, meet_dd
    1534/     6C3 :                     
    1535/     6C3 :                     	; 1byte machine code
    1536/     6C3 : C3 13 07            	jp	meet_op1	;jr	meet_op1
    1537/     6C6 :                     
    1538/     6C6 :                     	; opecode 0DDh
    1539/     6C6 :                     meet_dd:
    1540/     6C6 : 23                  	inc	hl
    1541/     6C7 : 7E                  	ld	a, (hl)	
    1542/     6C8 : FE CB               	cp	0cbh		; 2nd 0CBH?
    1543/     6CA : CA 34 07            	jp	z,meet_op4	;jr	z, meet_op4
    1544/     6CD : FE 21               	cp	21h		; 2nd 21H?
    1545/     6CF : CA 34 07            	jp	z,meet_op4	;jr	z, meet_op4
    1546/     6D2 : FE 22               	cp	22h		; 2nd 22H?
    1547/     6D4 : CA 34 07            	jp	z,meet_op4	;jr	z, meet_op4
    1548/     6D7 : FE 2A               	cp	2ah		; 2nd 2AH?
    1549/     6D9 : CA 34 07            	jp	z,meet_op4	;jr	z, meet_op4
    1550/     6DC : FE 36               	cp	36h		; 2nd 36H?
    1551/     6DE : CA 34 07            	jp	z,meet_op4	;jr	z, meet_op4
    1552/     6E1 :                     
    1553/     6E1 :                     	; 2nd code search
    1554/     6E1 : 01 0A 00            	ld	bc, DD_2NDTBL_E - DD_2NDTBL
    1555/     6E4 : 21 5D 07            	ld	hl, DD_2NDTBL
    1556/     6E7 : CD A4 30            	CALL	CPIR80		;Z80 CODE cpir #################
    1557/     6EA : CA 1E 07            	jp	z,meet_op2	;jr	z, meet_op2
    1558/     6ED : C3 29 07            	jp	meet_op3	;jr	meet_op3
    1559/     6F0 :                     
    1560/     6F0 :                     meet_ed:
    1561/     6F0 : 23                  	inc	hl
    1562/     6F1 : 7E                  	ld	a, (hl)	
    1563/     6F2 : FE 43               	cp	43h		; 2nd 43H?
    1564/     6F4 : CA 34 07            	jp	z,meet_op4	;jr	z, meet_op4
    1565/     6F7 : FE 4B               	cp	4bh		; 2nd 4BH?
    1566/     6F9 : CA 34 07            	jp	z,meet_op4	;jr	z, meet_op4
    1567/     6FC : FE 53               	cp	53h		; 2nd 53H?
    1568/     6FE : CA 34 07            	jp	z,meet_op4	;jr	z, meet_op4
    1569/     701 : FE 5B               	cp	5bh		; 2nd 5BH?
    1570/     703 : CA 34 07            	jp	z,meet_op4	;jr	z, meet_op4
    1571/     706 : FE 73               	cp	73h		; 2nd 73H?
    1572/     708 : CA 34 07            	jp	z,meet_op4	;jr	z, meet_op4
    1573/     70B : FE 7B               	cp	7bh		; 2nd 7BH?
    1574/     70D : CA 34 07            	jp	z,meet_op4	;jr	z, meet_op4
    1575/     710 : C3 1E 07            	jp	meet_op2	;jr	meet_op2
    1576/     713 :                     
    1577/     713 :                     ; 1 machine code
    1578/     713 :                     meet_op1:
    1579/     713 : 0E 01               	ld	c, 1
    1580/     715 : CD 11 06            	call	insBRK_1op
    1581/     718 : DA EA 05            	jp	c, err_trace_seq
    1582/     71B : C3 E7 05            	jp	END_INS_TC
    1583/     71E :                     
    1584/     71E :                     ; 2 machine code
    1585/     71E :                     meet_op2:
    1586/     71E : 0E 01               	ld	c, 1
    1587/     720 : CD 17 06            	call	insBRK_2op
    1588/     723 : DA EA 05            	jp	c, err_trace_seq
    1589/     726 : C3 E7 05            	jp	END_INS_TC
    1590/     729 :                     ; 3 machine code
    1591/     729 :                     meet_op3:
    1592/     729 : 0E 01               	ld	c, 1
    1593/     72B : CD 1D 06            	call	insBRK_3op
    1594/     72E : DA EA 05            	jp	c, err_trace_seq
    1595/     731 : C3 E7 05            	jp	END_INS_TC
    1596/     734 :                     
    1597/     734 :                     ; 4 machine codee
    1598/     734 :                     meet_op4:
    1599/     734 : 0E 01               	ld	c, 1
    1600/     736 :                     ;	ld	hl, (REGPC)
    1601/     736 : 2A 34 9F            	ld	hl, (tmpT)
    1602/     739 : 23                  	inc	hl
    1603/     73A : CD 20 06            	call	ib3
    1604/     73D : DA EA 05            	jp	c, err_trace_seq
    1605/     740 : C3 E7 05            	jp	END_INS_TC
    1606/     743 :                     
    1607/     743 :                     TWO_OPTBL:	; second byte is 8bitliteral[nn]
    1608/     743 :                     ld_r_nn_s:
    1609/     743 : 06                  	DB	06h	; LD	B,nn
    1610/     744 : 0E                  	DB	0Eh	; LD	C,nn
    1611/     745 : 16                  	DB	16h	; LD	D,nn
    1612/     746 : 1E                  	DB	1Eh	; LD	E,nn
    1613/     747 : 26                  	DB	26h	; LD	H,nn
    1614/     748 : 2E                  	DB	2Eh	; LD	L,nn
    1615/     749 : 36                  	DB	36h	; LD	(HL),nn
    1616/     74A : 3E                  	DB	3Eh	; LD	A,nn
    1617/     74B :                     ld_r_nn_e:
    1618/     74B :                     
    1619/     74B :                     log_op_s:
    1620/     74B : C6                  	DB	0C6h	; ADD	A,nn
    1621/     74C : CE                  	DB	0CEh	; ADC	A,nn
    1622/     74D : DE                  	DB	0DEh	; SBC	A,nn
    1623/     74E : D6                  	DB	0D6h	; SUB	nn
    1624/     74F : E6                  	DB	0E6h	; AND	nn
    1625/     750 : EE                  	DB	0EEh	; XOR	nn
    1626/     751 : F6                  	DB	0F6h	; OR	nn
    1627/     752 : FE                  	DB	0FEh	; CP	nn
    1628/     753 : DB                  	DB	0DBh	; IN	A,(nn)
    1629/     754 : D3                  	DB	0D3h	; OUT	(nn),A
    1630/     755 :                     log_op_e:
    1631/     755 :                     TWO_OPTBL_E:
    1632/     755 :                     
    1633/     755 :                     THREE_OPTBL:	; 2nd, 3rd byte is 16bitliteral[nnnn]
    1634/     755 : 01                  	DB	01h	; LD	BC,nnnn
    1635/     756 : 11                  	DB	11h	; LD	DE,nnnn
    1636/     757 : 21                  	DB	21h	; LD	HL,nnnn
    1637/     758 : 31                  	DB	31h	; LD	SP,nnnn
    1638/     759 :                     THREE_OPTBLe
    1639/     759 : 22                  	DB	22h	; LD	(nnnn),HL
    1640/     75A : 32                  	DB	32h	; LD	(nnnn),A
    1641/     75B :                     
    1642/     75B : 2A                  	DB	2Ah	; LD	HL,(nnnn)
    1643/     75C : 3A                  	DB	3Ah	; LD	A,(nnnn)
    1644/     75D :                     THREE_OPTBL_E:
    1645/     75D :                     
    1646/     75D :                     DD_2NDTBL:
    1647/     75D : 09                  	DB	09h	; ADD	IX,BC
    1648/     75E : 19                  	DB	19h	; ADD	IX,DE
    1649/     75F : 29                  	DB	29h	; ADD	IX,IX
    1650/     760 : 39                  	DB	39h	; ADD	IX,SP
    1651/     761 :                     DD_2NDTBL1:
    1652/     761 : 23                  	DB	23h	; INC	IX
    1653/     762 : 2B                  	DB	2Bh	; DEC	IX
    1654/     763 : E5                  	DB	0E5h	; PUSH	IX
    1655/     764 : E1                  	DB	0E1h	; POP	IX
    1656/     765 :                     DD_2NDTBL2:
    1657/     765 : E3                  	DB	0E3h	; EX	(SP),IX
    1658/     766 : F9                  	DB	0F9h	; LD	SP,IX
    1659/     767 :                     DD_2NDTBL_E:
    1660/     767 :                     
    1661/     767 :                     ;;; 
    1662/     767 :                     ;;; Dump memory
    1663/     767 :                     ;;; 
    1664/     767 :                     
    1665/     767 :                     DUMP:
    1666/     767 : 23                  	INC	HL
    1667/     768 : 7E                  	LD	A,(HL)
    1668/     769 : FE 49               	cp	'I'
    1669/     76B : CA 7D 08            	JP	Z,disassemble
    1670/     76E : CD 3B 29            	CALL	SKIPSP
    1671/     771 : CD 4C 29            	CALL	RDHEX		; 1st arg.
    1672/     774 : DA 7F 07            	jp	c, DP0		;jr	c, DP0
    1673/     777 :                     	;; 1st arg. found
    1674/     777 : EB                  	EX	HL,DE			;Z80 CODE LD	(DSADDR),DE ####
    1675/     778 : 22 00 9F            	LD	(DSADDR),HL		;###############################
    1676/     77B : EB                  	EX	HL,DE			;###############################
    1677/     77C : C3 90 07            	jp	dp00			;jr	dp00
    1678/     77F :                     
    1679/     77F :                     DP0:	;; No arg. chk
    1680/     77F :                     
    1681/     77F : E5                  	push	hl
    1682/     780 : 2A 00 9F            	LD	HL,(DSADDR)
    1683/     783 : 01 80 00            	LD	BC,128
    1684/     786 : 09                  	ADD	HL,BC
    1685/     787 : 22 02 9F            	LD	(DEADDR),HL
    1686/     78A : E1                  	pop	hl
    1687/     78B : 7E                  	LD	A,(HL)
    1688/     78C : B7                  	OR	A
    1689/     78D : CA BE 07            	jp	z,DPM_C		;JR	z, DPM_C	; no arg.
    1690/     790 :                     
    1691/     790 :                     dp00:
    1692/     790 : CD 3B 29            	CALL	SKIPSP
    1693/     793 : 7E                  	LD	A,(HL)
    1694/     794 : FE 2C               	CP	','
    1695/     796 : CA A7 07            	jp	z,DP1		;JR	Z,DP1
    1696/     799 : B7                  	OR	A
    1697/     79A : C2 18 01            	jp	nz,ERR		;JP	NZ,ERR
    1698/     79D :                     
    1699/     79D :                     	;; No 2nd arg.
    1700/     79D :                     
    1701/     79D : 21 80 00            	LD	HL,128
    1702/     7A0 : 19                  	ADD	HL,DE
    1703/     7A1 : 22 02 9F            	LD	(DEADDR),HL
    1704/     7A4 : C3 BE 07            	jp	DPM_C		;JR	DPM_C
    1705/     7A7 :                     
    1706/     7A7 :                     DP1:
    1707/     7A7 : 23                  	INC	HL
    1708/     7A8 : CD 3B 29            	CALL	SKIPSP
    1709/     7AB : CD 4C 29            	CALL	RDHEX
    1710/     7AE : DA 18 01            	jp	c, ERR
    1711/     7B1 : CD 3B 29            	CALL	SKIPSP
    1712/     7B4 : B7                  	OR	A
    1713/     7B5 : C2 18 01            	jp	nz, ERR
    1714/     7B8 : 13                  	INC	DE
    1715/     7B9 : EB                  	EX	HL,DE			;Z80 CODE LD	(DEADDR),DE ####
    1716/     7BA : 22 02 9F            	LD	(DEADDR),HL		;###############################
    1717/     7BD : EB                  	EX	HL,DE			;###############################
    1718/     7BE :                     DPM_C:
    1719/     7BE : CD C4 07            	CALL	DPM
    1720/     7C1 : C3 CD 00            	JP	WSTART
    1721/     7C4 :                     
    1722/     7C4 :                     	;; DUMP main
    1723/     7C4 :                     DPM:
    1724/     7C4 : 2A 00 9F            	LD	HL,(DSADDR)
    1725/     7C7 : 3E F0               	LD	A,0F0H
    1726/     7C9 : A5                  	AND	L
    1727/     7CA : 6F                  	LD	L,A
    1728/     7CB : AF                  	XOR	A
    1729/     7CC : 32 04 9F            	LD	(DSTATE),A
    1730/     7CF :                     DPM0:
    1731/     7CF : E5                  	PUSH	HL
    1732/     7D0 : CD F3 07            	CALL	DPL
    1733/     7D3 : E1                  	POP	HL
    1734/     7D4 : 01 10 00            	LD	BC,16
    1735/     7D7 : 09                  	ADD	HL,BC
    1736/     7D8 : CD F4 30            	CALL	CONST
    1737/     7DB : C2 ED 07            	JP	NZ,DPM1		;JR	NZ,DPM1
    1738/     7DE : 3A 04 9F            	LD	A,(DSTATE)
    1739/     7E1 : FE 02               	CP	2
    1740/     7E3 : DA CF 07            	JP	C,DPM0		;JR	C,DPM0
    1741/     7E6 : 2A 02 9F            	LD	HL,(DEADDR)
    1742/     7E9 : 22 00 9F            	LD	(DSADDR),HL
    1743/     7EC : C9                  	RET
    1744/     7ED :                     DPM1:
    1745/     7ED : 22 00 9F            	LD	(DSADDR),HL
    1746/     7F0 : C3 EA 30            	JP	CONIN
    1747/     7F3 :                     
    1748/     7F3 :                     DPL:
    1749/     7F3 :                     	;; DUMP line
    1750/     7F3 : CD 2D 28            	CALL	HEXOUT4
    1751/     7F6 : E5                  	PUSH	HL
    1752/     7F7 : 21 6F 2E            	LD	HL,DSEP0
    1753/     7FA : CD 23 28            	CALL	STROUT
    1754/     7FD : E1                  	POP	HL
    1755/     7FE : 11 74 9F            	LD	DE,INBUF		;Z80 CODE LD	IX,INBUF ######
    1756/     801 : 06 10               	LD	B,16
    1757/     803 :                     DPL0:
    1758/     803 : CD 33 08            	CALL	DPB
    1759/     806 : 05                  	DEC	B			;Z80 CODE #####	DJNZ	DPL0
    1760/     807 : C2 03 08            	JP	NZ,DPL0			;##############################
    1761/     80A :                     
    1762/     80A : 21 72 2E            	LD	HL,DSEP1
    1763/     80D : CD 23 28            	CALL	STROUT
    1764/     810 :                     
    1765/     810 : 21 74 9F            	LD	HL,INBUF
    1766/     813 : 06 10               	LD	B,16
    1767/     815 :                     DPL1:
    1768/     815 : 7E                  	LD	A,(HL)
    1769/     816 : 23                  	INC	HL
    1770/     817 : FE 20               	CP	' '
    1771/     819 : DA 27 08            	JP	C,DPL2		;JR	C,DPL2
    1772/     81C : FE 7F               	CP	7FH
    1773/     81E : D2 27 08            	JP	NC,DPL2		;JR	NC,DPL2
    1774/     821 : CD F9 30            	CALL	CONOUT
    1775/     824 : C3 2C 08            	JP	DPL3		;JR	DPL3
    1776/     827 :                     DPL2:
    1777/     827 : 3E 2E               	LD	A,'.'
    1778/     829 : CD F9 30            	CALL	CONOUT
    1779/     82C :                     DPL3:
    1780/     82C : 05                  	DEC	B			;Z80 CODE #####	DJNZ	DPL1 ###
    1781/     82D : C2 15 08            	JP	NZ,DPL1			;###############################
    1782/     830 : C3 71 28            	JP	CRLF
    1783/     833 :                     
    1784/     833 :                     DPB:	; Dump byte
    1785/     833 : 3E 20               	LD	A,' '
    1786/     835 : CD F9 30            	CALL	CONOUT
    1787/     838 : 3A 04 9F            	LD	A,(DSTATE)
    1788/     83B : B7                  	OR	A
    1789/     83C : C2 5E 08            	JP	NZ,DPB2		;JR	NZ,DPB2
    1790/     83F :                     	; Dump state 0
    1791/     83F : 3A 00 9F            	LD	A,(DSADDR)	; Low byte
    1792/     842 : BD                  	CP	L
    1793/     843 : C2 4D 08            	JP	NZ,DPB0		;JR	NZ,DPB0
    1794/     846 : 3A 01 9F            	LD	A,(DSADDR+1)	; High byte
    1795/     849 : BC                  	CP	H
    1796/     84A : CA 59 08            	JP	Z,DPB1		;JR	Z,DPB1
    1797/     84D :                     DPB0:	; Still 0 or 2
    1798/     84D : 3E 20               	LD	A,' '
    1799/     84F : CD F9 30            	CALL	CONOUT
    1800/     852 : CD F9 30            	CALL	CONOUT
    1801/     855 : 12                  	LD	(DE),A			;Z80 CODE LD	(IX),A #########
    1802/     856 : 23                  	INC	HL
    1803/     857 : 13                  	INC	DE			;Z80 CODE INC	IX #############
    1804/     858 : C9                  	RET
    1805/     859 :                     DPB1:	; Found start address
    1806/     859 : 3E 01               	LD	A,1
    1807/     85B : 32 04 9F            	LD	(DSTATE),A
    1808/     85E :                     DPB2:
    1809/     85E : 3A 04 9F            	LD	A,(DSTATE)
    1810/     861 : FE 01               	CP	1
    1811/     863 : C2 4D 08            	JP	NZ,DPB0		;JR	NZ,DPB0
    1812/     866 :                     	; Dump state 1
    1813/     866 : 7E                  	LD	A,(HL)
    1814/     867 : 12                  	LD	(DE),A			;Z80 CODE LD	(IX),A #########
    1815/     868 : CD 32 28            	CALL	HEXOUT2
    1816/     86B : 23                  	INC	HL
    1817/     86C : 13                  	INC	DE			;Z80 CODE INC	IX #############
    1818/     86D : 3A 02 9F            	LD	A,(DEADDR)	; Low byte
    1819/     870 : BD                  	CP	L
    1820/     871 : C0                  	RET	NZ
    1821/     872 : 3A 03 9F            	LD	A,(DEADDR+1)	; High byte
    1822/     875 : BC                  	CP	H
    1823/     876 : C0                  	RET	NZ
    1824/     877 :                     	; Found end address
    1825/     877 : 3E 02               	LD	A,2
    1826/     879 : 32 04 9F            	LD	(DSTATE),A
    1827/     87C : C9                  	RET
    1828/     87D :                     
    1829/     87D :                     ;;;
    1830/     87D :                     ;;; Disassemble
    1831/     87D :                     ;;; 
    1832/     87D :                     
    1833/     87D :                     
    1834/     87D :                     ; DI[<address>][,s<steps>|<end address>]
    1835/     87D :                     
    1836/     87D :                     disassemble:
    1837/     87D : 23                  	INC	HL
    1838/     87E : CD 3B 29            	CALL	SKIPSP
    1839/     881 : CD 4C 29            	CALL	RDHEX		; 1st arg.
    1840/     884 : D2 9D 08            	jp	nc,get_DI1	;jr	nc, get_DI1
    1841/     887 :                     
    1842/     887 :                     di_nxt:
    1843/     887 :                     	;; No arg. chk
    1844/     887 : CD 3B 29            	CALL	SKIPSP
    1845/     88A : 7E                  	LD	A,(HL)
    1846/     88B : B7                  	OR	A
    1847/     88C : C2 A5 08            	jp	nz,chk_DI1	;jr	NZ, chk_DI1	; ',' check
    1848/     88F :                     
    1849/     88F :                     ; No arg
    1850/     88F : 26 00               	ld	h, 0
    1851/     891 : 2E 0A               	ld	l, 10
    1852/     893 : 7D                  	ld	a, l
    1853/     894 : 32 6C 9F            	ld	(dasm_stpf), a	; set step flag
    1854/     897 : 22 6A 9F            	ld	(dasm_ed), hl	; set 10 steps
    1855/     89A : C3 D8 08            	jp	DISASM_go	;jr	DISASM_go
    1856/     89D :                     
    1857/     89D :                     ; 1st arg
    1858/     89D :                     get_DI1:
    1859/     89D : EB                  	EX	HL,DE			;Z80 CODE ld	(dasm_adr), de	; save start address
    1860/     89E : 22 6D 9F            	LD	(dasm_adr),HL		;###############################
    1861/     8A1 : EB                  	EX	HL,DE			;###############################
    1862/     8A2 :                     ;	INC	HL
    1863/     8A2 : C3 87 08            	jp	di_nxt			;jr	di_nxt
    1864/     8A5 :                     
    1865/     8A5 :                     chk_DI1:
    1866/     8A5 : FE 2C               	cp	','
    1867/     8A7 : C2 18 01            	jp	nz, ERR
    1868/     8AA :                     
    1869/     8AA :                     ; check 2nd arg
    1870/     8AA :                     
    1871/     8AA : 23                  	INC	HL
    1872/     8AB : CD 3B 29            	CALL	SKIPSP
    1873/     8AE : FE 53               	cp	'S'
    1874/     8B0 : C2 C9 08            	jp	nz,chk_stpDI		;jr	nz, chk_stpDI
    1875/     8B3 :                     
    1876/     8B3 :                     ; step arg
    1877/     8B3 : 3E 01               	ld	a, 1
    1878/     8B5 : 32 6C 9F            	ld	(dasm_stpf), a	; set step flag
    1879/     8B8 : 23                  	inc	hl
    1880/     8B9 : CD 40 02            	call	GET_NUM		; get decimal number to binary
    1881/     8BC : DA 18 01            	jp	c, ERR
    1882/     8BF : E5                  	PUSH	HL			;Z80 CODE ld	(dasm_ed), bc	; set steps
    1883/     8C0 : 60                  	LD	H,B			;###############################
    1884/     8C1 : 69                  	LD	L,C			;###############################
    1885/     8C2 : 22 6A 9F            	LD	(dasm_ed),HL		;###############################
    1886/     8C5 : E1                  	POP	HL			;###############################
    1887/     8C6 : C3 D8 08            	jp	DISASM_go	;jr	DISASM_go
    1888/     8C9 :                     
    1889/     8C9 :                     chk_stpDI:
    1890/     8C9 : CD 4C 29            	CALL	RDHEX		; 2nd arg.
    1891/     8CC : DA 18 01            	jp	c, ERR
    1892/     8CF : EB                  	EX	HL,DE			;Z80 CODE ld	(dasm_ed), de	; set end address
    1893/     8D0 : 22 6A 9F            	LD	(dasm_ed),HL		;###############################
    1894/     8D3 : EB                  	EX	HL,DE			;###############################
    1895/     8D4 : AF                  	xor	a
    1896/     8D5 : 32 6C 9F            	ld	(dasm_stpf), a	; clear step flag
    1897/     8D8 :                     
    1898/     8D8 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1899/     8D8 :                     ; operation Disassemble
    1900/     8D8 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1901/     8D8 :                     
    1902/     8D8 :                     DISASM_go:
    1903/     8D8 : CD F4 30            	call	CONST
    1904/     8DB : CA E4 08            	jp	z,dis_go1	;jr	z, dis_go1
    1905/     8DE : CD EA 30            	call	CONIN		;discard key
    1906/     8E1 : C3 CD 00            	jp	WSTART		; exit disasm command
    1907/     8E4 :                     
    1908/     8E4 :                     dis_go1:
    1909/     8E4 :                     	; get opcode
    1910/     8E4 : CD 7D 09            	call	dis_analysis
    1911/     8E7 : CD 3D 09            	call	mk_adr_str	; conout address and machine code
    1912/     8EA :                     				; *dasm_adr is next opcode address
    1913/     8EA : 21 74 9F            	ld	hl, adr_mc_buf
    1914/     8ED : CD 23 28            	call	STROUT		; conout disassemble strings
    1915/     8F0 :                     
    1916/     8F0 : 3A 6C 9F            	ld	a, (dasm_stpf)
    1917/     8F3 : B7                  	or	a
    1918/     8F4 : C2 08 09            	jp	nz,calc_dis_step	;jr	nz, calc_dis_step
    1919/     8F7 :                     	
    1920/     8F7 :                     	; *dasm_adr > *dasm_ed ?, yes, finish
    1921/     8F7 : 2A 6D 9F            	ld	HL, (dasm_adr)		;Z80 CODE ld	bc, (dasm_adr) #
    1922/     8FA : 44                  	LD	B,H			;## HL destroyed it's ok here ##
    1923/     8FB : 4D                  	LD	C,L			;## HL destroyed it's ok here ##
    1924/     8FC : 2A 6A 9F            	ld	hl, (dasm_ed)
    1925/     8FF : CD B4 30            	call	sbc_hlbc		;Z80 CODE sbc	hl, bc
    1926/     902 : D2 D8 08            	jp	nc,DISASM_go		;jr	nc, DISASM_go
    1927/     905 : C3 CD 00            	jp	WSTART
    1928/     908 :                     
    1929/     908 :                     calc_dis_step:
    1930/     908 : 2A 6A 9F            	ld	hl, (dasm_ed)
    1931/     90B : 2B                  	dec	hl
    1932/     90C : 22 6A 9F            	ld	(dasm_ed), hl
    1933/     90F : 7C                  	ld	a, h
    1934/     910 : B5                  	or	l
    1935/     911 : C2 D8 08            	jp	nz,DISASM_go	;jr	nz, DISASM_go
    1936/     914 : C3 CD 00            	jp	WSTART
    1937/     917 :                     
    1938/     917 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1939/     917 :                     ; Disassemble and maked strings to user buffer
    1940/     917 :                     ; input de : user buffer
    1941/     917 :                     ;       hl : disassemble address
    1942/     917 :                     ; output de : next MC address
    1943/     917 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1944/     917 :                     get_disasm_st:
    1945/     917 : 22 6D 9F            	ld	(dasm_adr), hl
    1946/     91A : D5                  	push	de
    1947/     91B : CD 7D 09            	call	dis_analysis
    1948/     91E : CD 3D 09            	call	mk_adr_str	; conout address and machine code
    1949/     921 : D1                  	pop	de
    1950/     922 : 21 74 9F            	ld	hl, adr_mc_buf
    1951/     925 : 01 2A 00            	ld	bc, dasm_be - dasm_bs
    1952/     928 : F5                  	PUSH	AF			;Z80 CODE ldir
    1953/     929 : 7E                  LDIR1:	LD	A,(HL)			;###############################
    1954/     92A : 12                  	LD	(DE),A			;###############################
    1955/     92B : 23                  	INC	HL			;###############################
    1956/     92C : 13                  	INC	DE			;###############################
    1957/     92D : 0B                  	DEC	BC			;###############################
    1958/     92E : 79                  	LD	A,C			;###############################
    1959/     92F : B0                  	OR	B			;###############################
    1960/     930 : C2 29 09            	JP	NZ,LDIR1		;###############################
    1961/     933 : F1                  	POP	AF			;###############################
    1962/     934 : EB                  	EX	HL,DE			;Z80 CODE ld	de, (dasm_adr)
    1963/     935 : 2A 6D 9F            	LD	HL,(dasm_adr)		;###############################
    1964/     938 : EB                  	EX	HL,DE			;###############################
    1965/     939 : 3A 73 9F            	ld	a, (mc_Size)
    1966/     93C : C9                  	ret
    1967/     93D :                     
    1968/     93D :                     ;-------------------------------------------------
    1969/     93D :                     ; Make address and machine code at adr_mc_buf
    1970/     93D :                     ; "XXXX XX XX XX XX " (17bytes)
    1971/     93D :                     ;-------------------------------------------------
    1972/     93D :                     mk_adr_str:
    1973/     93D : 21 74 9F            	ld	hl, adr_mc_buf
    1974/     940 : EB                  	EX	HL,DE			;Z80 CODE ld	de, (dasm_adr)
    1975/     941 : 2A 6D 9F            	LD	HL,(dasm_adr)		;###############################
    1976/     944 : EB                  	EX	HL,DE			;###############################
    1977/     945 : CD 90 11            	call	hex4str		; address XXXX
    1978/     948 : CD 2D 12            	call	ins_spcR
    1979/     94B : CD 2D 12            	call	ins_spcR
    1980/     94E :                     
    1981/     94E : 06 04               	ld	b, 4
    1982/     950 : 3A 73 9F            	ld	a, (mc_Size)
    1983/     953 : 4F                  	ld	c, a
    1984/     954 :                     mas_1:
    1985/     954 : 1A                  	ld	a, (de)
    1986/     955 : 13                  	inc	de
    1987/     956 :                     
    1988/     956 : D5                  	push	de
    1989/     957 : 5F                  	ld	e, a
    1990/     958 : CD 98 11            	call	hex2str		; MC XX
    1991/     95B : CD 2D 12            	call	ins_spcR
    1992/     95E : D1                  	pop	de
    1993/     95F :                     
    1994/     95F : 05                  	dec	b
    1995/     960 : CA 74 09            	jp	z,mas_3		;jr	z, mas_3	; end
    1996/     963 : 0D                  	dec	c
    1997/     964 : C2 54 09            	jp	nz,mas_1	;jr	nz, mas_1
    1998/     967 :                     
    1999/     967 :                     mas_2:	
    2000/     967 : CD 2D 12            	call	ins_spcR
    2001/     96A : CD 2D 12            	call	ins_spcR
    2002/     96D : CD 2D 12            	call	ins_spcR
    2003/     970 : 05                  	dec	b
    2004/     971 : C2 67 09            	jp	nz, mas_2
    2005/     974 :                     mas_3:
    2006/     974 : CD 2D 12            	call	ins_spcR
    2007/     977 : EB                  	EX	HL,DE			;Z80 CODE ld	(dasm_adr), de	; set next analysis address
    2008/     978 : 22 6D 9F            	LD	(dasm_adr),HL		;###############################
    2009/     97B : EB                  	EX	HL,DE			;###############################
    2010/     97C : C9                  	ret
    2011/     97D :                     
    2012/     97D :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2013/     97D :                     ; dis assemble analysis
    2014/     97D :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2015/     97D :                     
    2016/     97D :                     dis_analysis:
    2017/     97D :                     
    2018/     97D :                     	; pre init string buffer
    2019/     97D :                     
    2020/     97D : 3E 01               	ld	a, 1
    2021/     97F : 32 73 9F            	ld	(mc_Size), a
    2022/     982 :                     
    2023/     982 : 11 00 13            	ld	de, LDstr	; insert LD string
    2024/     985 : CD B6 11            	call	mkopcstr
    2025/     988 :                     
    2026/     988 : 21 8F 9F            	ld	hl, dasm_OprStr
    2027/     98B : CD E8 11            	call	insPostStr	; CR, LF, 00h
    2028/     98E :                     
    2029/     98E : 2A 6D 9F            	ld	hl, (dasm_adr)
    2030/     991 : 7E                  	ld	a, (hl)		; get opcode
    2031/     992 :                     
    2032/     992 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2033/     992 :                     	; analysys 1 byte MC
    2034/     992 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2035/     992 :                     
    2036/     992 :                     ;  check no operand
    2037/     992 :                     
    2038/     992 : 01 0D 00            	ld	bc, oth_1op_e - oth_1op_s
    2039/     995 : 21 44 12            	ld	hl, oth_1op_s
    2040/     998 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    2041/     99B : C2 B0 09            	jp	nz,chk_ld		;jr	nz, chk_ld
    2042/     99E :                     
    2043/     99E :                     ;  no operand
    2044/     99E :                     
    2045/     99E : 21 53 14            	ld	hl, oth_1op_tbl
    2046/     9A1 : CD 2E 11            	call	get_strBufpoint
    2047/     9A4 : C3 B6 11            	jp	mkopcstr
    2048/     9A7 :                     
    2049/     9A7 :                     get_r_num:
    2050/     9A7 : E6 38               	and	38H
    2051/     9A9 : 0F                  	rrca
    2052/     9AA : 0F                  	rrca
    2053/     9AB : 0F                  	rrca
    2054/     9AC : 4F                  	ld	c, a
    2055/     9AD : 06 00               	ld	b, 0		; bc ; register No.
    2056/     9AF : C9                  	ret
    2057/     9B0 :                     ;
    2058/     9B0 :                     ; LD opecode
    2059/     9B0 :                     ;
    2060/     9B0 :                     
    2061/     9B0 :                     ; check LD "A,(BC)", "A,(DE)", "(BC),A", "(DE),A", "SP,HL"
    2062/     9B0 :                     
    2063/     9B0 :                     chk_ld:
    2064/     9B0 : FE 0A               	cp	0AH	; LD	A,(BC)
    2065/     9B2 : CA D2 09            	jp	z,ld_a_kbck		;jr	z, ld_a_kbck
    2066/     9B5 : FE 1A               	cp	1AH	; LD	A,(DE)
    2067/     9B7 : CA E0 09            	jp	z,ld_a_kdek		;jr	z, ld_a_kdek
    2068/     9BA : FE 02               	cp	02H	; LD	(BC),A
    2069/     9BC : CA E6 09            	jp	z,ld_kbck_a		;jr	z, ld_kbck_a
    2070/     9BF : FE 12               	cp	12H	; LD	(DE),A
    2071/     9C1 : CA EF 09            	jp	z,ld_kdek_a		;jr	z, ld_kdek_a
    2072/     9C4 : FE F9               	cp	0F9H	; LD	SP,HL
    2073/     9C6 : C2 F5 09            	jp	nz,chk_ld1		;jr	nz, chk_ld1
    2074/     9C9 :                     
    2075/     9C9 :                     ; LD SP, HL
    2076/     9C9 : 11 9A 30            	ld	de, RNSP
    2077/     9CC : CD 11 12            	call	mk_rcs		; "SP, "
    2078/     9CF : C3 E2 11            	jp	hl_crlf
    2079/     9D2 :                     	
    2080/     9D2 :                     ; LD A, (BC)
    2081/     9D2 :                     ld_a_kbck:
    2082/     9D2 : 11 59 30            	ld	de, RNBC
    2083/     9D5 :                     ld_a_kxxk:
    2084/     9D5 : D5                  	push	de
    2085/     9D6 : CD 0E 12            	call	a_colon_sp	; "A, "
    2086/     9D9 : D1                  	pop	de
    2087/     9DA : CD F6 11            	call	mk_krk		; "(BC)", "(DE)"
    2088/     9DD : C3 E8 11            	jp	insPostStr	; CR, LF, 00h
    2089/     9E0 :                     
    2090/     9E0 :                     ; LD A, (DE)
    2091/     9E0 :                     ld_a_kdek:
    2092/     9E0 : 11 60 30            	ld	de, RNDE
    2093/     9E3 : C3 D5 09            	jp	ld_a_kxxk	;jr	ld_a_kxxk
    2094/     9E6 :                     
    2095/     9E6 :                     ; LD (BC), A
    2096/     9E6 :                     ld_kbck_a:
    2097/     9E6 : 11 59 30            	ld	de, RNBC
    2098/     9E9 :                     
    2099/     9E9 :                     ld_kxxk_a:
    2100/     9E9 : CD FF 11            	call	mk_krkcs	; "(BC), ", "(DE), "
    2101/     9EC : C3 D4 11            	jp	a_crlf		; "A",CR,LF
    2102/     9EF :                     
    2103/     9EF :                     ; LD (DE), A
    2104/     9EF :                     ld_kdek_a:
    2105/     9EF : 11 60 30            	ld	de, RNDE
    2106/     9F2 : C3 E9 09            	jp	ld_kxxk_a	;jr	ld_kxxk_a
    2107/     9F5 :                     
    2108/     9F5 :                     ; check other 1byte LD MC
    2109/     9F5 :                     
    2110/     9F5 :                     chk_ld1:
    2111/     9F5 : FE 40               	cp	40h
    2112/     9F7 : DA 9F 0A            	jp	c, chk_inc
    2113/     9FA : FE 80               	cp	80h
    2114/     9FC : D2 29 0A            	jp	nc,chk_add	;jr	nc, chk_add
    2115/     9FF : FE 76               	cp	76h	; HALT?
    2116/     A01 : C2 0A 0A            	jp	nz,LD1op	;jr	nz, LD1op
    2117/     A04 :                     
    2118/     A04 : 11 03 13            	ld	de, HLTstr	; HALT string
    2119/     A07 : C3 B6 11            	jp	mkopcstr	; de : next string buffer addr
    2120/     A0A :                     
    2121/     A0A :                     ; LD
    2122/     A0A :                     
    2123/     A0A :                     LD1op:
    2124/     A0A : CD A7 09            	call	get_r_num
    2125/     A0D : CD 2B 11            	call	get_rstg_off
    2126/     A10 : 21 8F 9F            	ld	hl, dasm_OprStr
    2127/     A13 : CD 11 12            	call	mk_rcs		; "REG, "
    2128/     A16 :                     
    2129/     A16 :                     mk_2ndopr:
    2130/     A16 : EB                  	EX	HL,DE			;Z80 CODE ld	de, (dasm_adr)
    2131/     A17 : 2A 6D 9F            	LD	HL,(dasm_adr)		;###############################
    2132/     A1A : EB                  	EX	HL,DE			;###############################
    2133/     A1B : 1A                  	ld	a, (de)		; get opcode
    2134/     A1C : E6 07               	and	07h
    2135/     A1E : 4F                  	ld	c, a
    2136/     A1F : 06 00               	ld	b, 0
    2137/     A21 :                     
    2138/     A21 :                     mk_2ndopr1:
    2139/     A21 : E5                  	push	hl		; save copy buffer
    2140/     A22 : CD 2B 11            	call	get_rstg_off
    2141/     A25 : E1                  	pop	hl		; copy buffer
    2142/     A26 : C3 E5 11            	jp	cpstr_crlf	; "REG",CR,LF
    2143/     A29 :                     
    2144/     A29 :                     ; ADD 80H - 87H
    2145/     A29 :                     ; check ADD code
    2146/     A29 :                     
    2147/     A29 :                     chk_add:
    2148/     A29 : FE 88               	cp	88h
    2149/     A2B : D2 37 0A            	jp	nc,chk_adc	;jr	nc, chk_adc
    2150/     A2E :                     
    2151/     A2E :                     ; ADD
    2152/     A2E : CD B3 11            	call	add_opstr
    2153/     A31 : CD 0E 12            	call	a_colon_sp
    2154/     A34 : C3 16 0A            	jp	mk_2ndopr	;jr	mk_2ndopr
    2155/     A37 :                     
    2156/     A37 :                     ; ADC 88H - 8FH
    2157/     A37 :                     ; check ADC code
    2158/     A37 :                     
    2159/     A37 :                     chk_adc:
    2160/     A37 : FE 90               	cp	90h
    2161/     A39 : D2 48 0A            	jp	nc,chk_sub	;jr	nc, chk_sub
    2162/     A3C :                     
    2163/     A3C :                     ; ADC
    2164/     A3C : 11 0C 13            	ld	de, ADCstr
    2165/     A3F : CD B6 11            	call	mkopcstr
    2166/     A42 : CD 0E 12            	call	a_colon_sp
    2167/     A45 : C3 16 0A            	jp	mk_2ndopr	;jr	mk_2ndopr
    2168/     A48 :                     
    2169/     A48 :                     ; SUB 90H - 97H
    2170/     A48 :                     ; check SUB code
    2171/     A48 :                     
    2172/     A48 :                     chk_sub:
    2173/     A48 : FE 98               	cp	98h
    2174/     A4A : D2 56 0A            	jp	nc,chk_sbc	;jr	nc, chk_sbc
    2175/     A4D :                     
    2176/     A4D :                     ; SUB
    2177/     A4D : 11 10 13            	ld	de, SUBstr
    2178/     A50 : CD B6 11            	call	mkopcstr
    2179/     A53 : C3 16 0A            	jp	mk_2ndopr	;jr	mk_2ndopr
    2180/     A56 :                     
    2181/     A56 :                     ; SBC 98H - 9FH
    2182/     A56 :                     ; check SBC code
    2183/     A56 :                     
    2184/     A56 :                     chk_sbc:
    2185/     A56 : FE A0               	cp	0A0h
    2186/     A58 : D2 67 0A            	jp	nc,chk_and	;jr	nc, chk_and
    2187/     A5B :                     
    2188/     A5B :                     ; SBC
    2189/     A5B : 11 14 13            	ld	de, SBCstr
    2190/     A5E : CD B6 11            	call	mkopcstr
    2191/     A61 : CD 0E 12            	call	a_colon_sp
    2192/     A64 : C3 16 0A            	jp	mk_2ndopr	;jr	mk_2ndopr
    2193/     A67 :                     
    2194/     A67 :                     ; AND 0A0H - 0A7H
    2195/     A67 :                     ; check AND code
    2196/     A67 :                     
    2197/     A67 :                     chk_and:
    2198/     A67 : FE A8               	cp	0A8h
    2199/     A69 : D2 75 0A            	jp	nc,chk_xor	;jr	nc, chk_xor
    2200/     A6C :                     
    2201/     A6C :                     ; AND
    2202/     A6C : 11 18 13            	ld	de, ANDstr
    2203/     A6F : CD B6 11            	call	mkopcstr
    2204/     A72 : C3 16 0A            	jp	mk_2ndopr	;jr	mk_2ndopr
    2205/     A75 :                     
    2206/     A75 :                     ; XOR 0A8H - 0AFH
    2207/     A75 :                     ; check XOR code
    2208/     A75 :                     
    2209/     A75 :                     chk_xor:
    2210/     A75 :                     
    2211/     A75 : FE B0               	cp	0B0h
    2212/     A77 : D2 83 0A            	jp	nc,chk_or	;jr	nc, chk_or
    2213/     A7A :                     
    2214/     A7A :                     ; XOR
    2215/     A7A : 11 1C 13            	ld	de, XORstr
    2216/     A7D : CD B6 11            	call	mkopcstr
    2217/     A80 : C3 16 0A            	jp	mk_2ndopr	;jr	mk_2ndopr
    2218/     A83 :                     
    2219/     A83 :                     ; OR 0B0H - 0B7H
    2220/     A83 :                     ; check OR code
    2221/     A83 :                     
    2222/     A83 :                     chk_or:
    2223/     A83 : FE B8               	cp	0B8h
    2224/     A85 : D2 91 0A            	jp	nc,chk_cp	;jr	nc, chk_cp
    2225/     A88 :                     
    2226/     A88 :                     ; OR
    2227/     A88 : 11 20 13            	ld	de, ORstr
    2228/     A8B : CD B6 11            	call	mkopcstr
    2229/     A8E : C3 16 0A            	jp	mk_2ndopr	;jr	mk_2ndopr
    2230/     A91 :                     
    2231/     A91 :                     ; CP 0B8H - 0BFH
    2232/     A91 :                     ; check CP code
    2233/     A91 :                     
    2234/     A91 :                     chk_cp:
    2235/     A91 : FE C0               	cp	0C0h
    2236/     A93 : D2 26 0B            	jp	nc, chk_pop_rp
    2237/     A96 :                     
    2238/     A96 :                     ; CP
    2239/     A96 : 11 23 13            	ld	de, CPstr
    2240/     A99 : CD B6 11            	call	mkopcstr
    2241/     A9C : C3 16 0A            	jp	mk_2ndopr	;jr	mk_2ndopr
    2242/     A9F :                     
    2243/     A9F :                     ;check INC
    2244/     A9F :                     
    2245/     A9F :                     chk_inc:
    2246/     A9F : 01 08 00            	ld	bc, INC_OPCDTBLE - INC_OPCDTBLS
    2247/     AA2 : 21 51 12            	ld	hl, INC_OPCDTBLS
    2248/     AA5 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    2249/     AA8 : C2 B9 0A            	jp	nz,chk_dec	;jr	nz, chk_dec
    2250/     AAB :                     
    2251/     AAB :                     ; INC
    2252/     AAB : F5                  	push	af
    2253/     AAC : 11 26 13            	ld	de, INCstr
    2254/     AAF : CD B6 11            	call	mkopcstr
    2255/     AB2 : F1                  	pop	af
    2256/     AB3 :                     
    2257/     AB3 :                     inc_dec:
    2258/     AB3 : CD A7 09            	call	get_r_num
    2259/     AB6 : C3 21 0A            	jp	mk_2ndopr1
    2260/     AB9 :                     
    2261/     AB9 :                     ;check dec
    2262/     AB9 :                     
    2263/     AB9 :                     chk_dec:
    2264/     AB9 : 01 08 00            	ld	bc, DEC_OPCDTBLE - DEC_OPCDTBLS
    2265/     ABC : 21 59 12            	ld	hl, DEC_OPCDTBLS
    2266/     ABF : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    2267/     AC2 : C2 D0 0A            	jp	nz, chk_inc_rp		;jr	nz, chk_inc_rp
    2268/     AC5 :                     
    2269/     AC5 :                     ; DEC
    2270/     AC5 : F5                  	push	af
    2271/     AC6 : 11 2A 13            	ld	de, DECstr
    2272/     AC9 : CD B6 11            	call	mkopcstr
    2273/     ACC : F1                  	pop	af
    2274/     ACD : C3 B3 0A            	jp	inc_dec			;jr	inc_dec
    2275/     AD0 :                     
    2276/     AD0 :                     ; check inc rp
    2277/     AD0 :                     
    2278/     AD0 :                     chk_inc_rp:
    2279/     AD0 : 01 04 00            	ld	bc, inc_rp_e - inc_rp_s
    2280/     AD3 : 21 61 12            	ld	hl, inc_rp_s
    2281/     AD6 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    2282/     AD9 : C2 EB 0A            	jp	nz, chk_dec_rp
    2283/     ADC :                     
    2284/     ADC :                     ; INC rp
    2285/     ADC : 11 26 13            	ld	de, INCstr
    2286/     ADF : CD B6 11            	call	mkopcstr
    2287/     AE2 :                     
    2288/     AE2 : 21 43 14            	ld	hl, INC_DEC_ADDrp
    2289/     AE5 : CD 22 11            	call	mk_str
    2290/     AE8 : C3 E8 11            	jp	insPostStr	; CR, LF, 00h
    2291/     AEB :                     
    2292/     AEB :                     ; check dec rp
    2293/     AEB :                     
    2294/     AEB :                     chk_dec_rp:
    2295/     AEB : 01 04 00            	ld	bc, dec_rp_e - dec_rp_s
    2296/     AEE : 21 65 12            	ld	hl, dec_rp_s
    2297/     AF1 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    2298/     AF4 : C2 06 0B            	jp	nz, chk_add_rp		;jr	nz, chk_add_rp
    2299/     AF7 :                     
    2300/     AF7 :                     ; dec rp
    2301/     AF7 : 11 2A 13            	ld	de, DECstr
    2302/     AFA : CD B6 11            	call	mkopcstr
    2303/     AFD :                     
    2304/     AFD : 21 43 14            	ld	hl, INC_DEC_ADDrp
    2305/     B00 : CD 22 11            	call	mk_str
    2306/     B03 : C3 E8 11            	jp	insPostStr	; CR, LF, 00h
    2307/     B06 :                     
    2308/     B06 :                     ;check ADD HL, rp
    2309/     B06 :                     
    2310/     B06 :                     chk_add_rp:
    2311/     B06 : 01 04 00            	ld	bc, add_rp_e - add_rp_s
    2312/     B09 : 21 69 12            	ld	hl, add_rp_s
    2313/     B0C : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    2314/     B0F : C2 5C 0B            	jp	nz, chk_ex		;jr	nz, chk_ex
    2315/     B12 :                     
    2316/     B12 :                     ; add hl, rp
    2317/     B12 :                     
    2318/     B12 : CD B3 11            	call	add_opstr
    2319/     B15 :                     
    2320/     B15 : 11 67 30            	ld	de, RNHL
    2321/     B18 : CD 11 12            	call	mk_rcs		; "HL, "
    2322/     B1B :                     
    2323/     B1B : E5                  	push	hl
    2324/     B1C : 21 43 14            	ld	hl, INC_DEC_ADDrp
    2325/     B1F : CD 2E 11            	call	get_strBufpoint
    2326/     B22 : E1                  	pop	hl
    2327/     B23 : C3 E5 11            	jp	cpstr_crlf	; CR, LF, 00h
    2328/     B26 :                     
    2329/     B26 :                     ; check POP rp
    2330/     B26 :                     
    2331/     B26 :                     chk_pop_rp:
    2332/     B26 : 01 04 00            	ld	bc, pop_rp_e - pop_rp_s
    2333/     B29 : 21 6D 12            	ld	hl, pop_rp_s
    2334/     B2C : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    2335/     B2F : C2 41 0B            	jp	nz, chk_push_rp		;jr	nz, chk_push_rp
    2336/     B32 :                     
    2337/     B32 :                     ; POP RP
    2338/     B32 :                     
    2339/     B32 : 11 2E 13            	ld	de, POPstr
    2340/     B35 : CD B6 11            	call	mkopcstr
    2341/     B38 :                     
    2342/     B38 : 21 4B 14            	ld	hl, POP_PUSHrp
    2343/     B3B : CD 22 11            	call	mk_str
    2344/     B3E : C3 E8 11            	jp	insPostStr	; CR, LF, 00h
    2345/     B41 :                     
    2346/     B41 :                     ; check PUSH rp
    2347/     B41 :                     
    2348/     B41 :                     chk_push_rp:
    2349/     B41 : 01 04 00            	ld	bc, push_rp_e - push_rp_s
    2350/     B44 : 21 71 12            	ld	hl, push_rp_s
    2351/     B47 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    2352/     B4A : C2 5C 0B            	jp	nz, chk_ex	;jr	nz, chk_ex
    2353/     B4D :                     
    2354/     B4D :                     ; PUSH RP
    2355/     B4D :                     
    2356/     B4D : 11 32 13            	ld	de, PUSHstr
    2357/     B50 : CD B6 11            	call	mkopcstr
    2358/     B53 :                     
    2359/     B53 : 21 4B 14            	ld	hl, POP_PUSHrp
    2360/     B56 : CD 22 11            	call	mk_str
    2361/     B59 : C3 E8 11            	jp	insPostStr	; CR, LF, 00h
    2362/     B5C :                     
    2363/     B5C :                     ; check EX XX, XX
    2364/     B5C :                     
    2365/     B5C :                     chk_ex:
    2366/     B5C : FE 08               	cp	08H		; EX	AF,AF'
    2367/     B5E : CA 7A 0B            	jp	z, ex_af_af	;jr	z, ex_af_af
    2368/     B61 : FE E3               	cp	0E3H		; EX	(SP),HL
    2369/     B63 : CA 89 0B            	jp	z, dex_sp_hl	;jr	z, dex_sp_hl
    2370/     B66 : FE EB               	cp	0EBH		; EX	DE,HL
    2371/     B68 : C2 92 0B            	jp	nz, chk_1mc_bnh	;jr	nz, chk_1mc_bnh
    2372/     B6B :                     
    2373/     B6B :                     ; EX DE, HL
    2374/     B6B : 11 60 30            	ld	de, RNDE
    2375/     B6E : CD 11 12            	call	mk_rcs
    2376/     B71 :                     
    2377/     B71 :                     ins_hl_opr:
    2378/     B71 : CD E2 11            	call	hl_crlf
    2379/     B74 :                     
    2380/     B74 :                     ins_ex_opc:
    2381/     B74 : 11 37 13            	ld	de, EXstr
    2382/     B77 : C3 B6 11            	jp	mkopcstr
    2383/     B7A :                     
    2384/     B7A :                     ; EX AF,AF'
    2385/     B7A :                     ex_af_af:
    2386/     B7A : 11 E1 12            	ld	de, RNAF
    2387/     B7D : CD 11 12            	call	mk_rcs
    2388/     B80 : 11 E4 12            	ld	de, RNAFX
    2389/     B83 : CD E5 11            	call	cpstr_crlf
    2390/     B86 : C3 74 0B            	jp ins_ex_opc		;jr ins_ex_opc
    2391/     B89 :                     
    2392/     B89 :                     ; EX (SP),HL
    2393/     B89 :                     dex_sp_hl:
    2394/     B89 : 11 9A 30            	ld	de, RNSP
    2395/     B8C : CD FF 11            	call	mk_krkcs
    2396/     B8F : C3 71 0B            	jp	ins_hl_opr	;jr	ins_hl_opr
    2397/     B92 :                     
    2398/     B92 :                     ; check other one MC code
    2399/     B92 :                     
    2400/     B92 :                     chk_1mc_bnh:
    2401/     B92 :                     
    2402/     B92 :                     ; check JP (HL)
    2403/     B92 :                     
    2404/     B92 : FE E9               	cp	0E9H		; JP (HL) ?
    2405/     B94 : C2 A6 0B            	jp	nz, chk_ret	;jr	nz, chk_ret
    2406/     B97 :                     
    2407/     B97 :                     ; JP (HL)
    2408/     B97 : 11 EC 12            	ld	de, JPstr
    2409/     B9A : CD B6 11            	call	mkopcstr	; "JP "
    2410/     B9D :                     
    2411/     B9D : 11 67 30            	ld	de, RNHL
    2412/     BA0 : CD F3 11            	call	mk_krk_1
    2413/     BA3 : C3 E8 11            	jp	insPostStr
    2414/     BA6 :                     
    2415/     BA6 :                     ; check RET CC
    2416/     BA6 :                     chk_ret:
    2417/     BA6 : 01 08 00            	ld	bc, RETCC_TBLE - RETCC_TBLS
    2418/     BA9 : 21 6F 06            	ld	hl, RETCC_TBLS
    2419/     BAC : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    2420/     BAF : C2 C1 0B            	jp	nz, chk_rst	;jr	nz, chk_rst
    2421/     BB2 :                     
    2422/     BB2 :                     ; RET CC
    2423/     BB2 :                     ; BC : 7 >= BC >= 0
    2424/     BB2 :                     
    2425/     BB2 :                     	; make opcode string
    2426/     BB2 : 11 E8 12            	ld	de, RETstr
    2427/     BB5 : CD B6 11            	call	mkopcstr
    2428/     BB8 :                     
    2429/     BB8 :                     	; make operand string
    2430/     BB8 :                     
    2431/     BB8 : 21 2B 14            	ld	hl, CC_opr	; string base
    2432/     BBB : CD 22 11            	call	mk_str
    2433/     BBE : C3 E8 11            	jp	insPostStr	; CR, LF, 00h
    2434/     BC1 :                     
    2435/     BC1 :                     ; check RST p
    2436/     BC1 :                     
    2437/     BC1 :                     chk_rst:
    2438/     BC1 : 01 08 00            	ld	bc, RST_TBLE - RST_TBLS
    2439/     BC4 : 21 8C 06            	ld	hl, RST_TBLS
    2440/     BC7 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    2441/     BCA : C2 E1 0B            	jp	nz, chk_2MC	;jr	nz, chk_2MC		; 2bytes MC
    2442/     BCD :                     
    2443/     BCD :                     ; RST p
    2444/     BCD :                     
    2445/     BCD : 11 FC 12            	ld	de, RSTstr
    2446/     BD0 : CD B6 11            	call	mkopcstr	; de : next string buffer addr
    2447/     BD3 :                     
    2448/     BD3 :                     ; 0 <= BC <= 7
    2449/     BD3 :                     ; 7: 00H  (0000 0 111 : 00 000 000)
    2450/     BD3 :                     ; 6: 08H  (0000 0 110 : 00 001 000)
    2451/     BD3 :                     ; 5: 10H  (0000 0 101 : 00 010 000)
    2452/     BD3 :                     ; 4: 18H  (0000 0 100 : 00 011 000)
    2453/     BD3 :                     ; 3: 20H  (0000 0 011 : 00 100 000)
    2454/     BD3 :                     ; 2: 28H  (0000 0 010 : 00 101 000)
    2455/     BD3 :                     ; 1: 30H  (0000 0 001 : 00 110 000)
    2456/     BD3 :                     ; 0: 38H  (0000 0 000 : 00 111 000)
    2457/     BD3 :                     ;
    2458/     BD3 : 79                  	ld	a, c
    2459/     BD4 : 2F                  	cpl		; not a
    2460/     BD5 : 87                  	ADD	A,A			;Z80 CODE sla	a ##############
    2461/     BD6 : 87                  	ADD	A,A			;Z80 CODE sla	a ##############
    2462/     BD7 : 87                  	ADD	A,A			;Z80 CODE sla	a ##############
    2463/     BD8 : E6 38               	and	38H	; a = RST No.
    2464/     BDA :                     
    2465/     BDA : 5F                  	ld	e, a
    2466/     BDB : 21 8F 9F            	ld	hl, dasm_OprStr
    2467/     BDE : C3 3B 11            	jp	mk_n2crlf	; "nnH", CR, LF
    2468/     BE1 :                     
    2469/     BE1 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2470/     BE1 :                     	; analysys 2 byte MC
    2471/     BE1 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2472/     BE1 :                     
    2473/     BE1 :                     chk_2MC:
    2474/     BE1 :                     
    2475/     BE1 : F5                  	push	af
    2476/     BE2 : 3E 02               	ld	a, 2
    2477/     BE4 : 32 73 9F            	ld	(mc_Size), a
    2478/     BE7 : F1                  	pop	af
    2479/     BE8 :                     
    2480/     BE8 :                     ; check LD r, nn
    2481/     BE8 :                     
    2482/     BE8 : 01 08 00            	ld	bc, ld_r_nn_e - ld_r_nn_s
    2483/     BEB : 21 43 07            	ld	hl, ld_r_nn_s
    2484/     BEE : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    2485/     BF1 : C2 0B 0C            	jp	nz, chk_logop2		;jr	nz, chk_logop2
    2486/     BF4 :                     
    2487/     BF4 :                     ; LD r, nn
    2488/     BF4 :                     
    2489/     BF4 : CD A7 09            	call	get_r_num
    2490/     BF7 : CD 2B 11            	call	get_rstg_off
    2491/     BFA : CD 11 12            	call	mk_rcs		; "REG, "
    2492/     BFD :                     
    2493/     BFD : EB                  	EX	HL,DE			;Z80 CODE ld	de, (dasm_adr)
    2494/     BFE : 2A 6D 9F            	LD	HL,(dasm_adr)		;###############################
    2495/     C01 : EB                  	EX	HL,DE			;###############################
    2496/     C02 : 13                  	inc	de
    2497/     C03 : 1A                  	ld	a, (de)		; get nn
    2498/     C04 : 5F                  	ld	e, a
    2499/     C05 : CD 80 11            	call	hex2str_asm	; "nnH"
    2500/     C08 : C3 E8 11            	jp	insPostStr	; CR, LF, 00h
    2501/     C0B :                     
    2502/     C0B :                     ; check logical operation with 8 bit literal
    2503/     C0B :                     
    2504/     C0B :                     chk_logop2:
    2505/     C0B :                     
    2506/     C0B : 01 0A 00            	ld	bc, log_op_e - log_op_s
    2507/     C0E : 21 4B 07            	ld	hl, log_op_s
    2508/     C11 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    2509/     C14 : C2 65 0C            	jp	nz, chk_djnz
    2510/     C17 :                     
    2511/     C17 :                     ; logical operation with 8 bit literal
    2512/     C17 :                     
    2513/     C17 :                     
    2514/     C17 : C5                  	push	bc
    2515/     C18 : 21 6D 14            	ld	hl, logop2str
    2516/     C1B : CD 2E 11            	call	get_strBufpoint
    2517/     C1E : CD B6 11            	call	mkopcstr		; make op code string
    2518/     C21 : C1                  	pop	bc
    2519/     C22 : 79                  	ld	a, c
    2520/     C23 :                     
    2521/     C23 : FE 01               	cp	1
    2522/     C25 : CA 3F 0C            	jp	z, acs_kn2k	;jr	z, acs_kn2k	; insert "A, (nn)"
    2523/     C28 : B7                  	or	a
    2524/     C29 : CA 48 0C            	jp	z, ins_kn2k	;jr	z, ins_kn2k	; insert "(nn), A"
    2525/     C2C : FE 07               	cp	7
    2526/     C2E : DA 34 0C            	jp	c, ins_n2crlf	;jr	c, ins_n2crlf	; insert  "nnH"
    2527/     C31 :                     
    2528/     C31 :                     ; insert "A, "
    2529/     C31 :                     
    2530/     C31 : CD 0E 12            	call	a_colon_sp
    2531/     C34 :                     
    2532/     C34 :                     ; "nn"
    2533/     C34 :                     ins_n2crlf:
    2534/     C34 : EB                  	EX	HL,DE			;Z80 CODE ld	de, (dasm_adr)
    2535/     C35 : 2A 6D 9F            	LD	HL,(dasm_adr)		;###############################
    2536/     C38 : EB                  	EX	HL,DE			;###############################
    2537/     C39 : 13                  	inc	de
    2538/     C3A : 1A                  	ld	a, (de)
    2539/     C3B : 5F                  	ld	e, a		; get nn
    2540/     C3C : C3 3B 11            	jp	mk_n2crlf	; "nnH", CR, LF
    2541/     C3F :                     
    2542/     C3F :                     acs_kn2k:
    2543/     C3F : CD 0E 12            	call	a_colon_sp	; "A, "
    2544/     C42 : CD 54 0C            	call	kn2k		; "(nnH)"
    2545/     C45 : C3 E8 11            	jp	insPostStr	; CR, LF, 00h
    2546/     C48 :                     
    2547/     C48 :                     ; "(nn), A"
    2548/     C48 :                     ins_kn2k:
    2549/     C48 : 21 8F 9F            	ld	hl, dasm_OprStr	;operand str buffer
    2550/     C4B : CD 54 0C            	call	kn2k		; "(nnH)"
    2551/     C4E : CD 3C 12            	call	ins_kmR		; " ,"
    2552/     C51 : C3 D4 11            	jp	a_crlf		; "A", CR, LF, 00h
    2553/     C54 :                     
    2554/     C54 :                     ; "(nnH)"
    2555/     C54 :                     kn2k:
    2556/     C54 : CD 23 12            	call	ins_kakkoL	; "("
    2557/     C57 : EB                  	EX	HL,DE			;Z80 CODE ld	de, (dasm_adr)
    2558/     C58 : 2A 6D 9F            	LD	HL,(dasm_adr)		;###############################
    2559/     C5B : EB                  	EX	HL,DE			;###############################
    2560/     C5C : 13                  	inc	de
    2561/     C5D : 1A                  	ld	a, (de)		; get nn
    2562/     C5E : 5F                  	ld	e, a		; e: nn
    2563/     C5F : CD 80 11            	call	hex2str_asm	; hex strings
    2564/     C62 : C3 28 12            	jp	ins_kakkoR	; ")"
    2565/     C65 :                     
    2566/     C65 :                     
    2567/     C65 :                     ; check DJNZ nn
    2568/     C65 :                     chk_djnz:
    2569/     C65 : FE 10               	cp	10H
    2570/     C67 : C2 70 0C            	jp	nz, chk_jrnn	;jr	nz, chk_jrnn
    2571/     C6A :                     
    2572/     C6A :                     ; check DJNZ nn
    2573/     C6A : 11 F2 12            	ld	de, DJNZstr
    2574/     C6D : C3 78 0C            	jp	jr_n4crlf	;jr	jr_n4crlf
    2575/     C70 :                     
    2576/     C70 :                     ; check jr nn
    2577/     C70 :                     chk_jrnn:
    2578/     C70 : FE 18               	cp	18H
    2579/     C72 : C2 81 0C            	jp	nz, chk_jrcc	;jr	nz, chk_jrcc	; not JR relative
    2580/     C75 :                     
    2581/     C75 :                     ; JR Relative
    2582/     C75 : 11 EF 12            	ld	de, JRstr
    2583/     C78 :                     jr_n4crlf:
    2584/     C78 : CD B6 11            	call	mkopcstr	; de : next string buffer addr
    2585/     C7B : 21 8F 9F            	ld	hl, dasm_OprStr
    2586/     C7E : C3 5F 11            	jp	mkRel_str	; "nnnnH",cr,lf : nnnn : branch address
    2587/     C81 :                     
    2588/     C81 :                     ; JR CC, nn
    2589/     C81 :                     
    2590/     C81 :                     chk_jrcc:
    2591/     C81 : 01 04 00            	ld	bc, JRCC_TBLE - JRCC_TBLS1
    2592/     C84 : 21 78 06            	ld	hl, JRCC_TBLS1
    2593/     C87 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    2594/     C8A : C2 9F 0C            	jp	nz, chk_3MC	;jr	nz, chk_3MC	; no, check 3 bnytes MC
    2595/     C8D :                     
    2596/     C8D :                     ; JR CC, nn(Relative Value)
    2597/     C8D :                     
    2598/     C8D : 11 EF 12            	ld	de, JRstr
    2599/     C90 : CD B6 11            	call	mkopcstr
    2600/     C93 : 21 3B 14            	ld	hl, JRCC_opr1	; string base
    2601/     C96 : CD 22 11            	call	mk_str		; "NZ", "Z", "NC", "C"
    2602/     C99 : CD 3C 12            	call	ins_kmR		; ", "
    2603/     C9C : C3 5F 11            	jp	mkRel_str	; "nnnnH", cr, lf
    2604/     C9F :                     
    2605/     C9F :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2606/     C9F :                     	; analysys 3 byte MC
    2607/     C9F :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2608/     C9F :                     
    2609/     C9F :                     chk_3MC:
    2610/     C9F : F5                  	push	af
    2611/     CA0 : 3E 03               	ld	a, 3
    2612/     CA2 : 32 73 9F            	ld	(mc_Size), a
    2613/     CA5 : F1                  	pop	af
    2614/     CA6 :                     
    2615/     CA6 : 01 04 00            	ld	bc, THREE_OPTBLe - THREE_OPTBL
    2616/     CA9 : 21 55 07            	ld	hl, THREE_OPTBL
    2617/     CAC : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    2618/     CAF : C2 C1 0C            	jp	nz, chk_ld16
    2619/     CB2 :                     
    2620/     CB2 :                     ; LD rp, nnnn
    2621/     CB2 :                     
    2622/     CB2 : 21 81 14            	ld	hl, logop3str
    2623/     CB5 : CD 2E 11            	call	get_strBufpoint
    2624/     CB8 : CD 11 12            	call	mk_rcs		; "Reg, "
    2625/     CBB :                     
    2626/     CBB :                     get_n4crlf:
    2627/     CBB : CD ED 0C            	call	get_n4
    2628/     CBE : C3 41 11            	jp	mk_n4crlf	; "nnnnH", CR, LF, 00h
    2629/     CC1 :                     
    2630/     CC1 :                     ; LD 16bit literal
    2631/     CC1 :                     chk_ld16:
    2632/     CC1 : FE 22               	cp	22h
    2633/     CC3 : CA DB 0C            	jp	z, ins_kkhl	;jr	z, ins_kkhl	; "(nnnnH), HL"
    2634/     CC6 : FE 32               	cp	32h
    2635/     CC8 : CA E1 0C            	jp	z,ins_kka	;jr	z, ins_kka	; "(nnnnH), A"
    2636/     CCB : FE 2A               	cp	2ah
    2637/     CCD : CA F7 0C            	jp	z,ins_hlkk	;jr	z, ins_hlkk	; "HL, (nnnnH)"
    2638/     CD0 : FE 3A               	cp	3ah
    2639/     CD2 : C2 06 0D            	jp	nz, chk_jpn4	; check jp n4
    2640/     CD5 :                     
    2641/     CD5 :                     ; "A, (nnnnH)"
    2642/     CD5 : CD 0E 12            	call	a_colon_sp	; "A, "
    2643/     CD8 : C3 FD 0C            	jp	kn4kcrlf	;jr	kn4kcrlf
    2644/     CDB :                     
    2645/     CDB :                     ; "(nnnnH), HL"
    2646/     CDB :                     ins_kkhl:
    2647/     CDB : CD E7 0C            	call	kn4hk
    2648/     CDE : C3 E2 11            	jp	hl_crlf		; "HL",cr,lf
    2649/     CE1 :                     
    2650/     CE1 :                     ; "(nnnnH), A"
    2651/     CE1 :                     ins_kka:
    2652/     CE1 : CD E7 0C            	call	kn4hk
    2653/     CE4 : C3 D4 11            	jp	a_crlf		; "A",cr,lf
    2654/     CE7 :                     
    2655/     CE7 :                     kn4hk:
    2656/     CE7 : CD ED 0C            	call	get_n4
    2657/     CEA : C3 47 11            	jp	ins_kn4kcs	; "(nnnnH), "
    2658/     CED :                     
    2659/     CED :                     get_n4:
    2660/     CED : E5                  	push	hl
    2661/     CEE : 2A 6D 9F            	ld	hl, (dasm_adr)
    2662/     CF1 : 23                  	inc	hl
    2663/     CF2 : 5E                  	ld	e, (hl)
    2664/     CF3 : 23                  	inc	hl
    2665/     CF4 : 56                  	ld	d, (hl)
    2666/     CF5 : E1                  	pop	hl
    2667/     CF6 : C9                  	ret
    2668/     CF7 :                     
    2669/     CF7 :                     ; "HL, (nnnnH)"
    2670/     CF7 :                     ins_hlkk:
    2671/     CF7 : 11 67 30            	ld	de, RNHL
    2672/     CFA : CD 11 12            	call	mk_rcs		; "HL ,"
    2673/     CFD :                     
    2674/     CFD :                     kn4kcrlf:
    2675/     CFD : CD ED 0C            	call	get_n4
    2676/     D00 : CD 56 11            	call	mk_kn4k		; "(nnnnH)"
    2677/     D03 : C3 E8 11            	jp	insPostStr	; cr, lf
    2678/     D06 :                     
    2679/     D06 :                     ; check JP literal
    2680/     D06 :                     
    2681/     D06 :                     chk_jpn4:
    2682/     D06 : FE C3               	cp	0C3H		; JP literal ?
    2683/     D08 : C2 14 0D            	jp	nz, chk_calln4	;jr	nz, chk_calln4	; not JP literal
    2684/     D0B :                     
    2685/     D0B :                     ; "JP nnnnH"
    2686/     D0B :                     
    2687/     D0B : 11 EC 12            	ld	de, JPstr
    2688/     D0E : CD B6 11            	call	mkopcstr	; de : next string buffer addr
    2689/     D11 : C3 BB 0C            	jp	get_n4crlf	;jr	get_n4crlf
    2690/     D14 :                     
    2691/     D14 :                     ; check call literal
    2692/     D14 :                     
    2693/     D14 :                     chk_calln4:
    2694/     D14 : FE CD               	cp	0CDH		; CALL literal ?
    2695/     D16 : C2 22 0D            	jp	nz, chk_jpcc	;jr	nz, chk_jpcc
    2696/     D19 :                     
    2697/     D19 :                     ; "CALL nnnnH",cr,lf
    2698/     D19 :                     
    2699/     D19 : 11 F7 12            	ld	de, CALLstr
    2700/     D1C : CD B6 11            	call	mkopcstr	; de : next string buffer addr
    2701/     D1F : C3 BB 0C            	jp	get_n4crlf	;jr	get_n4crlf
    2702/     D22 :                     
    2703/     D22 :                     
    2704/     D22 :                     ; check 3 byte machine code: branch JP CC, nnnn
    2705/     D22 :                     
    2706/     D22 :                     chk_jpcc:
    2707/     D22 : 01 08 00            	ld	bc, JPCC_TBLE - JPCC_TBLS
    2708/     D25 : 21 7C 06            	ld	hl, JPCC_TBLS
    2709/     D28 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    2710/     D2B : C2 40 0D            	jp	nz, chk_calcc	;jr	nz, chk_calcc
    2711/     D2E :                     
    2712/     D2E :                     ; JP CC, nnnn
    2713/     D2E :                     ; BC : 7 >= BC >= 0
    2714/     D2E :                     
    2715/     D2E : 11 EC 12            	ld	de, JPstr
    2716/     D31 :                     
    2717/     D31 :                     CC_NNNN:
    2718/     D31 : CD B6 11            	call	mkopcstr	; de : next string buffer addr
    2719/     D34 :                     
    2720/     D34 : 21 2B 14            	ld	hl, CC_opr	; string base
    2721/     D37 : CD 22 11            	call	mk_str		; de: point (string end) + 1
    2722/     D3A : CD 3C 12            	call	ins_kmR		; " ,"
    2723/     D3D : C3 BB 0C            	jp	get_n4crlf	;jr	get_n4crlf	; "nnnnh", cr,lf
    2724/     D40 :                     
    2725/     D40 :                     
    2726/     D40 :                     ; check 3 byte machine code: branch (CALL CC, nnnn 16bit literal)
    2727/     D40 :                     
    2728/     D40 :                     chk_calcc:
    2729/     D40 : 01 08 00            	ld	bc, CLCC_TBLE - CLCC_TBLS
    2730/     D43 : 21 84 06            	ld	hl, CLCC_TBLS
    2731/     D46 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    2732/     D49 : C2 52 0D            	jp	nz, chk_0CBH	;jr	nz, chk_0CBH
    2733/     D4C :                     
    2734/     D4C :                     ; CALL CC, nnnn
    2735/     D4C :                     ; BC : 7 >= BC >= 0 CALLstr
    2736/     D4C :                     
    2737/     D4C : 11 F7 12            	ld	de, CALLstr
    2738/     D4F : C3 31 0D            	jp	CC_NNNN		;jr	CC_NNNN
    2739/     D52 :                     
    2740/     D52 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2741/     D52 :                     	; OPECODE 0CBH check
    2742/     D52 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2743/     D52 :                     
    2744/     D52 :                     chk_0CBH:
    2745/     D52 : 2A 6D 9F            	ld	hl, (dasm_adr)
    2746/     D55 : 23                  	inc	hl		; 2nd opecode address
    2747/     D56 :                     
    2748/     D56 : F5                  	push	af
    2749/     D57 : 3E 02               	ld	a, 2
    2750/     D59 : 32 73 9F            	ld	(mc_Size), a	; set 2bytes MC
    2751/     D5C : F1                  	pop	af
    2752/     D5D :                     
    2753/     D5D : FE CB               	cp	0cbh
    2754/     D5F : C2 18 0E            	jp	nz, chk_0DDH
    2755/     D62 :                     
    2756/     D62 : 7E                  	ld	a, (hl)		; a : 2nd opecode
    2757/     D63 : 21 8F 9F            	ld	hl, dasm_OprStr ; set operand string buffer
    2758/     D66 :                     
    2759/     D66 : FE 08               	cp	08h
    2760/     D68 : DA A1 0D            	jp	c, mk_rlcr
    2761/     D6B : FE 10               	cp	10h
    2762/     D6D : DA AA 0D            	jp	c, mk_rrcr
    2763/     D70 : FE 18               	cp	18h
    2764/     D72 : DA B3 0D            	jp	c, mk_rlr
    2765/     D75 : FE 20               	cp	20h
    2766/     D77 : DA BC 0D            	jp	c, mk_rrr
    2767/     D7A : FE 28               	cp	28h
    2768/     D7C : DA C5 0D            	jp	c, mk_slar
    2769/     D7F : FE 30               	cp	30h
    2770/     D81 : DA CE 0D            	jp	c, mk_srar
    2771/     D84 : FE 38               	cp	38h
    2772/     D86 : DA F2 0D            	jp	c, op_err
    2773/     D89 : FE 40               	cp	40h
    2774/     D8B : DA D7 0D            	jp	c, mk_srlr
    2775/     D8E : FE 80               	cp	80h
    2776/     D90 : DA E0 0D            	jp	c, mk_bitr
    2777/     D93 : FE C0               	cp	0c0h
    2778/     D95 : DA E9 0D            	jp	c, mk_resr
    2779/     D98 :                     
    2780/     D98 :                     ; make SET n, r, SET n, (HL)
    2781/     D98 :                     
    2782/     D98 : CD F8 0D            	call	mk_bitr_str
    2783/     D9B : 11 F6 13            	ld	de, SETstr
    2784/     D9E : C3 B6 11            	jp	mkopcstr
    2785/     DA1 :                     
    2786/     DA1 :                     
    2787/     DA1 :                     ; make RLC r, RLC (HL)
    2788/     DA1 :                     mk_rlcr:
    2789/     DA1 : CD FD 0D            	call	ins_rstg
    2790/     DA4 : 11 71 13            	ld	de, RLCstr
    2791/     DA7 : C3 B6 11            	jp	mkopcstr
    2792/     DAA :                     
    2793/     DAA :                     ; make RRC r, RRC (HL)
    2794/     DAA :                     mk_rrcr:
    2795/     DAA : CD FD 0D            	call	ins_rstg
    2796/     DAD : 11 75 13            	ld	de, RRCstr
    2797/     DB0 : C3 B6 11            	jp	mkopcstr
    2798/     DB3 :                     
    2799/     DB3 :                     ; make RL r, RL (HL)
    2800/     DB3 :                     mk_rlr:
    2801/     DB3 : CD FD 0D            	call	ins_rstg
    2802/     DB6 : 11 79 13            	ld	de, RLstr
    2803/     DB9 : C3 B6 11            	jp	mkopcstr
    2804/     DBC :                     
    2805/     DBC :                     ; make RR r, RR (HL)
    2806/     DBC :                     mk_rrr:
    2807/     DBC : CD FD 0D            	call	ins_rstg
    2808/     DBF : 11 7C 13            	ld	de, RRstr
    2809/     DC2 : C3 B6 11            	jp	mkopcstr
    2810/     DC5 :                     
    2811/     DC5 :                     ; make SLA r, SLA (HL)
    2812/     DC5 :                     mk_slar:
    2813/     DC5 : CD FD 0D            	call	ins_rstg
    2814/     DC8 : 11 7F 13            	ld	de, SLAstr
    2815/     DCB : C3 B6 11            	jp	mkopcstr
    2816/     DCE :                     
    2817/     DCE :                     ; make SRA r, SRA (HL)
    2818/     DCE :                     mk_srar:
    2819/     DCE : CD FD 0D            	call	ins_rstg
    2820/     DD1 : 11 83 13            	ld	de, SRAstr
    2821/     DD4 : C3 B6 11            	jp	mkopcstr
    2822/     DD7 :                     
    2823/     DD7 :                     ; make SRL r, SRL (HL)
    2824/     DD7 :                     mk_srlr:
    2825/     DD7 : CD FD 0D            	call	ins_rstg
    2826/     DDA : 11 87 13            	ld	de, SRLstr
    2827/     DDD : C3 B6 11            	jp	mkopcstr
    2828/     DE0 :                     
    2829/     DE0 :                     ; make BIT n, r, BIT n, (HL)
    2830/     DE0 :                     mk_bitr:
    2831/     DE0 : CD F8 0D            	call	mk_bitr_str
    2832/     DE3 : 11 8B 13            	ld	de, BITstr
    2833/     DE6 : C3 B6 11            	jp	mkopcstr
    2834/     DE9 :                     
    2835/     DE9 :                     ; make RES n, r, RES n, (HL)
    2836/     DE9 :                     mk_resr:
    2837/     DE9 : CD F8 0D            	call	mk_bitr_str
    2838/     DEC : 11 8F 13            	ld	de, RESstr
    2839/     DEF : C3 B6 11            	jp	mkopcstr
    2840/     DF2 :                     
    2841/     DF2 :                     op_err:
    2842/     DF2 : 11 FA 13            	ld	de, ER_OPMSG
    2843/     DF5 : C3 B6 11            	jp	mkopcstr
    2844/     DF8 :                     
    2845/     DF8 :                     ;-------------------------------------------
    2846/     DF8 :                     ; input a : 2nd opecode
    2847/     DF8 :                     ;	hl : make string buffer
    2848/     DF8 :                     ; make "bit No, r" string to *hl
    2849/     DF8 :                     ; (ex) *hl = "1, B"
    2850/     DF8 :                     ;-------------------------------------------
    2851/     DF8 :                     mk_bitr_str:
    2852/     DF8 : F5                  	push	af
    2853/     DF9 : CD 0A 0E            	call	set_bitno
    2854/     DFC : F1                  	pop	af
    2855/     DFD :                     
    2856/     DFD :                     ins_rstg:
    2857/     DFD : E6 07               	and	07h
    2858/     DFF : 4F                  	ld	c, a	; table offset
    2859/     E00 : 06 00               	ld	b, 0		; bc : string offset
    2860/     E02 : E5                  	push	hl
    2861/     E03 : CD 2B 11            	call	get_rstg_off	; get string address to de
    2862/     E06 : E1                  	pop	hl
    2863/     E07 : C3 E5 11            	jp	cpstr_crlf	; "REG", CR, LF, 00h
    2864/     E0A :                     ;
    2865/     E0A :                     ; input hl : make string buffer
    2866/     E0A :                     ;
    2867/     E0A :                     set_bitno:
    2868/     E0A : E6 38               	and	38h
    2869/     E0C : 0F                  	rrca
    2870/     E0D : 0F                  	rrca
    2871/     E0E : 0F                  	rrca
    2872/     E0F : 47                  	ld	b, a	; bit number
    2873/     E10 :                     
    2874/     E10 : 3E 30               	ld	a, 30h
    2875/     E12 : B0                  	or	b		; a : bit string "0" - "7"
    2876/     E13 : 77                  	ld	(hl), a
    2877/     E14 : 23                  	inc	hl
    2878/     E15 : C3 3C 12            	jp	ins_kmR
    2879/     E18 :                     
    2880/     E18 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2881/     E18 :                     	; OPECODE 0DDH check
    2882/     E18 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2883/     E18 :                     
    2884/     E18 :                     chk_0DDH:
    2885/     E18 : FE DD               	cp	0ddh
    2886/     E1A : C2 D3 0F            	jp	nz, chk_0EDH
    2887/     E1D :                     
    2888/     E1D : 11 94 30            	ld	de, RNIX
    2889/     E20 : EB                  	EX	HL,DE			;Z80 CODE ld	(reg_xy), de	; save index reg string
    2890/     E21 : 22 6F 9F            	LD	(reg_xy),HL		;###############################
    2891/     E24 : EB                  	EX	HL,DE			;###############################
    2892/     E25 : 11 9D 14            	ld	de, addixrp_tbl
    2893/     E28 : EB                  	EX	HL,DE			;Z80 CODE ld	(xy_srtp), de
    2894/     E29 : 22 71 9F            	LD	(xy_srtp),HL		;###############################
    2895/     E2C : EB                  	EX	HL,DE			;###############################
    2896/     E2D :                     
    2897/     E2D :                     chk_0DDH_1:
    2898/     E2D :                     
    2899/     E2D : 7E                  	ld	a, (hl)		; get 2nd opcode
    2900/     E2E :                     
    2901/     E2E : FE E3               	cp	0E3h	; EX (SP),IX
    2902/     E30 : CA 77 0E            	jp	z, ins_kspkix
    2903/     E33 : FE E9               	cp	0E9h	; JP (IX)
    2904/     E35 : CA 64 0E            	jp	z, ins_jpix
    2905/     E38 : FE F9               	cp	0F9h	; LD SP, IX
    2906/     E3A : CA 86 0E            	jp	z, ins_spix
    2907/     E3D :                     
    2908/     E3D : 01 04 00            	ld	bc, DD_2NDTBL1 - DD_2NDTBL
    2909/     E40 : 21 5D 07            	ld	hl, DD_2NDTBL
    2910/     E43 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    2911/     E46 : CA 8F 0E            	jp	z, ins_ixrp
    2912/     E49 :                     
    2913/     E49 : 01 04 00            	ld	bc, DD_2NDTBL2 - DD_2NDTBL1
    2914/     E4C : 21 61 07            	ld	hl, DD_2NDTBL1
    2915/     E4F : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    2916/     E52 : C2 A5 0E            	jp	nz, chk_0DD3op
    2917/     E55 :                     
    2918/     E55 :                     ; INC	IX
    2919/     E55 :                     ; DEC	IX
    2920/     E55 :                     ; PUSH	IX
    2921/     E55 :                     ; POP	IX
    2922/     E55 : 21 95 14            	ld	hl, dd_2opt
    2923/     E58 : CD 2E 11            	call	get_strBufpoint
    2924/     E5B : CD B6 11            	call	mkopcstr		; inseert OPCODE strings to dasm_OpcStr
    2925/     E5E :                     
    2926/     E5E : 21 8F 9F            	ld	hl, dasm_OprStr
    2927/     E61 : C3 DA 11            	jp	ix_crlf			; "IX", CR, LF, 00h
    2928/     E64 :                     
    2929/     E64 :                     ; JP	(IX)
    2930/     E64 :                     ins_jpix:
    2931/     E64 : EB                  	EX	HL,DE			;Z80 CODE ld	de, (reg_xy)
    2932/     E65 : 2A 6F 9F            	LD	HL,(reg_xy)		;##############################
    2933/     E68 : EB                  	EX	HL,DE			;##############################
    2934/     E69 :                     ins_jpix1:
    2935/     E69 : D5                  	push	de
    2936/     E6A : 11 EC 12            	ld	de, JPstr
    2937/     E6D : CD B6 11            	call	mkopcstr	; de : next string buffer addr
    2938/     E70 :                     
    2939/     E70 : D1                  	pop	de
    2940/     E71 : CD F3 11            	call	mk_krk_1
    2941/     E74 : C3 E8 11            	jp	insPostStr	; CR, LF, 00h
    2942/     E77 :                     
    2943/     E77 :                     ; EX	(SP),IX
    2944/     E77 :                     ins_kspkix:
    2945/     E77 : 11 37 13            	ld	de, EXstr
    2946/     E7A : CD B6 11            	call	mkopcstr	; de : next string buffer addr
    2947/     E7D : 11 9A 30            	ld	de, RNSP
    2948/     E80 : CD FF 11            	call	mk_krkcs	; "(SP), "
    2949/     E83 : C3 DA 11            	jp	ix_crlf		; "IX",cr,lf
    2950/     E86 :                     
    2951/     E86 :                     ; LD	SP,IX
    2952/     E86 :                     ins_spix:
    2953/     E86 : 11 9A 30            	ld	de, RNSP
    2954/     E89 : CD 11 12            	call	mk_rcs		; "SP, "
    2955/     E8C : C3 DA 11            	jp	ix_crlf		; "IX",cr,lf
    2956/     E8F :                     
    2957/     E8F :                     ; ADD	IX,BC
    2958/     E8F :                     ; ADD	IX,DE
    2959/     E8F :                     ; ADD	IX,IX
    2960/     E8F :                     ; ADD	IX,SP
    2961/     E8F :                     ins_ixrp:
    2962/     E8F : CD B3 11            	call	add_opstr	; de : next string buffer addr
    2963/     E92 :                     
    2964/     E92 : EB                  	EX	HL,DE			;Z80 CODE ld	de, (reg_xy)
    2965/     E93 : 2A 6F 9F            	LD	HL,(reg_xy)		;##############################
    2966/     E96 : EB                  	EX	HL,DE			;##############################
    2967/     E97 : CD 11 12            	call	mk_rcs		; "IX, "
    2968/     E9A :                     
    2969/     E9A : E5                  	push	hl
    2970/     E9B : 2A 71 9F            	ld	hl, (xy_srtp)
    2971/     E9E : CD 2E 11            	call	get_strBufpoint
    2972/     EA1 : E1                  	pop	hl
    2973/     EA2 : C3 E5 11            	jp	cpstr_crlf	; "REG",cr,lf
    2974/     EA5 :                     
    2975/     EA5 :                     ;
    2976/     EA5 :                     ; check 0DD 3bytes MC
    2977/     EA5 :                     ;
    2978/     EA5 :                     chk_0DD3op:
    2979/     EA5 : F5                  	push	af
    2980/     EA6 : 3E 03               	ld	a, 3
    2981/     EA8 : 32 73 9F            	ld	(mc_Size), a	; 2byte machine code
    2982/     EAB : F1                  	pop	af
    2983/     EAC :                     
    2984/     EAC : 01 0E 00            	ld	bc, dd_ld_tble - dd_ld_tbl
    2985/     EAF : 21 75 12            	ld	hl, dd_ld_tbl
    2986/     EB2 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    2987/     EB5 : CA E7 0E            	jp	z, dd_ld
    2988/     EB8 :                     
    2989/     EB8 : FE 86               	cp	86h
    2990/     EBA : CA 14 0F            	jp	z, dd_mix
    2991/     EBD : FE 8E               	cp	8eh
    2992/     EBF : CA 20 0F            	jp	z, dd_mix1
    2993/     EC2 : FE 9E               	cp	9eh
    2994/     EC4 : CA 26 0F            	jp	z, dd_mix2
    2995/     EC7 :                     
    2996/     EC7 : 01 07 00            	ld	bc, dd_log_tble - dd_log_tbl
    2997/     ECA : 21 83 12            	ld	hl, dd_log_tbl
    2998/     ECD : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    2999/     ED0 : C2 2C 0F            	jp	nz, chk_0DD4op
    3000/     ED3 :                     
    3001/     ED3 :                     ;
    3002/     ED3 :                     ; make "SUB (IX+nn)", "AND (IX+nn)", "XOR (IX+nn)"
    3003/     ED3 :                     ;       "OR (IX+nn)",  "CP (IX+nn)"
    3004/     ED3 :                     ;      "INC (IX+nn)", "DEC (IX+nn)"
    3005/     ED3 :                     ;
    3006/     ED3 : 21 AD 14            	ld	hl, ddlogtbl
    3007/     ED6 : CD 2E 11            	call	get_strBufpoint
    3008/     ED9 : CD B6 11            	call	mkopcstr
    3009/     EDC :                     
    3010/     EDC :                     mk_kixpnk:
    3011/     EDC : EB                  	EX	HL,DE			;Z80 CODE ld	de, (reg_xy)
    3012/     EDD : 2A 6F 9F            	LD	HL,(reg_xy)		;##############################
    3013/     EE0 : EB                  	EX	HL,DE			;##############################
    3014/     EE1 :                     
    3015/     EE1 :                     mk_kiypnk:
    3016/     EE1 : 21 8F 9F            	ld	hl, dasm_OprStr
    3017/     EE4 : C3 F0 10            	jp	kixypnk_crlf		; "(IX+nnH)",cr,lf
    3018/     EE7 :                     
    3019/     EE7 :                     ;
    3020/     EE7 :                     ; make "LD (IX+nn), r" or "LD r, (IX+nn)"
    3021/     EE7 :                     ;
    3022/     EE7 :                     dd_ld:
    3023/     EE7 : 79                  	ld	a, c
    3024/     EE8 : FE 07               	cp	7
    3025/     EEA : D2 00 0F            	jp	nc, dd_ld1
    3026/     EED :                     	
    3027/     EED :                     ; LD (IX+nn), r
    3028/     EED : EB                  	EX	HL,DE			;Z80 CODE ld	de, (reg_xy)
    3029/     EEE : 2A 6F 9F            	LD	HL,(reg_xy)		;##############################
    3030/     EF1 : EB                  	EX	HL,DE			;##############################
    3031/     EF2 : CD E7 10            	call	kixypnk_cs	; make "(IX+nn), "
    3032/     EF5 :                     
    3033/     EF5 : E5                  	push	hl
    3034/     EF6 : 21 BB 14            	ld	hl, dd_ldtbl
    3035/     EF9 : CD 2E 11            	call	get_strBufpoint
    3036/     EFC : E1                  	pop	hl
    3037/     EFD : C3 E5 11            	jp	cpstr_crlf	; "A", "L", "H", "E", D", "C", "B"
    3038/     F00 :                     				; CR, LF, 00h
    3039/     F00 :                     	
    3040/     F00 :                     ; LD r, (IX+nn)
    3041/     F00 :                     dd_ld1:
    3042/     F00 : D6 07               	sub	7
    3043/     F02 : 4F                  	ld	c, a
    3044/     F03 : 21 BB 14            	ld	hl, dd_ldtbl
    3045/     F06 : CD 2E 11            	call	get_strBufpoint
    3046/     F09 :                     
    3047/     F09 : CD 11 12            	call	mk_rcs		; "REG, "
    3048/     F0C :                     dd_mix4:
    3049/     F0C : EB                  	EX	HL,DE			;Z80 CODE ld	de, (reg_xy)
    3050/     F0D : 2A 6F 9F            	LD	HL,(reg_xy)		;##############################
    3051/     F10 : EB                  	EX	HL,DE			;##############################
    3052/     F11 : C3 F0 10            	jp	kixypnk_crlf	; "(IX+nn)", CR, LF, 00h
    3053/     F14 :                     
    3054/     F14 :                     
    3055/     F14 :                     ; "ADD A,(IX+nn)"
    3056/     F14 :                     dd_mix:
    3057/     F14 : 11 08 13            	ld	de, ADDstr
    3058/     F17 :                     dd_mix3:
    3059/     F17 : CD B6 11            	call	mkopcstr	; "ADD"
    3060/     F1A : CD 0E 12            	call	a_colon_sp	; "A, "
    3061/     F1D : C3 0C 0F            	jp	dd_mix4		;jr	dd_mix4		; "(IX+nn)",cr,lf
    3062/     F20 :                     
    3063/     F20 :                     ;"ADC A,(IX+nn)"
    3064/     F20 :                     dd_mix1:
    3065/     F20 : 11 0C 13            	ld	de, ADCstr
    3066/     F23 : C3 17 0F            	jp	dd_mix3		;jr	dd_mix3
    3067/     F26 :                     
    3068/     F26 :                     ;"SBC A,(IX+nn)"
    3069/     F26 :                     dd_mix2:
    3070/     F26 : 11 14 13            	ld	de, SBCstr
    3071/     F29 : C3 17 0F            	jp	dd_mix3		;jr	dd_mix3
    3072/     F2C :                     
    3073/     F2C :                     ;
    3074/     F2C :                     ; check 0DD 4bytes MC
    3075/     F2C :                     ;
    3076/     F2C :                     chk_0DD4op:
    3077/     F2C : F5                  	push	af
    3078/     F2D : 3E 04               	ld	a, 4
    3079/     F2F : 32 73 9F            	ld	(mc_Size), a	; 2byte machine code
    3080/     F32 : F1                  	pop	af
    3081/     F33 :                     
    3082/     F33 : FE 21               	cp	21h
    3083/     F35 : CA 53 0F            	jp	z, DD_21
    3084/     F38 : FE 22               	cp	22h
    3085/     F3A : CA 61 0F            	jp	z, DD_22
    3086/     F3D : FE 2A               	cp	2ah
    3087/     F3F : CA 6A 0F            	jp	z, DD_2a
    3088/     F42 : FE 36               	cp	36h
    3089/     F44 : C2 7B 0F            	jp	nz, chk_DD_CB
    3090/     F47 :                     ; DD 36
    3091/     F47 :                     ; "LD (IX+xx), yy"
    3092/     F47 :                     
    3093/     F47 : EB                  	EX	HL,DE			;Z80 CODE ld	de, (reg_xy)
    3094/     F48 : 2A 6F 9F            	LD	HL,(reg_xy)		;##############################
    3095/     F4B : EB                  	EX	HL,DE			;##############################
    3096/     F4C : CD E7 10            	call	kixypnk_cs	; "(IX+xx), "
    3097/     F4F : 5A                  	ld	e, d		; e: yy
    3098/     F50 : C3 3B 11            	jp	mk_n2crlf	; "0yyH",cr,lf
    3099/     F53 :                     
    3100/     F53 :                     
    3101/     F53 :                     ; "LD IX, nnnn"
    3102/     F53 :                     DD_21:
    3103/     F53 : EB                  	EX	HL,DE			;Z80 CODE ld	de, (reg_xy)
    3104/     F54 : 2A 6F 9F            	LD	HL,(reg_xy)		;##############################
    3105/     F57 : EB                  	EX	HL,DE			;##############################
    3106/     F58 : CD 11 12            	call	mk_rcs		; "IX, "
    3107/     F5B : CD 17 11            	call	get_nnnn
    3108/     F5E : C3 41 11            	jp	mk_n4crlf	; "nnnnH",cr,lf
    3109/     F61 :                     
    3110/     F61 :                     ; "LD (nnnn), IX"
    3111/     F61 :                     DD_22:
    3112/     F61 : CD 17 11            	call	get_nnnn
    3113/     F64 : CD 47 11            	call	ins_kn4kcs	; "(nnnnH), "
    3114/     F67 : C3 DA 11            	jp	ix_crlf		; "IX",cr,lf
    3115/     F6A :                     
    3116/     F6A :                     ; "LD IX, (nnnn)"
    3117/     F6A :                     DD_2a:
    3118/     F6A : EB                  	EX	HL,DE			;Z80 CODE ld	de, (reg_xy)
    3119/     F6B : 2A 6F 9F            	LD	HL,(reg_xy)		;##############################
    3120/     F6E : EB                  	EX	HL,DE			;##############################
    3121/     F6F :                     DD_2a1:
    3122/     F6F : CD 11 12            	call	mk_rcs		; "IX, "
    3123/     F72 : CD 17 11            	call	get_nnnn
    3124/     F75 : CD 56 11            	call	mk_kn4k		; "(nnnnH)"
    3125/     F78 : C3 E8 11            	jp	insPostStr	; cr,lf
    3126/     F7B :                     
    3127/     F7B :                     chk_DD_CB
    3128/     F7B : FE CB               	cp	0CBH
    3129/     F7D : C2 F2 0D            	jp	nz, op_err
    3130/     F80 :                     
    3131/     F80 : CD 17 11            	call	get_nnnn	; d: 3rd OP, e:nn
    3132/     F83 : 7A                  	ld	a, d
    3133/     F84 :                     
    3134/     F84 : 01 07 00            	ld	bc, dd_rt_tble - dd_rt_tbles
    3135/     F87 : 21 8A 12            	ld	hl, dd_rt_tbles
    3136/     F8A : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    3137/     F8D : C2 9C 0F            	jp	nz, DD_CB_nn_XX
    3138/     F90 :                     
    3139/     F90 : 21 F3 14            	ld	hl, dd_rt_str
    3140/     F93 : CD 2E 11            	call	get_strBufpoint
    3141/     F96 : CD B6 11            	call	mkopcstr	; RLC, RRC, RL, RR, SLA, SRA, SRL
    3142/     F99 : C3 DC 0E            	jp	mk_kixpnk	; "(IX+nnH)",cr,lf
    3143/     F9C :                     
    3144/     F9C :                     ; check BIT, RES, SET
    3145/     F9C :                     DD_CB_nn_XX:
    3146/     F9C :                     
    3147/     F9C :                     	; check undefine MC
    3148/     F9C : 01 18 00            	ld	bc, dd_bit_opTble - dd_bit_opTbl
    3149/     F9F : 21 91 12            	ld	hl, dd_bit_opTbl
    3150/     FA2 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    3151/     FA5 : C2 F2 0D            	jp	nz, op_err
    3152/     FA8 :                     
    3153/     FA8 : FE 80               	cp	80h
    3154/     FAA : DA C1 0F            	jp	c, dd_bit
    3155/     FAD : FE C0               	cp	0c0h
    3156/     FAF : DA CA 0F            	jp	c, dd_res
    3157/     FB2 :                     
    3158/     FB2 :                     ; DD_SET
    3159/     FB2 :                     ; "SET i, (IX+nn)"
    3160/     FB2 :                     
    3161/     FB2 : 11 F6 13            	ld	de, SETstr
    3162/     FB5 : CD B6 11            	call	mkopcstr
    3163/     FB8 :                     
    3164/     FB8 :                     DD_BSR:
    3165/     FB8 :                     
    3166/     FB8 : 21 8F 9F            	ld	hl, dasm_OprStr ; set operand string buffer
    3167/     FBB : CD 0A 0E            	call	set_bitno	; "i, "
    3168/     FBE : C3 0C 0F            	jp	dd_mix4		; "(IX+nn)", cr,lf
    3169/     FC1 :                     
    3170/     FC1 :                     ; DD_BIT
    3171/     FC1 :                     ; "BIT i, (IX+nn)"
    3172/     FC1 :                     dd_bit:
    3173/     FC1 : 11 8B 13            	ld	de, BITstr
    3174/     FC4 : CD B6 11            	call	mkopcstr
    3175/     FC7 : C3 B8 0F            	jp	DD_BSR		;jr	DD_BSR
    3176/     FCA :                     
    3177/     FCA :                     ; DD_RES
    3178/     FCA :                     ; "RES i, (IX+nn)"
    3179/     FCA :                     dd_res:
    3180/     FCA : 11 8F 13            	ld	de, RESstr
    3181/     FCD : CD B6 11            	call	mkopcstr
    3182/     FD0 : C3 B8 0F            	jp	DD_BSR		;jr	DD_BSR
    3183/     FD3 :                     
    3184/     FD3 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    3185/     FD3 :                     	; OPECODE 0EDH check
    3186/     FD3 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    3187/     FD3 :                     
    3188/     FD3 :                     chk_0EDH:
    3189/     FD3 : FE ED               	cp	0edh
    3190/     FD5 : C2 D4 10            	jp	nz, chk_0FDH
    3191/     FD8 :                     
    3192/     FD8 : 7E                  	ld	a, (hl)		; get 2nd opcode
    3193/     FD9 :                     
    3194/     FD9 :                     	; check undefine MC
    3195/     FD9 : 01 38 00            	ld	bc, ed_op_tble - ed_op_tbl
    3196/     FDC : 21 A9 12            	ld	hl, ed_op_tbl
    3197/     FDF : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    3198/     FE2 : C2 F2 0D            	jp	nz, op_err
    3199/     FE5 :                     
    3200/     FE5 : 79                  	ld	a, c
    3201/     FE6 : FE 06               	cp	6
    3202/     FE8 : DA B5 10            	jp	c, ed_4mc
    3203/     FEB : FE 1B               	cp	27
    3204/     FED : DA A7 10            	jp	c, ed_no_opr
    3205/     FF0 : FE 1E               	cp	30
    3206/     FF2 : DA 94 10            	jp	c, ed_im
    3207/     FF5 : CA 73 10            	jp	z, ed_ld_ar
    3208/     FF8 : FE 1F               	cp	31
    3209/     FFA : CA 7C 10            	jp	z, ed_ld_ai
    3210/     FFD : FE 20               	cp	32
    3211/     FFF : CA 85 10            	jp	z, ed_ld_ra
    3212/    1002 : FE 21               	cp	33
    3213/    1004 : CA 8E 10            	jp	z, ed_ld_ia
    3214/    1007 : FE 26               	cp	38
    3215/    1009 : DA 61 10            	jp	c, ed_adc
    3216/    100C : FE 2A               	cp	42
    3217/    100E : DA 4A 10            	jp	c, ed_sbc
    3218/    1011 : FE 31               	cp	49
    3219/    1013 : DA 2F 10            	jp	c, ed_out
    3220/    1016 :                     
    3221/    1016 :                     ; c: 49 - 55 : IN r,(C) (r:B,C,D,E,H,L,A)
    3222/    1016 :                     
    3223/    1016 : 11 6E 13            	ld	de, INstr
    3224/    1019 : CD B6 11            	call	mkopcstr
    3225/    101C :                     
    3226/    101C : 79                  	ld	a, c
    3227/    101D : D6 31               	sub	49
    3228/    101F : 4F                  	ld	c, a
    3229/    1020 : 21 BB 14            	ld	hl, dd_ldtbl
    3230/    1023 : CD 2E 11            	call	get_strBufpoint	; get strung buffer
    3231/    1026 : CD 11 12            	call	mk_rcs		; "REG, "
    3232/    1029 : 11 FE 13            	ld	de, KCKstr
    3233/    102C : C3 E5 11            	jp	cpstr_crlf	; "(C)",cr,lf
    3234/    102F :                     
    3235/    102F :                     ; c: 42 - 48 : OUT (C),r(r:B,C,D,E,H,L,A)
    3236/    102F :                     ed_out:
    3237/    102F : 11 6A 13            	ld	de, OUTstr
    3238/    1032 : CD B6 11            	call	mkopcstr
    3239/    1035 :                     
    3240/    1035 : 11 FE 13            	ld	de, KCKstr
    3241/    1038 : CD 11 12            	call	mk_rcs		; "(C), "
    3242/    103B :                     
    3243/    103B : 79                  	ld	a, c
    3244/    103C : D6 2A               	sub	42
    3245/    103E : 4F                  	ld	c, a
    3246/    103F : E5                  	push	hl
    3247/    1040 : 21 BB 14            	ld	hl, dd_ldtbl
    3248/    1043 :                     
    3249/    1043 :                     ed_out1:
    3250/    1043 : CD 2E 11            	call	get_strBufpoint	; get strung buffer
    3251/    1046 : E1                  	pop	hl
    3252/    1047 : C3 E5 11            	jp	cpstr_crlf	; "REG",cr,lf
    3253/    104A :                     
    3254/    104A :                     ; c: 38 - 41 : SBC HL,rr(rr:BC,DE,HL,SP)
    3255/    104A :                     ed_sbc:
    3256/    104A : 11 14 13            	ld	de, SBCstr
    3257/    104D : CD B6 11            	call	mkopcstr
    3258/    1050 :                     
    3259/    1050 : 11 67 30            	ld	de, RNHL
    3260/    1053 : CD 11 12            	call	mk_rcs		; "HL, "
    3261/    1056 :                     
    3262/    1056 : 79                  	ld	a, c
    3263/    1057 : D6 26               	sub	38
    3264/    1059 :                     ed_sbc1:
    3265/    1059 : 4F                  	ld	c, a
    3266/    105A : E5                  	push	hl
    3267/    105B : 21 43 14            	ld	hl, INC_DEC_ADDrp
    3268/    105E : C3 43 10            	jp	ed_out1		;jr	ed_out1
    3269/    1061 :                     
    3270/    1061 :                     ; c: 34 - 37 : ADC HL,rr(rr:BC,DE,HL,SP)
    3271/    1061 :                     ed_adc:
    3272/    1061 : 11 0C 13            	ld	de, ADCstr
    3273/    1064 : CD B6 11            	call	mkopcstr
    3274/    1067 :                     
    3275/    1067 : 11 67 30            	ld	de, RNHL
    3276/    106A : CD 11 12            	call	mk_rcs		; "HL, "
    3277/    106D :                     
    3278/    106D : 79                  	ld	a, c
    3279/    106E : D6 22               	sub	34
    3280/    1070 : C3 59 10            	jp	ed_sbc1		;jr	ed_sbc1
    3281/    1073 :                     
    3282/    1073 :                     ; c: 30, 31 : LD A,R ; LD A,I
    3283/    1073 :                     ed_ld_ar:
    3284/    1073 : CD 0E 12            	call	a_colon_sp	; "A, "
    3285/    1076 : 11 A2 30            	ld	de, RNR
    3286/    1079 : C3 E5 11            	jp	cpstr_crlf	; "R",cr,lf
    3287/    107C :                     	
    3288/    107C :                     ed_ld_ai:
    3289/    107C : CD 0E 12            	call	a_colon_sp	; "A, "
    3290/    107F : 11 A0 30            	ld	de, RNI
    3291/    1082 : C3 E5 11            	jp	cpstr_crlf	; "I",cr,lf
    3292/    1085 :                     	
    3293/    1085 :                     ; c: 32, 33 : LD R,A ; LD I,A
    3294/    1085 :                     ed_ld_ra:
    3295/    1085 : 11 A2 30            	ld	de, RNR
    3296/    1088 :                     ed_ld_ra1:
    3297/    1088 : CD 11 12            	call	mk_rcs		; "R, "
    3298/    108B : C3 D4 11            	jp	a_crlf		; "A",cr,lf
    3299/    108E :                     
    3300/    108E :                     ed_ld_ia:
    3301/    108E : 11 A0 30            	ld	de, RNI
    3302/    1091 : C3 88 10            	jp	ed_ld_ra1	;jr	ed_ld_ra1
    3303/    1094 :                     	
    3304/    1094 :                     ; c: 27, 28, 29 : IM 2, IM 1, IM 0
    3305/    1094 :                     ed_im:
    3306/    1094 : 11 97 13            	ld	de, IMstr
    3307/    1097 : CD B6 11            	call	mkopcstr
    3308/    109A :                     
    3309/    109A : 3E 1D               	ld	a, 29
    3310/    109C : 91                  	sub	c
    3311/    109D : C6 30               	add	a, '0'		; '0', '1', '2'
    3312/    109F : 21 8F 9F            	ld	hl, dasm_OprStr
    3313/    10A2 : 77                  	ld	(hl), a
    3314/    10A3 : 23                  	inc	hl
    3315/    10A4 : C3 E8 11            	jp	insPostStr
    3316/    10A7 :                     
    3317/    10A7 :                     ; c: 6 - 26 ed_noopr
    3318/    10A7 :                     ed_no_opr:
    3319/    10A7 : D6 06               	sub	6
    3320/    10A9 : 4F                  	ld	c, a
    3321/    10AA : 06 00               	ld	b, 0
    3322/    10AC : 21 C9 14            	ld	hl, ed_noopr
    3323/    10AF : CD 2E 11            	call	get_strBufpoint		; de : string buffer
    3324/    10B2 : C3 B6 11            	jp	mkopcstr
    3325/    10B5 :                     ;
    3326/    10B5 :                     ; check ED 4 byte MC
    3327/    10B5 :                     ;
    3328/    10B5 :                     ed_4mc:
    3329/    10B5 : 3E 04               	ld	a, 4
    3330/    10B7 : 32 73 9F            	ld	(mc_Size), a	; 4byte machine code
    3331/    10BA :                     
    3332/    10BA : C5                  	push	bc
    3333/    10BB : 79                  	ld	a, c
    3334/    10BC : 21 89 14            	ld	hl, ed_rp_str
    3335/    10BF : CD 2E 11            	call	get_strBufpoint		; de : string buffer
    3336/    10C2 : C1                  	pop	bc
    3337/    10C3 : 79                  	ld	a, c
    3338/    10C4 : FE 03               	cp	3
    3339/    10C6 : DA 6F 0F            	jp	c, DD_2a1		; "rr, (nnnnH)",cr,lf
    3340/    10C9 :                     					; rr: BC, DE, SP
    3341/    10C9 :                     ; "(nnnnH), rr" rr: BC, DE, SP
    3342/    10C9 :                     
    3343/    10C9 : D5                  	push	de
    3344/    10CA : CD 17 11            	call	get_nnnn
    3345/    10CD : CD 47 11            	call	ins_kn4kcs	; "(nnnnH), "
    3346/    10D0 : D1                  	pop	de
    3347/    10D1 : C3 E5 11            	jp	cpstr_crlf	; "REG",cr,lf
    3348/    10D4 :                     
    3349/    10D4 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    3350/    10D4 :                     	; OPECODE 0FDH check
    3351/    10D4 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    3352/    10D4 :                     
    3353/    10D4 :                     chk_0FDH:
    3354/    10D4 :                     
    3355/    10D4 : 11 97 30            	ld	de, RNIY
    3356/    10D7 : EB                  	EX	HL,DE			;Z80 CODE ld	(reg_xy), de	; save index reg string
    3357/    10D8 : 22 6F 9F            	LD	(reg_xy),HL		;###############################
    3358/    10DB : EB                  	EX	HL,DE			;###############################
    3359/    10DC : 11 A5 14            	ld	de, addiyrp_tbl
    3360/    10DF : EB                  	EX	HL,DE			;Z80 CODE ld	(xy_srtp), de
    3361/    10E0 : 22 71 9F            	LD	(xy_srtp),HL		;###############################
    3362/    10E3 : EB                  	EX	HL,DE			;###############################
    3363/    10E4 :                     
    3364/    10E4 : C3 2D 0E            	jp	chk_0DDH_1
    3365/    10E7 :                     
    3366/    10E7 :                     ;-----------------------------------
    3367/    10E7 :                     ; make "(REG+nn), " at dasm_OprStr
    3368/    10E7 :                     ;	REG : IX or IY
    3369/    10E7 :                     ; input de: RNIX, or RNIY
    3370/    10E7 :                     ;-----------------------------------
    3371/    10E7 :                     kixypnk_cs:
    3372/    10E7 : 21 8F 9F            	ld	hl, dasm_OprStr
    3373/    10EA : CD F6 10            	call	mk_kixypnk
    3374/    10ED : C3 3C 12            	jp	ins_kmR
    3375/    10F0 :                     
    3376/    10F0 :                     ;-----------------------------------
    3377/    10F0 :                     ; make "(REG+nn)",cr,lf 
    3378/    10F0 :                     ;	REG : IX or IY
    3379/    10F0 :                     ; input de: RNIX, or RNIY
    3380/    10F0 :                     ;       hl: string buffer
    3381/    10F0 :                     ;-----------------------------------
    3382/    10F0 :                     kixypnk_crlf:
    3383/    10F0 : CD F6 10            	call	mk_kixypnk
    3384/    10F3 : C3 E8 11            	jp	insPostStr	; CR, LF, 00h
    3385/    10F6 :                     
    3386/    10F6 :                     ;-----------------------------------
    3387/    10F6 :                     ; make "(IX+nn)", "(IY+nn)" string
    3388/    10F6 :                     ; input de: RNIX, or RNIY
    3389/    10F6 :                     ;       hl: string buffer
    3390/    10F6 :                     ;-----------------------------------
    3391/    10F6 :                     mk_kixypnk:
    3392/    10F6 : CD 23 12            	call	ins_kakkoL	; "("
    3393/    10F9 : CD 1A 12            	call	st_copy	; IX
    3394/    10FC : CD 17 11            	call	get_nnnn
    3395/    10FF : 7B                  	ld	a, e		;get number
    3396/    1100 : FE 80               	cp	80h
    3397/    1102 : DA 11 11            	jp	c, numPlus	;jr	c, numPlus	; number plus
    3398/    1105 : 2F                  	CPL				;z80 CODE neg ########	; a = not a + 1
    3399/    1106 : 3C                  	INC	A			;flags may be wrong, it's OK here
    3400/    1107 : 5F                  	ld	e, a
    3401/    1108 : CD 37 12            	call	ins_misR	; -
    3402/    110B :                     sv_nnkr:
    3403/    110B : CD 80 11            	call	hex2str_asm	; nnh
    3404/    110E : C3 28 12            	jp	ins_kakkoR	; ")"
    3405/    1111 :                     	
    3406/    1111 :                     numPlus:
    3407/    1111 : CD 32 12            	call	ins_plsR	; +
    3408/    1114 : C3 0B 11            	jp	sv_nnkr		;jr	sv_nnkr
    3409/    1117 :                     
    3410/    1117 :                     ; de : nnnn , or d:yy, e:xx
    3411/    1117 :                     get_nnnn:
    3412/    1117 : E5                  	push	hl
    3413/    1118 : 2A 6D 9F            	ld	hl, (dasm_adr)
    3414/    111B : 23                  	inc	hl		; 2nd opecode address
    3415/    111C : 23                  	inc	hl		; operand address
    3416/    111D : 5E                  	ld	e, (hl)		; get nn
    3417/    111E : 23                  	inc	hl
    3418/    111F : 56                  	ld	d, (hl)		; d:yy use for "LD (IX+xx), yy"
    3419/    1120 :                     				; d:OP use for 4bytes MC like "DD CB xx OP"
    3420/    1120 :                     				; de : YYXX : ED OP XX YY
    3421/    1120 : E1                  	pop	hl
    3422/    1121 : C9                  	ret
    3423/    1122 :                     
    3424/    1122 :                     ;-------------------------------------------------
    3425/    1122 :                     ; hl: massage table
    3426/    1122 :                     ; bc: found operand point
    3427/    1122 :                     ;
    3428/    1122 :                     ; output: copy strings to dasm_OprStr buffer
    3429/    1122 :                     ;         hl = end point of copied string buffer
    3430/    1122 :                     ;-------------------------------------------------
    3431/    1122 :                     mk_str:
    3432/    1122 : CD 2E 11            	call	get_strBufpoint
    3433/    1125 : 21 8F 9F            	ld	hl, dasm_OprStr
    3434/    1128 : C3 1A 12            	jp	st_copy
    3435/    112B :                     
    3436/    112B :                     ;------------------------------------------------
    3437/    112B :                     ; get register strings address
    3438/    112B :                     ; input bc: string buffer offset
    3439/    112B :                     ; output de: register strings address
    3440/    112B :                     ;------------------------------------------------
    3441/    112B :                     get_rstg_off:
    3442/    112B : 21 1B 14            	ld	hl, disRegTbl
    3443/    112E :                     
    3444/    112E :                     ;-------------------------------------------------
    3445/    112E :                     ; input
    3446/    112E :                     ;	bc: found operand point
    3447/    112E :                     ;	hl: massage table
    3448/    112E :                     ; output: 
    3449/    112E :                     ;	DE : string point
    3450/    112E :                     ;-------------------------------------------------
    3451/    112E :                     get_strBufpoint:
    3452/    112E : 57                  	LD	D,A			;Z80 CODE sla	c ##############
    3453/    112F : 79                  	LD	A,C			;###############################
    3454/    1130 : 81                  	ADD	A,C			;###############################
    3455/    1131 : 4F                  	LD	C,A			;###############################
    3456/    1132 : 78                  	LD	A,B			;Z80 CODE rl	b		; bc *=2
    3457/    1133 : 88                  	ADC	A,B			;###############################
    3458/    1134 : 47                  	LD	B,A			;###############################
    3459/    1135 : 7A                  	LD	A,D			;## D destroyed it's ok here ###
    3460/    1136 : 09                  	add	hl, bc		; get operand string point
    3461/    1137 : 5E                  	ld	e, (hl)
    3462/    1138 : 23                  	inc	hl
    3463/    1139 : 56                  	ld	d, (hl)
    3464/    113A : C9                  	ret
    3465/    113B :                     
    3466/    113B :                     ;------------------------------------------------
    3467/    113B :                     ; insert "nnH", CR, LF to buffer
    3468/    113B :                     ;input e: value
    3469/    113B :                     ;      hl: string buffer
    3470/    113B :                     ;------------------------------------------------
    3471/    113B :                     mk_n2crlf:
    3472/    113B : CD 80 11            	call	hex2str_asm
    3473/    113E : C3 E8 11            	jp	insPostStr
    3474/    1141 :                     
    3475/    1141 :                     ;------------------------------------------------
    3476/    1141 :                     ; insert "nnnnH", CR, LF to buffer
    3477/    1141 :                     ;input de: value
    3478/    1141 :                     ;      hl: string buffer
    3479/    1141 :                     ;------------------------------------------------
    3480/    1141 :                     mk_n4crlf:
    3481/    1141 : CD 6E 11            	call	hex4str_asm
    3482/    1144 : C3 E8 11            	jp	insPostStr
    3483/    1147 :                     
    3484/    1147 :                     ;------------------------------------------------
    3485/    1147 :                     ; insert "(nnnnH), " to buffer dasm_OprStr
    3486/    1147 :                     ;input de: value
    3487/    1147 :                     ;
    3488/    1147 :                     ; make "(nnnnH), " to dasm_OprStr buffer
    3489/    1147 :                     ; output hl: end point of string buffer
    3490/    1147 :                     ;------------------------------------------------
    3491/    1147 :                     ins_kn4kcs:
    3492/    1147 : 21 8F 9F            	ld	hl, dasm_OprStr	;operand str buffer
    3493/    114A : CD 23 12            	call	ins_kakkoL	; "("
    3494/    114D : CD 6E 11            	call	hex4str_asm
    3495/    1150 : CD 28 12            	call	ins_kakkoR	; ")"
    3496/    1153 : C3 3C 12            	jp	ins_kmR		; ", "
    3497/    1156 :                     
    3498/    1156 :                     ;------------------------------------------------
    3499/    1156 :                     ; insert "(nnnnH)" to buffer
    3500/    1156 :                     ;input de: value
    3501/    1156 :                     ;      hl: string buffer
    3502/    1156 :                     ;------------------------------------------------
    3503/    1156 :                     mk_kn4k:
    3504/    1156 : CD 23 12            	call	ins_kakkoL	; "("
    3505/    1159 : CD 6E 11            	call	hex4str_asm
    3506/    115C : C3 28 12            	jp	ins_kakkoR	; ")"
    3507/    115F :                     
    3508/    115F :                     ;------------------------------------------------
    3509/    115F :                     ; Make address string from branch relative value
    3510/    115F :                     ; input hl: string buffer pointer
    3511/    115F :                     ; output *hl= "nnnnH",cr,lf,0
    3512/    115F :                     ;------------------------------------------------
    3513/    115F :                     mkRel_str:
    3514/    115F : E5                  	push	hl
    3515/    1160 : 2A 6D 9F            	ld	hl, (dasm_adr)
    3516/    1163 : CD FE 05            	call	Rel_adr_c	; return hl : target addr
    3517/    1166 : EB                  	ex	de, hl		; hl: buffer, de: addr value
    3518/    1167 : E1                  	pop	hl
    3519/    1168 : CD 6E 11            	call	hex4str_asm
    3520/    116B : C3 E8 11            	jp	insPostStr	;jr	insPostStr
    3521/    116E :                     
    3522/    116E :                     ;------------------------------------------------
    3523/    116E :                     ;input de: value, hl: save baffer.
    3524/    116E :                     ;output 4hex chars(asm format)
    3525/    116E :                     ;	(ex). "0FFFFH"
    3526/    116E :                     ;             "1234H"
    3527/    116E :                     ;       hl : hl = hl + 5(or 6); *hl=0
    3528/    116E :                     ;------------------------------------------------
    3529/    116E :                     hex4str_asm:
    3530/    116E : 7A                  	ld	a, d
    3531/    116F : FE A0               	cp	0a0h
    3532/    1171 : DA 78 11            	jp	c, h4sa_1	;jr	c, h4sa_1
    3533/    1174 : 3E 30               	ld	a, '0'
    3534/    1176 : 77                  	ld	(hl), a
    3535/    1177 : 23                  	inc	hl
    3536/    1178 :                     
    3537/    1178 :                     h4sa_1:
    3538/    1178 : CD 90 11            	call	hex4str
    3539/    117B :                     h4sa_2:
    3540/    117B : 3E 48               	ld	a, 'H'
    3541/    117D : C3 2A 12            	jp	ikk_1
    3542/    1180 :                     
    3543/    1180 :                     ;------------------------------------------------
    3544/    1180 :                     ;input e: value, hl: save baffer.
    3545/    1180 :                     ;output: 2 hex chars(asm format)
    3546/    1180 :                     ;	(ex). "0FFH"
    3547/    1180 :                     ;             "12H"
    3548/    1180 :                     ;       hl : hl = hl + 3(or 4); *hl=0
    3549/    1180 :                     ;------------------------------------------------
    3550/    1180 :                     hex2str_asm:
    3551/    1180 : 7B                  	ld	a, e
    3552/    1181 : FE A0               	cp	0a0h
    3553/    1183 : DA 8A 11            	jp	c, h2sa_1	;jr	c, h2sa_1
    3554/    1186 : 3E 30               	ld	a, '0'
    3555/    1188 : 77                  	ld	(hl), a
    3556/    1189 : 23                  	inc	hl
    3557/    118A :                     
    3558/    118A :                     h2sa_1:
    3559/    118A : CD 98 11            	call	hex2str
    3560/    118D : C3 7B 11            	jp	h4sa_2		;jr	h4sa_2
    3561/    1190 :                     
    3562/    1190 :                     ;------------------------------------------------
    3563/    1190 :                     ;input de: value, hl: save baffer.
    3564/    1190 :                     ;output: 4 hex chras in save buffer
    3565/    1190 :                     ;	 hl = hl + 4
    3566/    1190 :                     ;------------------------------------------------
    3567/    1190 :                     hex4str:
    3568/    1190 : 7A                  	ld	a, d
    3569/    1191 : CD A1 11            	call	h2s_n1
    3570/    1194 : 7A                  	ld	a, d
    3571/    1195 : CD A5 11            	call	h2s_n2
    3572/    1198 :                     
    3573/    1198 :                     ;------------------------------------------------
    3574/    1198 :                     ;input e: value, hl: save baffer.
    3575/    1198 :                     ;output: 2 hex chras in save buffer
    3576/    1198 :                     ;	 hl = hl + 2
    3577/    1198 :                     ;------------------------------------------------
    3578/    1198 :                     hex2str:
    3579/    1198 : 7B                  	ld	a, e
    3580/    1199 : CD A1 11            	call	h2s_n1
    3581/    119C : 7B                  	ld	a, e
    3582/    119D : CD A5 11            	call	h2s_n2
    3583/    11A0 : C9                  	ret
    3584/    11A1 :                     
    3585/    11A1 :                     h2s_n1:
    3586/    11A1 : 0F                  	rrca
    3587/    11A2 : 0F                  	rrca
    3588/    11A3 : 0F                  	rrca
    3589/    11A4 : 0F                  	rrca
    3590/    11A5 :                     h2s_n2:
    3591/    11A5 : E6 0F               	and	0fh
    3592/    11A7 : F6 30               	or	30h
    3593/    11A9 : FE 3A               	cp	3aH
    3594/    11AB : DA 2A 12            	jp	c, ikk_1	;jr	c, ikk_1	; '0' to '9'
    3595/    11AE : C6 07               	add	a, 07h		; 'A' to 'F'
    3596/    11B0 : C3 2A 12            	jp	ikk_1		;jr	ikk_1
    3597/    11B3 :                     
    3598/    11B3 :                     add_opstr:
    3599/    11B3 : 11 08 13            	ld	de, ADDstr
    3600/    11B6 :                     ;-----------------------------------
    3601/    11B6 :                     ; make opecode strings
    3602/    11B6 :                     ; input de : opecode strings
    3603/    11B6 :                     ;-----------------------------------
    3604/    11B6 :                     mkopcstr:
    3605/    11B6 : F5                  	push	af
    3606/    11B7 : C5                  	push	bc
    3607/    11B8 : 06 08               	ld	b, 8	;tab size
    3608/    11BA : 21 87 9F            	ld	hl, dasm_OpcStr
    3609/    11BD :                     dmkstr0:
    3610/    11BD : 1A                  	ld	a, (de)
    3611/    11BE : B7                  	or	a
    3612/    11BF : CA C9 11            	jp	z, dmkst1	;jr	z, dmkst1
    3613/    11C2 : 77                  	ld	(hl), a
    3614/    11C3 : 23                  	inc	hl
    3615/    11C4 : 13                  	inc	de
    3616/    11C5 : 05                  	dec	b
    3617/    11C6 : C3 BD 11            	jp	dmkstr0		;jr	dmkstr0
    3618/    11C9 :                     dmkst1:
    3619/    11C9 : 3E 20               	ld	a, ' '
    3620/    11CB :                     dmkst2:
    3621/    11CB : 77                  	ld	(hl), a
    3622/    11CC : 23                  	inc	hl
    3623/    11CD : 05                  	dec	b
    3624/    11CE : C2 CB 11            	jp	nz, dmkst2	;jr	nz, dmkst2
    3625/    11D1 : C1                  	pop	bc
    3626/    11D2 : F1                  	pop	af
    3627/    11D3 : C9                  	ret
    3628/    11D4 :                     
    3629/    11D4 :                     ;
    3630/    11D4 :                     ; "REG",CR,LF
    3631/    11D4 :                     ;
    3632/    11D4 :                     a_crlf:
    3633/    11D4 : 11 57 30            	ld	de, RNA
    3634/    11D7 : C3 E5 11            	jp	cpstr_crlf	;jr	cpstr_crlf	; "A",CR,LF
    3635/    11DA :                     ;bc_crlf:
    3636/    11DA :                     ;	ld	de, RNBC
    3637/    11DA :                     ;	jp	cpstr_crlf	;jr	cpstr_crlf
    3638/    11DA :                     ;de_crlf:
    3639/    11DA :                     ;	ld	de, RNDE
    3640/    11DA :                     ;	jp	cpstr_crlf	;jr	cpstr_crlf
    3641/    11DA :                     ix_crlf:
    3642/    11DA : EB                  	EX	HL,DE			;Z80 CODE ld	de, (reg_xy)
    3643/    11DB : 2A 6F 9F            	LD	HL,(reg_xy)		;##############################
    3644/    11DE : EB                  	EX	HL,DE			;##############################
    3645/    11DF : C3 E5 11            	jp	cpstr_crlf	;jr	cpstr_crlf
    3646/    11E2 :                     ;sp_crlf:
    3647/    11E2 :                     ;	ld	de, RNSP
    3648/    11E2 :                     ;	jp	cpstr_crlf	;jr	cpstr_crlf
    3649/    11E2 :                     hl_crlf:
    3650/    11E2 : 11 67 30            	ld	de, RNHL
    3651/    11E5 :                     cpstr_crlf:
    3652/    11E5 : CD 1A 12            	call	st_copy		; "REG"
    3653/    11E8 :                     	
    3654/    11E8 :                     ;-----------------------------------
    3655/    11E8 :                     ; insert CR, LF, 00H(end delimiter)
    3656/    11E8 :                     ; input hl : insert buffer
    3657/    11E8 :                     ;-----------------------------------
    3658/    11E8 :                     insPostStr:
    3659/    11E8 : 3E 0D               	ld	a, CR
    3660/    11EA : 77                  	ld	(hl), a		; CR code
    3661/    11EB : 23                  	inc	hl
    3662/    11EC : 3E 0A               	ld	a, LF
    3663/    11EE : 77                  	ld	(hl), a		; LF code
    3664/    11EF : 23                  	inc	hl
    3665/    11F0 : AF                  	xor	a
    3666/    11F1 : 77                  	ld	(hl), a		; end delimiter
    3667/    11F2 : C9                  	ret
    3668/    11F3 :                     
    3669/    11F3 :                     mk_krk_1:
    3670/    11F3 : 21 8F 9F            	ld	hl, dasm_OprStr
    3671/    11F6 :                     ;----------------------------
    3672/    11F6 :                     ; insert "(Reg)" to buffer
    3673/    11F6 :                     ;
    3674/    11F6 :                     ; input de: register string
    3675/    11F6 :                     ;	hl: save buffer
    3676/    11F6 :                     ;----------------------------
    3677/    11F6 :                     mk_krk:
    3678/    11F6 : CD 23 12            	call	ins_kakkoL	; "("
    3679/    11F9 : CD 1A 12            	call	st_copy		; "REG"
    3680/    11FC : C3 28 12            	jp	ins_kakkoR	;jr	ins_kakkoR	; ")"
    3681/    11FF :                     
    3682/    11FF :                     ;----------------------------
    3683/    11FF :                     ; insert "(Reg), " to dasm_OprStr
    3684/    11FF :                     ;
    3685/    11FF :                     ; input de: register string
    3686/    11FF :                     ;----------------------------
    3687/    11FF :                     mk_krkcs:
    3688/    11FF : 21 8F 9F            	ld	hl, dasm_OprStr
    3689/    1202 : CD 23 12            	call	ins_kakkoL	; "("
    3690/    1205 : CD 1A 12            	call	st_copy		; "REG"
    3691/    1208 : CD 28 12            	call	ins_kakkoR	; ")"
    3692/    120B : C3 3C 12            	jp	ins_kmR		;jr	ins_kmR; ", "
    3693/    120E :                     
    3694/    120E :                     ;----------------------------
    3695/    120E :                     ; insert "A, " to dasm_OprStr
    3696/    120E :                     ;----------------------------
    3697/    120E :                     a_colon_sp:
    3698/    120E : 11 57 30            	ld	de, RNA
    3699/    1211 :                     ;----------------------------
    3700/    1211 :                     ; insert "Reg, " to dasm_OprStr
    3701/    1211 :                     ;
    3702/    1211 :                     ; input de: register string
    3703/    1211 :                     ;----------------------------
    3704/    1211 :                     mk_rcs:
    3705/    1211 : 21 8F 9F            	ld	hl, dasm_OprStr
    3706/    1214 : CD 1A 12            	call	st_copy		; "REG"
    3707/    1217 : C3 3C 12            	jp	ins_kmR		;jr	ins_kmR	; ", "
    3708/    121A :                     
    3709/    121A :                     ;-------------------------------------------------
    3710/    121A :                     ; copy string to output buffer
    3711/    121A :                     ; input:
    3712/    121A :                     ;	de : string point
    3713/    121A :                     ;	hl : output buffer
    3714/    121A :                     ;-------------------------------------------------
    3715/    121A :                     st_copy:
    3716/    121A : 1A                  	ld	a, (de)
    3717/    121B : 77                  	ld	(hl), a
    3718/    121C : B7                  	or	a
    3719/    121D : C8                  	ret	z	; return after coping delimiter
    3720/    121E :                     			; hl : delimiter position
    3721/    121E : 23                  	inc	hl
    3722/    121F : 13                  	inc	de
    3723/    1220 : C3 1A 12            	jp	st_copy		;jr	st_copy
    3724/    1223 :                     
    3725/    1223 :                     ;--------------
    3726/    1223 :                     ; insert "("
    3727/    1223 :                     ;--------------
    3728/    1223 :                     ins_kakkoL:
    3729/    1223 : 3E 28               	ld	a, '('
    3730/    1225 : C3 2A 12            	jp	ikk_1		;jr	ikk_1
    3731/    1228 :                     	
    3732/    1228 :                     ;--------------
    3733/    1228 :                     ; insert ")"
    3734/    1228 :                     ;--------------
    3735/    1228 :                     ins_kakkoR:
    3736/    1228 : 3E 29               	ld	a, ')'
    3737/    122A :                     ikk_1:
    3738/    122A : 77                  	ld	(hl), a
    3739/    122B : 23                  	inc	hl
    3740/    122C : C9                  	ret
    3741/    122D :                     
    3742/    122D :                     ;--------------
    3743/    122D :                     ; insert " "
    3744/    122D :                     ;--------------
    3745/    122D :                     ins_spcR:
    3746/    122D : 3E 20               	ld	a, ' '
    3747/    122F : C3 2A 12            	jp	ikk_1		;jr	ikk_1
    3748/    1232 :                     
    3749/    1232 :                     ;--------------
    3750/    1232 :                     ; insert "+"
    3751/    1232 :                     ;--------------
    3752/    1232 :                     ins_plsR:
    3753/    1232 : 3E 2B               	ld	a, '+'
    3754/    1234 : C3 2A 12            	jp	ikk_1		;jr	ikk_1
    3755/    1237 :                     
    3756/    1237 :                     ;--------------
    3757/    1237 :                     ; insert "-"
    3758/    1237 :                     ;--------------
    3759/    1237 :                     ins_misR:
    3760/    1237 : 3E 2D               	ld	a, '-'
    3761/    1239 : C3 2A 12            	jp	ikk_1		;jr	ikk_1
    3762/    123C :                     
    3763/    123C :                     ;--------------
    3764/    123C :                     ; insert ", "
    3765/    123C :                     ;--------------
    3766/    123C :                     ins_kmR:
    3767/    123C : 3E 2C               	ld	a, ','
    3768/    123E : CD 2A 12            	call	ikk_1
    3769/    1241 : C3 2D 12            	jp	ins_spcR	;jr	ins_spcR
    3770/    1244 :                     
    3771/    1244 :                     ;------------------------------------------
    3772/    1244 :                     ; Dis assemble tables
    3773/    1244 :                     ;------------------------------------------
    3774/    1244 :                     oth_1op_s:
    3775/    1244 : 00                  	DB	00H	; NOP
    3776/    1245 : 07                  	DB	07H	; RLCA
    3777/    1246 : 0F                  	DB	0FH	; RRCA
    3778/    1247 : 17                  	DB	17H	; RLA
    3779/    1248 : 1F                  	DB	1FH	; RRA
    3780/    1249 : 27                  	DB	27H	; DAA
    3781/    124A : 2F                  	DB	2FH	; CPL
    3782/    124B : 37                  	DB	37H	; SCF
    3783/    124C : 3F                  	DB	3FH	; CCF
    3784/    124D : C9                  	DB	0C9H	; RET
    3785/    124E : D9                  	DB	0D9H	; EXX
    3786/    124F : F3                  	DB	0F3H	; DI
    3787/    1250 : FB                  	DB	0FBH	; EI
    3788/    1251 :                     oth_1op_e:
    3789/    1251 :                     
    3790/    1251 :                     INC_OPCDTBLS:
    3791/    1251 : 04                  	DB	04H	; INC	B
    3792/    1252 : 0C                  	DB	0CH	; INC	C
    3793/    1253 : 14                  	DB	14H	; INC	D
    3794/    1254 : 1C                  	DB	1CH	; INC	E
    3795/    1255 : 24                  	DB	24H	; INC	H
    3796/    1256 : 2C                  	DB	2CH	; INC	L
    3797/    1257 : 34                  	DB	34H	; INC	(HL)
    3798/    1258 : 3C                  	DB	3CH	; INC	A
    3799/    1259 :                     INC_OPCDTBLE:
    3800/    1259 :                     
    3801/    1259 :                     DEC_OPCDTBLS:
    3802/    1259 : 05                  	DB	05H	; DEC	B
    3803/    125A : 0D                  	DB	0DH	; DEC	C
    3804/    125B : 15                  	DB	15H	; DEC	D
    3805/    125C : 1D                  	DB	1DH	; DEC	E
    3806/    125D : 25                  	DB	25H	; DEC	H
    3807/    125E : 2D                  	DB	2DH	; DEC	L
    3808/    125F : 35                  	DB	35H	; DEC	(HL)
    3809/    1260 : 3D                  	DB	3DH	; DEC	A
    3810/    1261 :                     DEC_OPCDTBLE:
    3811/    1261 :                     
    3812/    1261 :                     inc_rp_s:
    3813/    1261 : 03                  	DB	03H	; INC	BC
    3814/    1262 : 13                  	DB	13H	; INC	DE
    3815/    1263 : 23                  	DB	23H	; INC	HL
    3816/    1264 : 33                  	DB	33H	; INC	SP
    3817/    1265 :                     inc_rp_e:
    3818/    1265 :                     
    3819/    1265 :                     dec_rp_s:
    3820/    1265 : 0B                  	DB	0BH	; DEC	BC
    3821/    1266 : 1B                  	DB	1BH	; DEC	DE
    3822/    1267 : 2B                  	DB	2BH	; DEC	HL
    3823/    1268 : 3B                  	DB	3BH	; DEC	SP
    3824/    1269 :                     dec_rp_e:
    3825/    1269 :                     
    3826/    1269 :                     add_rp_s:
    3827/    1269 : 09                  	DB	09H	; ADD	HL,BC
    3828/    126A : 19                  	DB	19H	; ADD	HL,DE
    3829/    126B : 29                  	DB	29H	; ADD	HL,HL
    3830/    126C : 39                  	DB	39H	; ADD	HL,SP
    3831/    126D :                     add_rp_e:
    3832/    126D :                     
    3833/    126D :                     pop_rp_s:
    3834/    126D : C1                  	DB	0C1H	; POP	BC
    3835/    126E : D1                  	DB	0D1H	; POP	DE
    3836/    126F : E1                  	DB	0E1H	; POP	HL
    3837/    1270 : F1                  	DB	0F1H	; POP	AF
    3838/    1271 :                     pop_rp_e:
    3839/    1271 :                     
    3840/    1271 :                     push_rp_s:
    3841/    1271 : C5                  	DB	0C5H	; PUSH	BC
    3842/    1272 : D5                  	DB	0D5H	; PUSH	DE
    3843/    1273 : E5                  	DB	0E5H	; PUSH	HL
    3844/    1274 : F5                  	DB	0F5H	; PUSH	AF
    3845/    1275 :                     push_rp_e:
    3846/    1275 :                     
    3847/    1275 :                     dd_ld_tbl:
    3848/    1275 : 46                  	DB	46h	; nn: LD B,(IX+nn)
    3849/    1276 : 4E                  	DB	4Eh	; nn: LD C,(IX+nn)
    3850/    1277 : 56                  	DB	56h	; nn: LD D,(IX+nn)
    3851/    1278 : 5E                  	DB	5Eh	; nn: LD E,(IX+nn)
    3852/    1279 : 66                  	DB	66h	; nn: LD H,(IX+nn)
    3853/    127A : 6E                  	DB	6Eh	; nn: LD L,(IX+nn)
    3854/    127B : 7E                  	DB	7Eh	; nn: LD A,(IX+nn)
    3855/    127C :                     
    3856/    127C : 70                  	DB	70h	; nn: LD (IX+nn),B
    3857/    127D : 71                  	DB	71h	; nn: LD (IX+nn),C
    3858/    127E : 72                  	DB	72h	; nn: LD (IX+nn),D
    3859/    127F : 73                  	DB	73h	; nn: LD (IX+nn),E
    3860/    1280 : 74                  	DB	74h	; nn: LD (IX+nn),H
    3861/    1281 : 75                  	DB	75h	; nn: LD (IX+nn),L
    3862/    1282 : 77                  	DB	77h	; nn: LD (IX+nn),A
    3863/    1283 :                     dd_ld_tble:
    3864/    1283 :                     
    3865/    1283 :                     dd_log_tbl:
    3866/    1283 : 96                  	DB	96h	; nn: SUB (IX+nn)
    3867/    1284 : A6                  	DB	0A6h	; nn: AND (IX+nn)
    3868/    1285 : AE                  	DB	0AEh	; nn: XOR (IX+nn)
    3869/    1286 : B6                  	DB	0B6h	; nn: OR  (IX+nn)
    3870/    1287 : BE                  	DB	0BEh	; nn: CP  (IX+nn)
    3871/    1288 : 34                  	DB	34h	; nn: INC (IX+nn)
    3872/    1289 : 35                  	DB	35h	; nn: DEC (IX+nn)
    3873/    128A :                     dd_log_tble:
    3874/    128A :                     
    3875/    128A :                     dd_rt_tbles:
    3876/    128A : 06                  	DB	06h	; RLC (IX+nn)
    3877/    128B : 0E                  	DB	0Eh	; RRC (IX+nn)
    3878/    128C : 16                  	DB	16h	; RL  (IX+nn)
    3879/    128D : 1E                  	DB	1Eh	; RR  (IX+nn)
    3880/    128E : 26                  	DB	26h	; SLA (IX+nn)
    3881/    128F : 2E                  	DB	2Eh	; SRA (IX+nn)
    3882/    1290 : 3E                  	DB	3Eh	; SRL (IX+nn)
    3883/    1291 :                     dd_rt_tble:
    3884/    1291 :                     
    3885/    1291 :                     ; use checking undefine MC ( DD CB nn XX )
    3886/    1291 :                     dd_bit_opTbl:
    3887/    1291 : 46                  	DB	46h	; BIT 0,(IX+12H)
    3888/    1292 : 4E                  	DB	4Eh	; BIT 1,(IX+12H)
    3889/    1293 : 56                  	DB	56h	; BIT 2,(IX+12H)
    3890/    1294 : 5E                  	DB	5Eh	; BIT 3,(IX+12H)
    3891/    1295 : 66                  	DB	66h	; BIT 4,(IX+12H)
    3892/    1296 : 6E                  	DB	6Eh	; BIT 5,(IX+12H)
    3893/    1297 : 76                  	DB	76h	; BIT 6,(IX+12H)
    3894/    1298 : 7E                  	DB	7Eh	; BIT 7,(IX+12H)
    3895/    1299 : 86                  	DB	86h	; RES 0,(IX+12H)
    3896/    129A : 8E                  	DB	8Eh	; RES 1,(IX+12H)
    3897/    129B : 96                  	DB	96h	; RES 2,(IX+12H)
    3898/    129C : 9E                  	DB	9Eh	; RES 3,(IX+12H)
    3899/    129D : A6                  	DB	0A6h	; RES 4,(IX+12H)
    3900/    129E : AE                  	DB	0AEh	; RES 5,(IX+12H)
    3901/    129F : B6                  	DB	0B6h	; RES 6,(IX+12H)
    3902/    12A0 : BE                  	DB	0BEh	; RES 7,(IX+12H)
    3903/    12A1 : C6                  	DB	0C6h	; SET 0,(IX+12H)
    3904/    12A2 : CE                  	DB	0CEh	; SET 1,(IX+12H)
    3905/    12A3 : D6                  	DB	0D6h	; SET 2,(IX+12H)
    3906/    12A4 : DE                  	DB	0DEh	; SET 3,(IX+12H)
    3907/    12A5 : E6                  	DB	0E6h	; SET 4,(IX+12H)
    3908/    12A6 : EE                  	DB	0EEh	; SET 5,(IX+12H)
    3909/    12A7 : F6                  	DB	0F6h	; SET 6,(IX+12H)
    3910/    12A8 : FE                  	DB	0FEh	; SET 7,(IX+12H)
    3911/    12A9 :                     dd_bit_opTble:
    3912/    12A9 :                     
    3913/    12A9 :                     ; use checking undefine MC ( ED XX ....)
    3914/    12A9 :                     ed_op_tbl:
    3915/    12A9 : 40                  	DB	40h	; 55:IN  B,(C)
    3916/    12AA : 48                   	DB	48h	; 54:IN  C,(C)
    3917/    12AB : 50                  	DB	50h	; 53:IN  D,(C)
    3918/    12AC : 58                  	DB	58h	; 52:IN  E,(C)
    3919/    12AD : 60                  	DB	60h	; 51:IN  H,(C)
    3920/    12AE : 68                  	DB	68h	; 50:IN  L,(C)
    3921/    12AF : 78                  	DB	78h	; 49:IN  A,(C)
    3922/    12B0 :                     
    3923/    12B0 : 41                  	DB	41h	; 48:OUT (C),B
    3924/    12B1 : 49                  	DB	49h	; 47:OUT (C),C
    3925/    12B2 : 51                  	DB	51h	; 46:OUT (C),D
    3926/    12B3 : 59                  	DB	59h	; 45:OUT (C),E
    3927/    12B4 : 61                  	DB	61h	; 44:OUT (C),H
    3928/    12B5 : 69                  	DB	69h	; 43:OUT (C),L
    3929/    12B6 : 79                  	DB	79h	; 42:OUT (C),A
    3930/    12B7 :                     
    3931/    12B7 : 42                  	DB	42h	; 41:SBC HL,BC
    3932/    12B8 : 52                  	DB	52h	; 40:SBC HL,DE
    3933/    12B9 : 62                  	DB	62h	; 39:SBC HL,HL
    3934/    12BA : 72                  	DB	72h	; 38:SBC HL,SP
    3935/    12BB :                     
    3936/    12BB : 4A                  	DB	4Ah	; 37:ADC HL,BC
    3937/    12BC : 5A                  	DB	5Ah	; 36:ADC HL,DE
    3938/    12BD : 6A                  	DB	6Ah	; 35:ADC HL,HL
    3939/    12BE : 7A                  	DB	7Ah	; 34:ADC HL,SP
    3940/    12BF :                     
    3941/    12BF : 47                  	DB	47h	; 33:LD I,A
    3942/    12C0 : 4F                  	DB	4Fh	; 32:LD R,A
    3943/    12C1 : 57                  	DB	57h	; 31:LD A,I
    3944/    12C2 : 5F                  	DB	5Fh	; 30:LD A,R
    3945/    12C3 :                     
    3946/    12C3 : 46                  	DB	46h	; 29:IM  0
    3947/    12C4 : 56                  	DB	56h	; 28:IM  1
    3948/    12C5 : 5E                  	DB	5Eh	; 27:IM  2
    3949/    12C6 :                     
    3950/    12C6 : 44                  	DB	44h	; 26:NEG
    3951/    12C7 : 45                  	DB	45h	; 25:RETN
    3952/    12C8 : 4D                  	DB	4Dh	; 24:RETI
    3953/    12C9 : 67                  	DB	67h	; 23:RRD
    3954/    12CA : 6F                  	DB	6Fh	; 22:RLD
    3955/    12CB : A0                  	DB	0A0h	; 21:LDI
    3956/    12CC : A1                  	DB	0A1h	; 20:CPI
    3957/    12CD : A2                  	DB	0A2h	; 19:INI
    3958/    12CE : A3                  	DB	0A3h	; 18:OUTI
    3959/    12CF : A8                  	DB	0A8h	; 17:LDD
    3960/    12D0 : A9                  	DB	0A9h	; 16:CPD
    3961/    12D1 : AA                  	DB	0AAh	; 15:IND
    3962/    12D2 : AB                  	DB	0ABh	; 14:OUTD
    3963/    12D3 : B0                  	DB	0B0h	; 13:LDIR
    3964/    12D4 : B1                  	DB	0B1h	; 12:CPIR
    3965/    12D5 : B2                  	DB	0B2h	; 11:INIR
    3966/    12D6 : B3                  	DB	0B3h	; 10:OTIR
    3967/    12D7 : B8                  	DB	0B8h	; 09:LDDR
    3968/    12D8 : B9                  	DB	0B9h	; 08:CPDR
    3969/    12D9 : BA                  	DB	0BAh	; 07:INDR
    3970/    12DA : BB                  	DB	0BBh	; 06:OTDR
    3971/    12DB :                     
    3972/    12DB : 43                  	DB	43h	; 05:LD (nnnn),BC
    3973/    12DC : 53                  	DB	53h	; 04:LD (nnnn),DE
    3974/    12DD : 73                  	DB	73h	; 03:LD (nnnn),SP
    3975/    12DE :                     
    3976/    12DE : 4B                  	DB	4Bh	; 02:LD BC,(nnnn)
    3977/    12DF : 5B                  	DB	5Bh	; 01:LD DE,(nnnn)
    3978/    12E0 : 7B                  	DB	7Bh	; 00:LD SP,(nnnn)
    3979/    12E1 :                     ed_op_tble:
    3980/    12E1 :                     
    3981/    12E1 : 41 46 00            RNAF:		DB	"AF",00H
    3982/    12E4 : 41 46 27 00         RNAFX:		DB	"AF'",00H
    3983/    12E8 :                     
    3984/    12E8 : 52 45 54 00         RETstr:		db	"RET", 00h
    3985/    12EC : 4A 50 00            JPstr:		db	"JP", 00h
    3986/    12EF : 4A 52 00            JRstr:		db	"JR", 00h
    3987/    12F2 : 44 4A 4E 5A 00      DJNZstr:	db	"DJNZ", 00h
    3988/    12F7 : 43 41 4C 4C 00      CALLstr:	db	"CALL", 00h
    3989/    12FC : 52 53 54 00         RSTstr:		db	"RST", 00h
    3990/    1300 : 4C 44 00            LDstr:		db	"LD", 00h
    3991/    1303 : 48 41 4C 54 00      HLTstr:		db	"HALT", 00h
    3992/    1308 : 41 44 44 00         ADDstr:		db	"ADD", 00h
    3993/    130C : 41 44 43 00         ADCstr:		db	"ADC", 00h
    3994/    1310 : 53 55 42 00         SUBstr:		db	"SUB", 00h
    3995/    1314 : 53 42 43 00         SBCstr:		db	"SBC", 00h
    3996/    1318 : 41 4E 44 00         ANDstr:		db	"AND", 00h
    3997/    131C : 58 4F 52 00         XORstr:		db	"XOR", 00h
    3998/    1320 : 4F 52 00            ORstr:		db	"OR", 00h
    3999/    1323 : 43 50 00            CPstr:		db	"CP", 00h
    4000/    1326 : 49 4E 43 00         INCstr:		db	"INC", 00h
    4001/    132A : 44 45 43 00         DECstr:		db	"DEC", 00h
    4002/    132E : 50 4F 50 00         POPstr:		db	"POP", 00h
    4003/    1332 : 50 55 53 48 00      PUSHstr:	db	"PUSH",00h
    4004/    1337 : 45 58 00            EXstr:		db	"EX", 00h
    4005/    133A :                     
    4006/    133A : 45 58 58 00         EXXstr:		db	"EXX", 00h
    4007/    133E : 4E 4F 50 00         NOPstr:		db	"NOP", 00h
    4008/    1342 : 52 4C 43 41 00      RLCAstr:	db	"RLCA", 00h
    4009/    1347 : 52 52 43 41 00      RRCAstr:	db	"RRCA", 00h
    4010/    134C : 52 4C 41 00         RLAstr:		db	"RLA", 00h
    4011/    1350 : 52 52 41 00         RRAstr:		db	"RRA", 00h
    4012/    1354 : 44 41 41 00         DAAstr:		db	"DAA", 00h
    4013/    1358 : 43 50 4C 00         CPLstr:		db	"CPL", 00h
    4014/    135C : 53 43 46 00         SCFstr:		db	"SCF", 00h
    4015/    1360 : 43 43 46 00         CCFstr:		db	"CCF", 00h
    4016/    1364 : 44 49 00            DIstr:		db	"DI", 00h
    4017/    1367 : 45 49 00            EIstr:		db	"EI", 00h
    4018/    136A :                     
    4019/    136A : 4F 55 54 00         OUTstr:		db	"OUT", 00h
    4020/    136E : 49 4E 00            INstr:		db	"IN", 00h
    4021/    1371 :                     
    4022/    1371 : 52 4C 43 00         RLCstr		db	"RLC", 00h
    4023/    1375 : 52 52 43 00         RRCstr		db	"RRC", 00h
    4024/    1379 : 52 4C 00            RLstr		db	"RL", 00h
    4025/    137C : 52 52 00            RRstr		db	"RR", 00h
    4026/    137F : 53 4C 41 00         SLAstr		db	"SLA", 00h
    4027/    1383 : 53 52 41 00         SRAstr		db	"SRA", 00h
    4028/    1387 : 53 52 4C 00         SRLstr		db	"SRL", 00h
    4029/    138B : 42 49 54 00         BITstr		db	"BIT", 00h
    4030/    138F : 52 45 53 00         RESstr		db	"RES", 00h
    4031/    1393 : 4E 45 47 00         NEGstr		db	"NEG", 00h
    4032/    1397 : 49 4D 00            IMstr		db	"IM", 00h
    4033/    139A : 52 52 44 00         RRDstr		db	"RRD", 00h
    4034/    139E : 52 4C 44 00         RLDstr		db	"RLD", 00h
    4035/    13A2 : 4C 44 49 00         LDIstr		db	"LDI", 00h
    4036/    13A6 : 43 50 49 00         CPIstr		db	"CPI", 00h
    4037/    13AA : 49 4E 49 00         INIstr		db	"INI", 00h
    4038/    13AE : 4F 55 54 49 00      OUTIstr		db	"OUTI", 00h
    4039/    13B3 : 4C 44 44 00         LDDstr		db	"LDD", 00h
    4040/    13B7 : 43 50 44 00         CPDstr		db	"CPD", 00h
    4041/    13BB : 49 4E 44 00         INDstr		db	"IND", 00h
    4042/    13BF : 4F 55 54 44 00      OUTDstr		db	"OUTD", 00h
    4043/    13C4 : 4C 44 49 52 00      LDIRstr		db	"LDIR", 00h
    4044/    13C9 : 43 50 49 52 00      CPIRstr		db	"CPIR", 00h
    4045/    13CE : 49 4E 49 52 00      INIRstr		db	"INIR", 00h
    4046/    13D3 : 4F 54 49 52 00      OTIRstr		db	"OTIR", 00h
    4047/    13D8 : 4C 44 44 52 00      LDDRstr		db	"LDDR", 00h
    4048/    13DD : 43 50 44 52 00      CPDRstr		db	"CPDR", 00h
    4049/    13E2 : 49 4E 44 52 00      INDRstr		db	"INDR", 00h
    4050/    13E7 : 4F 54 44 52 00      OTDRstr		db	"OTDR", 00h
    4051/    13EC : 52 45 54 49 00      RETIstr		db	"RETI", 00h
    4052/    13F1 : 52 45 54 4E 00      RETNstr		db	"RETN", 00h
    4053/    13F6 :                     ;BITstr		db	"BIT", 00h
    4054/    13F6 :                     ;RESstr		db	"RES", 00h
    4055/    13F6 : 53 45 54 00         SETstr		db	"SET", 00h
    4056/    13FA :                     com_errm:
    4057/    13FA : 3F 3F 3F 00         ER_OPMSG:	db	"???", 00h
    4058/    13FE : 28 43 29 00         KCKstr		db	"(C)", 00h
    4059/    1402 :                     
    4060/    1402 : 28 48 4C 29 00      kRNHL:	db	"(HL)", 00h
    4061/    1407 : 4E 5A 00            cc0:	db	"NZ", 00h
    4062/    140A : 5A 00               cc1:	db	"Z", 00h
    4063/    140C : 4E 43 00            cc2:	db	"NC", 00h
    4064/    140F : 43 00               cc3:	db	"C", 00h
    4065/    1411 : 50 4F 00            cc4:	db	"PO", 00h
    4066/    1414 : 50 45 00            cc5:	db	"PE", 00h
    4067/    1417 : 50 00               cc6:	db	"P", 00h
    4068/    1419 : 4D 00               cc7:	db	"M", 00h
    4069/    141B :                     
    4070/    141B : 5C 30 5E 30 63 30   disRegTbl:	dw	RNB, RNC, RND, RNE, RNH, RNL, kRNHL, RNA
             1421 : 65 30 6A 30 6C 30 
             1427 : 02 14 57 30       
    4071/    142B : 19 14 17 14 14 14   CC_opr:		dw	cc7, cc6, cc5, cc4, cc3, cc2, cc1, cc0
             1431 : 11 14 0F 14 0C 14 
             1437 : 0A 14 07 14       
    4072/    143B : 0F 14 0C 14 0A 14   JRCC_opr1:	dw	cc3, cc2, cc1, cc0
             1441 : 07 14             
    4073/    1443 : 9A 30 67 30 60 30   INC_DEC_ADDrp:	dw	RNSP, RNHL, RNDE, RNBC
             1449 : 59 30             
    4074/    144B : E1 12 67 30 60 30   POP_PUSHrp:	dw	RNAF, RNHL, RNDE, RNBC
             1451 : 59 30             
    4075/    1453 :                     
    4076/    1453 : 67 13 64 13 3A 13   oth_1op_tbl:	dw	EIstr, DIstr, EXXstr, RETstr, CCFstr
             1459 : E8 12 60 13       
    4077/    145D : 5C 13 58 13 54 13   		dw	SCFstr, CPLstr, DAAstr, RRAstr
             1463 : 50 13             
    4078/    1465 : 4C 13 47 13 42 13   		dw	RLAstr, RRCAstr, RLCAstr, NOPstr
             146B : 3E 13             
    4079/    146D :                     
    4080/    146D : 6A 13 6E 13 23 13   logop2str:	dw	OUTstr, INstr, CPstr, ORstr, XORstr
             1473 : 20 13 1C 13       
    4081/    1477 : 18 13 10 13 14 13   		dw	ANDstr, SUBstr, SBCstr, ADCstr, ADDstr
             147D : 0C 13 08 13       
    4082/    1481 :                     
    4083/    1481 : 9A 30 67 30 60 30   logop3str	dw	RNSP, RNHL, RNDE, RNBC
             1487 : 59 30             
    4084/    1489 : 9A 30 60 30 59 30   ed_rp_str	dw	RNSP, RNDE, RNBC, RNSP, RNDE, RNBC
             148F : 9A 30 60 30 59 30 
    4085/    1495 :                     
    4086/    1495 : 2E 13 32 13 2A 13   dd_2opt:	dw	POPstr, PUSHstr, DECstr, INCstr
             149B : 26 13             
    4087/    149D : 9A 30 94 30 60 30   addixrp_tbl:	dw	RNSP, RNIX, RNDE, RNBC
             14A3 : 59 30             
    4088/    14A5 : 9A 30 97 30 60 30   addiyrp_tbl:	dw	RNSP, RNIY, RNDE, RNBC
             14AB : 59 30             
    4089/    14AD :                     
    4090/    14AD : 2A 13 26 13 23 13   ddlogtbl:	dw	DECstr, INCstr, CPstr, ORstr, XORstr, ANDstr, SUBstr
             14B3 : 20 13 1C 13 18 13 
             14B9 : 10 13             
    4091/    14BB : 57 30 6C 30 6A 30   dd_ldtbl:	dw	RNA, RNL, RNH, RNE, RND, RNC, RNB
             14C1 : 65 30 63 30 5E 30 
             14C7 : 5C 30             
    4092/    14C9 :                     
    4093/    14C9 : E7 13 E2 13 DD 13   ed_noopr:	dw	OTDRstr, INDRstr, CPDRstr, LDDRstr
             14CF : D8 13             
    4094/    14D1 : D3 13 CE 13 C9 13   		dw	OTIRstr, INIRstr, CPIRstr, LDIRstr
             14D7 : C4 13             
    4095/    14D9 : BF 13 BB 13 B7 13   		dw	OUTDstr, INDstr, CPDstr, LDDstr
             14DF : B3 13             
    4096/    14E1 : AE 13 AA 13 A6 13   		dw	OUTIstr, INIstr, CPIstr, LDIstr
             14E7 : A2 13             
    4097/    14E9 : 9E 13 9A 13 EC 13   		dw	RLDstr, RRDstr, RETIstr, RETNstr
             14EF : F1 13             
    4098/    14F1 : 93 13               		dw	NEGstr
    4099/    14F3 :                     
    4100/    14F3 : 87 13 83 13 7F 13   dd_rt_str:	dw	SRLstr, SRAstr, SLAstr, RRstr
             14F9 : 7C 13             
    4101/    14FB : 79 13 75 13 71 13   		dw	RLstr, RRCstr, RLCstr
    4102/    1501 :                     	
    4103/    1501 :                     ;;;
    4104/    1501 :                     ;;; GO address
    4105/    1501 :                     ;;; 
    4106/    1501 :                     
    4107/    1501 :                     GO:
    4108/    1501 : EB                  	EX	HL,DE			;Z80 CODE ld	de, (REGPC)
    4109/    1502 : 2A 22 9F            	LD	HL,(REGPC)		;###############################
    4110/    1505 : 22 2E 9F            	LD	(goTmp),HL		;Z80 CODE ld	(goTmp), de	; save go tmp go address
    4111/    1508 : EB                  	EX	HL,DE			;###############################
    4112/    1509 : 23                  	INC	HL
    4113/    150A : CD 3B 29            	CALL	SKIPSP
    4114/    150D : CD 4C 29            	CALL	RDHEX
    4115/    1510 : D2 17 15            	jp	nc, gostmp	;jr	nc, gostmp
    4116/    1513 : B7                  	OR	A
    4117/    1514 : CA 22 15            	JP	Z, g_stpadr	;JR	Z, g_stpadr
    4118/    1517 :                     gostmp:
    4119/    1517 : 7A                  	ld	a, d
    4120/    1518 : =>FALSE              	IF	Fullram
    4121/    1518 : =>TRUE               	ELSE
    4122/    1518 : FE E0               	cp	IO_B >> 8	; a - 0F0H
    4123/    151A : D2 18 01            	jp	nc, ERR		; detect I/O area
    4124/    151D : [4120]               	ENDIF
    4125/    151D : EB                  	EX	HL,DE			;Z80 CODE LD	(goTmp),DE	; save going address
    4126/    151E : 22 2E 9F            	LD	(goTmp),HL		;###############################
    4127/    1521 : EB                  	EX	HL,DE			;###############################
    4128/    1522 :                     g_stpadr:
    4129/    1522 : CD 3B 29            	CALL	SKIPSP
    4130/    1525 : 7E                  	LD	A,(HL)
    4131/    1526 : B7                  	or	a
    4132/    1527 : CA 42 15            	jp	z, GO1		;jr	z, GO1
    4133/    152A : FE 2C               	cp	','
    4134/    152C : C2 18 01            	jp	nz, ERR
    4135/    152F :                     
    4136/    152F :                     ; set break point with go command
    4137/    152F :                     
    4138/    152F : 23                  	INC	HL
    4139/    1530 : CD 3B 29            	CALL	SKIPSP
    4140/    1533 : CD 4C 29            	CALL	RDHEX		; 1st arg.
    4141/    1536 : DA 18 01            	jp	c, ERR
    4142/    1539 :                     
    4143/    1539 : 21 47 9F            	ld	hl, tmpb_f	; hl: temp break point buffer
    4144/    153C : CD 05 03            	call	setbpadr
    4145/    153F : DA 18 01            	jp	c, ERR		; address is incorrect
    4146/    1542 :                     
    4147/    1542 :                     GO1:
    4148/    1542 : 2A 2E 9F            	LD	hl, (goTmp)
    4149/    1545 : 22 22 9F            	ld	(REGPC), hl	; set go address
    4150/    1548 :                     
    4151/    1548 :                     G0:
    4152/    1548 :                     ; check Trace mode
    4153/    1548 :                     
    4154/    1548 : 3A 37 9F            	ld	a, (tpt1_f)
    4155/    154B : B7                  	or	a
    4156/    154C : CA 6A 15            	jp	z, donot_trace	;jr	z, donot_trace
    4157/    154F :                     	
    4158/    154F : 2A 34 9F            	ld	hl,(tmpT)
    4159/    1552 : 22 22 9F            	ld	(REGPC), hl	; set trace address
    4160/    1555 :                     
    4161/    1555 : 21 37 9F            	ld	hl, tpt1_f
    4162/    1558 : 11 39 9F            	ld	de, tpt1_adr
    4163/    155B : CD A0 15            	call	set_bp
    4164/    155E : 21 3B 9F            	ld	hl, tpt2_f
    4165/    1561 : 11 3D 9F            	ld	de, tpt2_adr
    4166/    1564 : CD A0 15            	call	set_bp
    4167/    1567 : C3 85 15            	jp	skp_tbp		;jr	skp_tbp		; skip set tmp bp and bp, if tracing
    4168/    156A :                     
    4169/    156A :                     ; set break point
    4170/    156A :                     donot_trace:
    4171/    156A : 21 3F 9F            	ld	hl, bpt1_f
    4172/    156D : 11 41 9F            	ld	de, bpt1_adr
    4173/    1570 : CD A0 15            	call	set_bp
    4174/    1573 : 21 43 9F            	ld	hl, bpt2_f
    4175/    1576 : 11 45 9F            	ld	de, bpt2_adr
    4176/    1579 : CD A0 15            	call	set_bp
    4177/    157C :                     
    4178/    157C :                     
    4179/    157C :                     ; check go, break pointer
    4180/    157C :                     
    4181/    157C : 21 47 9F            	ld	hl, tmpb_f
    4182/    157F : 11 49 9F            	ld	de, tmpb_adr
    4183/    1582 : CD A0 15            	call	set_bp
    4184/    1585 :                     
    4185/    1585 :                     	;; R register adjustment
    4186/    1585 :                     
    4187/    1585 :                     skp_tbp:
    4188/    1585 : 2A 20 9F            	LD	HL,(REGSP)
    4189/    1588 : F9                  	LD	SP,HL
    4190/    1589 : 2A 22 9F            	LD	HL,(REGPC)
    4191/    158C : E5                  	PUSH	HL
    4192/    158D :                     ;	LD	IX,(REGIX)		;Z80 CODE ignore now ###########
    4193/    158D :                     ;	LD	IY,(REGIY)		;Z80 CODE ignore now ###########
    4194/    158D :                     ;	LD	HL,(REGAFX)		;reg AF' restore innore now ####
    4195/    158D :                     ;	PUSH	HL			;reg AF' restore innore now ####
    4196/    158D :                     ;	LD	BC,(REGBCX)		;reg BC' restore innore now ####
    4197/    158D :                     ;	LD	DE,(REGDEX)		;reg DE' restore innore now ####
    4198/    158D :                     ;	LD	HL,(REGHLX)		;reg HL' restore innore now ####
    4199/    158D :                     ;	EXX				;Z80 CODE ignore now ###########
    4200/    158D :                     ;	POP	AF			;reg AF' restore innore now ####
    4201/    158D :                     ;	EX	AF,AF'			;Z80 CODE ignore now ###########
    4202/    158D : 2A 0C 9F            	LD	HL,(REGAF)
    4203/    1590 : E5                  	PUSH	HL
    4204/    1591 : 2A 0E 9F            	LD	HL,(REGBC)		;Z80 CODE LD	BC,(REGBC) #####
    4205/    1594 : 44                  	LD	B,H			;## HL destroyed it's OK here ##
    4206/    1595 : 4D                  	LD	C,L			;## HL destroyed it's OK here ##
    4207/    1596 : 2A 0E 9F            	LD	HL,(REGBC)		;Z80 CODE LD	DE,(REGBC) #####
    4208/    1599 : 54                  	LD	D,H			;## HL destroyed it's OK here ##
    4209/    159A : 6D                  	LD	L,L			;## HL destroyed it's OK here ##
    4210/    159B : 2A 12 9F            	LD	HL,(REGHL)
    4211/    159E :                     ;	LD	A,(REGI)		;reg I restore ignore now ######
    4212/    159E :                     ;	LD	I,A			;Z80 CODE ignore now ###########
    4213/    159E :                     ;	LD	A,(REGR)		;reg R restore ignore now ######
    4214/    159E :                     ;	LD	R,A			;Z80 CODE ignore now ###########
    4215/    159E : F1                  	POP	AF
    4216/    159F : C9                  	RET			; POP PC
    4217/    15A0 :                     
    4218/    15A0 :                     set_bp:
    4219/    15A0 : 7E                  	ld	a, (hl)
    4220/    15A1 : B7                  	or	a
    4221/    15A2 : C8                  	ret	z
    4222/    15A3 :                     
    4223/    15A3 : 1A                  	ld	a, (de)
    4224/    15A4 : 4F                  	ld	c, a
    4225/    15A5 : 13                  	inc	de
    4226/    15A6 : 1A                  	ld	a, (de)
    4227/    15A7 : 47                  	ld	b, a	; bc = break point address
    4228/    15A8 :                     
    4229/    15A8 : 3E FF               	ld	a, 0FFH
    4230/    15AA : 02                  	ld	(bc), a	; insert RST 38H code
    4231/    15AB : C9                  	ret
    4232/    15AC :                     	
    4233/    15AC :                     ;;;
    4234/    15AC :                     ;;; SET memory
    4235/    15AC :                     ;;; 
    4236/    15AC :                     
    4237/    15AC :                     SETM:
    4238/    15AC : 23                  	INC	HL
    4239/    15AD : CD 3B 29            	CALL	SKIPSP
    4240/    15B0 : CD 4C 29            	CALL	RDHEX
    4241/    15B3 :                     
    4242/    15B3 : DA 18 01            	jp	c, ERR
    4243/    15B6 :                     
    4244/    15B6 : CD 3B 29            	CALL	SKIPSP
    4245/    15B9 : 7E                  	LD	A,(HL)
    4246/    15BA : B7                  	OR	A
    4247/    15BB : C2 18 01            	JP	NZ,ERR
    4248/    15BE : 79                  	LD	A,C
    4249/    15BF : B7                  	OR	A
    4250/    15C0 : C2 C8 15            	JP	NZ,SM0		;JR	NZ,SM0
    4251/    15C3 : EB                  	EX	HL,DE			;Z80 CODE LD	DE,(SADDR)
    4252/    15C4 : 2A 07 9F            	LD	HL,(SADDR)		;###############################
    4253/    15C7 : EB                  	EX	HL,DE			;###############################
    4254/    15C8 :                     
    4255/    15C8 :                     SM0:
    4256/    15C8 : EB                  	EX	DE,HL
    4257/    15C9 :                     SM1:
    4258/    15C9 : CD 2D 28            	CALL	HEXOUT4
    4259/    15CC : E5                  	PUSH	HL
    4260/    15CD : 21 76 2E            	LD	HL,dsap
    4261/    15D0 : CD 23 28            	CALL	STROUT
    4262/    15D3 : E1                  	POP	HL
    4263/    15D4 : 7E                  	LD	A,(HL)
    4264/    15D5 : E5                  	PUSH	HL
    4265/    15D6 : CD 32 28            	CALL	HEXOUT2
    4266/    15D9 : 3E 20               	LD	A,' '
    4267/    15DB : CD F9 30            	CALL	CONOUT
    4268/    15DE : CD 88 28            	CALL	GETLIN
    4269/    15E1 : CD 3B 29            	CALL	SKIPSP
    4270/    15E4 : 7E                  	LD	A,(HL)
    4271/    15E5 : B7                  	OR	A
    4272/    15E6 : C2 F1 15            	JP	NZ,SM2		;JR	NZ,SM2
    4273/    15E9 :                     	;; Empty  (Increment address)
    4274/    15E9 : E1                  	POP	HL
    4275/    15EA : 23                  	INC	HL
    4276/    15EB : 22 07 9F            	LD	(SADDR),HL
    4277/    15EE : C3 C9 15            	JP	SM1		;JR	SM1
    4278/    15F1 :                     SM2:
    4279/    15F1 : FE 2D               	CP	'-'
    4280/    15F3 : C2 FE 15            	JP	NZ,SM3		;JR	NZ,SM3
    4281/    15F6 :                     	;; '-'  (Decrement address)
    4282/    15F6 : E1                  	POP	HL
    4283/    15F7 : 2B                  	DEC	HL
    4284/    15F8 : 22 07 9F            	LD	(SADDR),HL
    4285/    15FB : C3 C9 15            	JP	SM1		;JR	SM1
    4286/    15FE :                     SM3:
    4287/    15FE : FE 2E               	CP	'.'
    4288/    1600 : C2 0A 16            	JP	NZ,SM4		;JR	NZ,SM4
    4289/    1603 : E1                  	POP	HL
    4290/    1604 : 22 07 9F            	LD	(SADDR),HL
    4291/    1607 : C3 CD 00            	JP	WSTART
    4292/    160A :                     SM4:
    4293/    160A : CD 4C 29            	CALL	RDHEX
    4294/    160D : B7                  	OR	A
    4295/    160E : E1                  	POP	HL
    4296/    160F : CA 18 01            	JP	Z,ERR
    4297/    1612 : 73                  	LD	(HL),E
    4298/    1613 : 23                  	INC	HL
    4299/    1614 : 22 07 9F            	LD	(SADDR),HL	; set value
    4300/    1617 :                     
    4301/    1617 :                     	; resave opcode for BP command
    4302/    1617 : EB                  	EX	HL,DE			;Z80 CODE ld	de, (bpt1_adr)
    4303/    1618 : 2A 41 9F            	LD	HL,(bpt1_adr)		;###############################
    4304/    161B : EB                  	EX	HL,DE			;###############################
    4305/    161C : 1A                  	ld	a, (de)
    4306/    161D : 32 40 9F            	ld	(bpt1_op), a
    4307/    1620 : EB                  	EX	HL,DE			;Z80 CODE ld	de, (bpt2_adr)
    4308/    1621 : 2A 45 9F            	LD	HL,(bpt2_adr)		;###############################
    4309/    1624 : EB                  	EX	HL,DE			;###############################
    4310/    1625 : 1A                  	ld	a, (de)
    4311/    1626 : 32 44 9F            	ld	(bpt2_op), a
    4312/    1629 :                     
    4313/    1629 : C3 C9 15            	JP	SM1		;JR	SM1
    4314/    162C :                     
    4315/    162C :                     ;;;
    4316/    162C :                     ;;; LOAD HEX file
    4317/    162C :                     ;;;
    4318/    162C :                     
    4319/    162C :                     LOADH:
    4320/    162C :                     	; clear brk point
    4321/    162C : AF                  	xor	a
    4322/    162D : 32 3F 9F            	ld	(bpt1_f), a
    4323/    1630 : 32 43 9F            	ld	(bpt2_f), a
    4324/    1633 :                     	
    4325/    1633 : 23                  	INC	HL
    4326/    1634 : CD 3B 29            	CALL	SKIPSP
    4327/    1637 : CD 4C 29            	CALL	RDHEX
    4328/    163A : CD 3B 29            	CALL	SKIPSP
    4329/    163D : 7E                  	LD	A,(HL)
    4330/    163E : B7                  	OR	A
    4331/    163F : C2 18 01            	JP	NZ,ERR
    4332/    1642 :                     
    4333/    1642 : 79                  	LD	A,C
    4334/    1643 : B7                  	OR	A
    4335/    1644 : C2 4A 16            	JP	NZ,LH0		;JR	NZ,LH0
    4336/    1647 :                     
    4337/    1647 : 11 00 00            	LD	DE,0		;Offset
    4338/    164A :                     LH0:
    4339/    164A : CD EA 30            	CALL	CONIN
    4340/    164D : FE 53               	CP	'S'
    4341/    164F : CA BD 16            	JP	Z,LHS0		;JR	Z,LHS0
    4342/    1652 :                     LH1:
    4343/    1652 : FE 3A               	CP	':'
    4344/    1654 : CA 67 16            	JP	Z,LHI0		;JR	Z,LHI0
    4345/    1657 :                     LH2:
    4346/    1657 :                     	;; Skip to EOL
    4347/    1657 : FE 0D               	CP	CR
    4348/    1659 : CA 4A 16            	JP	Z,LH0		;JR	Z,LH0
    4349/    165C : FE 0A               	CP	LF
    4350/    165E : CA 4A 16            	JP	Z,LH0		;JR	Z,LH0
    4351/    1661 :                     LH3:
    4352/    1661 : CD EA 30            	CALL	CONIN
    4353/    1664 : C3 57 16            	JP	LH2		;JR	LH2
    4354/    1667 :                     
    4355/    1667 :                     LHI0:
    4356/    1667 : 3E 2E               	ld	a, '.'
    4357/    1669 : CD F9 30            	call	CONOUT
    4358/    166C :                     
    4359/    166C : CD 49 28            	CALL	HEXIN
    4360/    166F : 4F                  	LD	C,A		; Checksum
    4361/    1670 : 47                  	LD	B,A		; Length
    4362/    1671 :                     
    4363/    1671 : CD 49 28            	CALL	HEXIN
    4364/    1674 : 67                  	LD	H,A		; Address H
    4365/    1675 : 81                  	ADD	A,C
    4366/    1676 : 4F                  	LD	C,A
    4367/    1677 :                     
    4368/    1677 : CD 49 28            	CALL	HEXIN
    4369/    167A : 6F                  	LD	L,A		; Address L
    4370/    167B : 81                  	ADD	A,C
    4371/    167C : 4F                  	LD	C,A
    4372/    167D :                     
    4373/    167D :                     	;; Add offset
    4374/    167D : 19                  	ADD	HL,DE
    4375/    167E :                     
    4376/    167E : CD 49 28            	CALL	HEXIN
    4377/    1681 : 32 0A 9F            	LD	(RECTYP),A
    4378/    1684 : 81                  	ADD	A,C
    4379/    1685 : 4F                  	LD	C,A		; Checksum
    4380/    1686 :                     
    4381/    1686 : 78                  	LD	A,B
    4382/    1687 : B7                  	OR	A
    4383/    1688 : CA A3 16            	JP	Z,LHI3		;JR	Z,LHI3
    4384/    168B :                     LHI1:
    4385/    168B : CD 49 28            	CALL	HEXIN
    4386/    168E : F5                  	PUSH	AF
    4387/    168F : 81                  	ADD	A,C
    4388/    1690 : 4F                  	LD	C,A		; Checksum
    4389/    1691 :                     
    4390/    1691 : 3A 0A 9F            	LD	A,(RECTYP)
    4391/    1694 : B7                  	OR	A
    4392/    1695 : C2 9E 16            	JP	NZ,LHI20	;JR	NZ,LHI20
    4393/    1698 :                     
    4394/    1698 : F1                  	POP	AF
    4395/    1699 : 77                  	LD	(HL),A
    4396/    169A : 23                  	INC	HL
    4397/    169B : C3 9F 16            	JP	LHI2		;JR	;LHI2
    4398/    169E :                     LHI20:
    4399/    169E : F1                  	POP	AF
    4400/    169F :                     LHI2:
    4401/    169F : 05                  	DEC	B			;Z80 CODE #####	DJNZ	LHI1
    4402/    16A0 : C2 8B 16            	JP	NZ,LHI1			;##############################
    4403/    16A3 :                     LHI3:
    4404/    16A3 : CD 49 28            	CALL	HEXIN
    4405/    16A6 : 81                  	ADD	A,C
    4406/    16A7 : C2 B4 16            	JP	NZ,LHIE		;JR	NZ,LHIE	; Checksum error
    4407/    16AA : 3A 0A 9F            	LD	A,(RECTYP)
    4408/    16AD : B7                  	OR	A
    4409/    16AE : CA 61 16            	JP	Z,LH3
    4410/    16B1 : C3 CD 00            	JP	WSTART
    4411/    16B4 :                     LHIE:
    4412/    16B4 : 21 4D 2E            	LD	HL,IHEMSG
    4413/    16B7 : CD 23 28            	CALL	STROUT
    4414/    16BA : C3 CD 00            	JP	WSTART
    4415/    16BD :                     	
    4416/    16BD :                     LHS0:
    4417/    16BD : CD EA 30            	CALL	CONIN
    4418/    16C0 : 32 0A 9F            	LD	(RECTYP),A
    4419/    16C3 :                     
    4420/    16C3 : CD 49 28            	CALL	HEXIN
    4421/    16C6 : 47                  	LD	B,A		; Length+3
    4422/    16C7 : 4F                  	LD	C,A		; Checksum
    4423/    16C8 :                     
    4424/    16C8 : CD 49 28            	CALL	HEXIN
    4425/    16CB : 67                  	LD	H,A
    4426/    16CC : 81                  	ADD	A,C
    4427/    16CD : 4F                  	LD	C,A
    4428/    16CE :                     	
    4429/    16CE : CD 49 28            	CALL	HEXIN
    4430/    16D1 : 6F                  	LD	L,A
    4431/    16D2 : 81                  	ADD	A,C
    4432/    16D3 : 4F                  	LD	C,A
    4433/    16D4 :                     
    4434/    16D4 : 19                  	ADD	HL,DE
    4435/    16D5 :                     
    4436/    16D5 : 05                  	DEC	B
    4437/    16D6 : 05                  	DEC	B
    4438/    16D7 : 05                  	DEC	B
    4439/    16D8 : CA F4 16            	JP	Z,LHS3		;JR	Z,LHS3
    4440/    16DB :                     LHS1:
    4441/    16DB : CD 49 28            	CALL	HEXIN
    4442/    16DE : F5                  	PUSH	AF
    4443/    16DF : 81                  	ADD	A,C
    4444/    16E0 : 4F                  	LD	C,A		; Checksum
    4445/    16E1 :                     
    4446/    16E1 : 3A 0A 9F            	LD	A,(RECTYP)
    4447/    16E4 : FE 31               	CP	'1'
    4448/    16E6 : C2 EF 16            	JP	NZ,LHS2		;JR	NZ,LHS2
    4449/    16E9 :                     
    4450/    16E9 : F1                  	POP	AF
    4451/    16EA : 77                  	LD	(HL),A
    4452/    16EB : 23                  	INC	HL
    4453/    16EC : C3 F0 16            	JP	LHS20		;JR	LHS20
    4454/    16EF :                     LHS2:
    4455/    16EF : F1                  	POP	AF
    4456/    16F0 :                     LHS20:
    4457/    16F0 : 05                  	DEC	B			;Z80 CODE ##### DJNZ	LHS1
    4458/    16F1 : C2 DB 16            	JP	NZ,LHS1			;###############################
    4459/    16F4 :                     LHS3:
    4460/    16F4 : CD 49 28            	CALL	HEXIN
    4461/    16F7 : 81                  	ADD	A,C
    4462/    16F8 : FE FF               	CP	0FFH
    4463/    16FA : C2 12 17            	JP	NZ,LHSE		;JR	NZ,LHSE
    4464/    16FD :                     
    4465/    16FD : 3A 0A 9F            	LD	A,(RECTYP)
    4466/    1700 : FE 37               	CP	'7'
    4467/    1702 : CA 18 17            	JP	Z,LHSR		;JR	Z,LHSR
    4468/    1705 : FE 38               	CP	'8'
    4469/    1707 : CA 18 17            	JP	Z,LHSR		;JR	Z,LHSR
    4470/    170A : FE 39               	CP	'9'
    4471/    170C : CA 18 17            	JP	Z,LHSR		;JR	Z,LHSR
    4472/    170F : C3 61 16            	JP	LH3
    4473/    1712 :                     LHSE:
    4474/    1712 : 21 5A 2E            	LD	HL,SHEMSG
    4475/    1715 : CD 23 28            	CALL	STROUT
    4476/    1718 :                     LHSR:
    4477/    1718 : C3 CD 00            	JP	WSTART
    4478/    171B :                     	
    4479/    171B :                     ;;;
    4480/    171B :                     ;;; SAVE HEX file
    4481/    171B :                     ;;;
    4482/    171B :                     
    4483/    171B :                     SAVEH:
    4484/    171B : 23                  	INC	HL
    4485/    171C : 7E                  	LD	A,(HL)
    4486/    171D : FE 49               	CP	'I'
    4487/    171F : CA 27 17            	JP	Z,SH0		;JR	Z,SH0
    4488/    1722 : FE 53               	CP	'S'
    4489/    1724 : C2 2B 17            	JP	NZ,SH1		;JR	NZ,SH1
    4490/    1727 :                     SH0:
    4491/    1727 : 23                  	INC	HL
    4492/    1728 : 32 09 9F            	LD	(HEXMOD),A
    4493/    172B :                     SH1:
    4494/    172B : CD 3B 29            	CALL	SKIPSP
    4495/    172E : CD 4C 29            	CALL	RDHEX
    4496/    1731 : B7                  	OR	A
    4497/    1732 : CA 56 17            	JP	Z,SHE		;JR	Z,SHE
    4498/    1735 : EB                  	EX	HL,DE			;PUSH	DE
    4499/    1736 : 22 A0 9F            	LD	(tmp_HL),HL		;###############################
    4500/    1739 : EB                  	EX	HL,DE			;###############################
    4501/    173A :                     ;	POP	IX			;Z80 CODE NOT TRANSLATED YET	; IX = Start address
    4502/    173A : CD 3B 29            	CALL	SKIPSP
    4503/    173D : 7E                  	LD	A,(HL)
    4504/    173E : FE 2C               	CP	','
    4505/    1740 : C2 56 17            	JP	NZ,SHE		;JR	NZ,SHE
    4506/    1743 : 23                  	INC	HL
    4507/    1744 : CD 3B 29            	CALL	SKIPSP
    4508/    1747 : CD 4C 29            	CALL	RDHEX		; DE = End address
    4509/    174A : B7                  	OR	A
    4510/    174B : CA 56 17            	JP	Z,SHE		;JR	Z,SHE
    4511/    174E : CD 3B 29            	CALL	SKIPSP
    4512/    1751 : 7E                  	LD	A,(HL)
    4513/    1752 : B7                  	OR	A
    4514/    1753 : CA 59 17            	JP	Z,SH2		;JR	Z,SH2
    4515/    1756 :                     SHE:
    4516/    1756 : C3 18 01            	JP	ERR
    4517/    1759 :                     
    4518/    1759 :                     SH2:
    4519/    1759 :                     ;	PUSH	IX			;Z80 CODE oush ix ##############
    4520/    1759 : 2A A0 9F            	LD	HL,(tmp_HL)		;POP	HL #####################
    4521/    175C : EB                  	EX	DE,HL
    4522/    175D : 23                  	INC	HL
    4523/    175E : B7                  	OR	A
    4524/    175F : CD CF 30            	call	sbc_hlde		;Z80 CODE SBC	HL,DE		; HL = Length
    4525/    1762 :                     SH3:
    4526/    1762 : CD 84 17            	CALL	SHL00
    4527/    1765 : 7C                  	LD	A,H
    4528/    1766 : B5                  	OR	L
    4529/    1767 : C2 62 17            	JP	NZ,SH3		;JR	NZ,SH3
    4530/    176A :                     
    4531/    176A : 3A 09 9F            	LD	A,(HEXMOD)
    4532/    176D : FE 49               	CP	'I'
    4533/    176F : C2 7B 17            	JP	NZ,SH4		;JR	NZ,SH4
    4534/    1772 :                     	;; End record for Intel HEX
    4535/    1772 : 21 79 2E            	LD	HL,IHEXER
    4536/    1775 : CD 23 28            	CALL	STROUT
    4537/    1778 : C3 CD 00            	JP	WSTART
    4538/    177B :                     SH4:
    4539/    177B :                     	;; End record for Motorola S record
    4540/    177B : 21 87 2E            	LD	HL,SRECER
    4541/    177E : CD 23 28            	CALL	STROUT
    4542/    1781 : C3 CD 00            	JP	WSTART
    4543/    1784 :                     
    4544/    1784 :                     SHL00:
    4545/    1784 : 0E 10               	LD	C,16
    4546/    1786 : 7C                  	LD	A,H
    4547/    1787 : B7                  	OR	A
    4548/    1788 : C2 91 17            	JP	NZ,SHL0		;JR	NZ,SHL0
    4549/    178B : 7D                  	LD	A,L
    4550/    178C : B9                  	CP	C
    4551/    178D : D2 91 17            	JP	NC,SHL0		;JR	NC,SHL0
    4552/    1790 : 4F                  	LD	C,A
    4553/    1791 :                     SHL0:
    4554/    1791 : 06 00               	LD	B,0
    4555/    1793 : B7                  	OR	A
    4556/    1794 : CD B4 30            	call	sbc_hlbc		;Z80 CODE SBC	HL,BC #####
    4557/    1797 : 41                  	LD	B,C
    4558/    1798 :                     
    4559/    1798 : 3A 09 9F            	LD	A,(HEXMOD)
    4560/    179B : FE 49               	CP	'I'
    4561/    179D : C2 D2 17            	JP	NZ,SHLS		;JR	NZ,SHLS
    4562/    17A0 :                     
    4563/    17A0 :                     	;; Intel HEX
    4564/    17A0 : 3E 3A               	LD	A,':'
    4565/    17A2 : CD F9 30            	CALL	CONOUT
    4566/    17A5 :                     
    4567/    17A5 : 78                  	LD	A,B
    4568/    17A6 : CD 32 28            	CALL	HEXOUT2		; Length
    4569/    17A9 : 48                  	LD	C,B		; Checksum
    4570/    17AA :                     
    4571/    17AA : 7A                  	LD	A,D
    4572/    17AB : CD 32 28            	CALL	HEXOUT2
    4573/    17AE : 7A                  	LD	A,D
    4574/    17AF : 81                  	ADD	A,C
    4575/    17B0 : 4F                  	LD	C,A
    4576/    17B1 :                     	
    4577/    17B1 : 7B                  	LD	A,E
    4578/    17B2 : CD 32 28            	CALL	HEXOUT2
    4579/    17B5 : 7B                  	LD	A,E
    4580/    17B6 : 81                  	ADD	A,C
    4581/    17B7 : 4F                  	LD	C,A
    4582/    17B8 :                     	
    4583/    17B8 : AF                  	XOR	A
    4584/    17B9 : CD 32 28            	CALL	HEXOUT2
    4585/    17BC :                     SHLI0:
    4586/    17BC : 1A                  	LD	A,(DE)
    4587/    17BD : F5                  	PUSH	AF
    4588/    17BE : CD 32 28            	CALL	HEXOUT2
    4589/    17C1 : F1                  	POP	AF
    4590/    17C2 : 81                  	ADD	A,C
    4591/    17C3 : 4F                  	LD	C,A
    4592/    17C4 :                     
    4593/    17C4 : 13                  	INC	DE
    4594/    17C5 : 05                  	DEC	B			;Z80 CODE #####	DJNZ	SHLI0
    4595/    17C6 : C2 BC 17            	JP	NZ,SHLI0		;############################
    4596/    17C9 :                     
    4597/    17C9 : 79                  	LD	A,C
    4598/    17CA : 2F                  	CPL				;Z80 CODE NEG
    4599/    17CB : 3C                  	INC	A			;flags may be wrong, it's OK here
    4600/    17CC : CD 32 28            	CALL	HEXOUT2
    4601/    17CF : C3 71 28            	JP	CRLF
    4602/    17D2 :                     
    4603/    17D2 :                     SHLS:
    4604/    17D2 :                     	;; Motorola S record
    4605/    17D2 : 3E 53               	LD	A,'S'
    4606/    17D4 : CD F9 30            	CALL	CONOUT
    4607/    17D7 : 3E 31               	LD	A,'1'
    4608/    17D9 : CD F9 30            	CALL	CONOUT
    4609/    17DC :                     
    4610/    17DC : 78                  	LD	A,B
    4611/    17DD : C6 03               	ADD	A,2+1		; DataLength + 2(Addr) + 1(Sum)
    4612/    17DF : 4F                  	LD	C,A
    4613/    17E0 : CD 32 28            	CALL	HEXOUT2
    4614/    17E3 :                     
    4615/    17E3 : 7A                  	LD	A,D
    4616/    17E4 : CD 32 28            	CALL	HEXOUT2
    4617/    17E7 : 7A                  	LD	A,D
    4618/    17E8 : 81                  	ADD	A,C
    4619/    17E9 : 4F                  	LD	C,A
    4620/    17EA :                     	
    4621/    17EA : 7B                  	LD	A,E
    4622/    17EB : CD 32 28            	CALL	HEXOUT2
    4623/    17EE : 7B                  	LD	A,E
    4624/    17EF : 81                  	ADD	A,C
    4625/    17F0 : 4F                  	LD	C,A
    4626/    17F1 :                     SHLS0:
    4627/    17F1 : 1A                  	LD	A,(DE)
    4628/    17F2 : F5                  	PUSH	AF
    4629/    17F3 : CD 32 28            	CALL	HEXOUT2		; Data
    4630/    17F6 : F1                  	POP	AF
    4631/    17F7 : 81                  	ADD	A,C
    4632/    17F8 : 4F                  	LD	C,A
    4633/    17F9 :                     
    4634/    17F9 : 13                  	INC	DE
    4635/    17FA : 05                  	DEC	B			;Z80 CODE ##### DJNZ	SHLS0
    4636/    17FB : C2 F1 17            	JP	NZ,SHLS0		;###############################
    4637/    17FE :                     
    4638/    17FE : 79                  	LD	A,C
    4639/    17FF : 2F                  	CPL
    4640/    1800 : CD 32 28            	CALL	HEXOUT2
    4641/    1803 : C3 71 28            	JP	CRLF
    4642/    1806 :                     
    4643/    1806 :                     ;;;
    4644/    1806 :                     ;;; Register
    4645/    1806 :                     ;;;
    4646/    1806 :                     
    4647/    1806 :                     REG:
    4648/    1806 : 23                  	INC	HL
    4649/    1807 : CD 3B 29            	CALL	SKIPSP
    4650/    180A : B7                  	OR	A
    4651/    180B : C2 14 18            	JP	NZ,RG0		;JR	NZ,RG0
    4652/    180E : CD 98 18            	CALL	RDUMP
    4653/    1811 : C3 CD 00            	JP	WSTART
    4654/    1814 :                     RG0:
    4655/    1814 : EB                  	EX	DE,HL
    4656/    1815 : 21 3D 2F            	LD	HL,RNTAB
    4657/    1818 :                     RG1:
    4658/    1818 : BE                  	CP	(HL)
    4659/    1819 : CA 2B 18            	JP	Z,RG2		;JR	Z,RG2		; Character match
    4660/    181C : 4F                  	LD	C,A
    4661/    181D : 23                  	INC	HL
    4662/    181E : 7E                  	LD	A,(HL)
    4663/    181F : B7                  	OR	A
    4664/    1820 : CA 95 18            	JP	Z,RGE		;JR	Z,RGE		; Found end mark
    4665/    1823 : 79                  	LD	A,C
    4666/    1824 : 01 05 00            	LD	BC,5
    4667/    1827 : 09                  	ADD	HL,BC		; Next entry
    4668/    1828 : C3 18 18            	JP	RG1		;JR	RG1
    4669/    182B :                     RG2:
    4670/    182B : 23                  	INC	HL
    4671/    182C : 7E                  	LD	A,(HL)
    4672/    182D : FE 0F               	CP	0FH		; Link code
    4673/    182F : C2 3C 18            	JP	NZ,RG3		;JR	NZ,RG3
    4674/    1832 :                     	;; Next table
    4675/    1832 : 23                  	INC	HL
    4676/    1833 : 4E                  	LD	C,(HL)
    4677/    1834 : 23                  	INC	HL
    4678/    1835 : 66                  	LD	H,(HL)
    4679/    1836 : 69                  	LD	L,C
    4680/    1837 : 13                  	INC	DE
    4681/    1838 : 1A                  	LD	A,(DE)
    4682/    1839 : C3 18 18            	JP	RG1		;JR	RG1
    4683/    183C :                     RG3:
    4684/    183C : B7                  	OR	A
    4685/    183D : CA 95 18            	JP	Z,RGE		;JR	Z,RGE		; Found end mark
    4686/    1840 :                     
    4687/    1840 : 4E                  	LD	C,(HL)		; LD C,A???
    4688/    1841 : 23                  	INC	HL
    4689/    1842 : 5E                  	LD	E,(HL)
    4690/    1843 : 23                  	INC	HL
    4691/    1844 : 56                  	LD	D,(HL)
    4692/    1845 : D5                  	PUSH	DE		; Reg storage address
    4693/    1846 : 23                  	INC	HL
    4694/    1847 : 7E                  	LD	A,(HL)
    4695/    1848 : 23                  	INC	HL
    4696/    1849 : 66                  	LD	H,(HL)
    4697/    184A : 6F                  	LD	L,A		; HL: Reg name
    4698/    184B : CD 23 28            	CALL	STROUT
    4699/    184E : 3E 3D               	LD	A,'='
    4700/    1850 : CD F9 30            	CALL	CONOUT
    4701/    1853 :                     
    4702/    1853 : 79                  	LD	A,C
    4703/    1854 : E6 07               	AND	07H
    4704/    1856 : FE 01               	CP	1
    4705/    1858 : C2 64 18            	JP	NZ,RG4		;JR	NZ,RG4
    4706/    185B :                     	;; 8 bit register
    4707/    185B : E1                  	POP	HL
    4708/    185C : 7E                  	LD	A,(HL)
    4709/    185D : E5                  	PUSH	HL
    4710/    185E : CD 32 28            	CALL	HEXOUT2
    4711/    1861 : C3 70 18            	JP	RG5		;JR	RG5
    4712/    1864 :                     RG4:
    4713/    1864 :                     	;; 16 bit register
    4714/    1864 : E1                  	POP	HL
    4715/    1865 : E5                  	PUSH	HL
    4716/    1866 : 23                  	INC	HL
    4717/    1867 : 7E                  	LD	A,(HL)
    4718/    1868 : CD 32 28            	CALL	HEXOUT2
    4719/    186B : 2B                  	DEC	HL
    4720/    186C : 7E                  	LD	A,(HL)
    4721/    186D : CD 32 28            	CALL	HEXOUT2
    4722/    1870 :                     RG5:
    4723/    1870 : 3E 20               	LD	A,' '
    4724/    1872 : CD F9 30            	CALL	CONOUT
    4725/    1875 : C5                  	PUSH	BC		; C: reg size
    4726/    1876 : CD 88 28            	CALL	GETLIN
    4727/    1879 : CD 3B 29            	CALL	SKIPSP
    4728/    187C : CD 4C 29            	CALL	RDHEX
    4729/    187F : B7                  	OR	A
    4730/    1880 : CA 92 18            	JP	Z,RGR		;JR	Z,RGR
    4731/    1883 : C1                  	POP	BC
    4732/    1884 : E1                  	POP	HL
    4733/    1885 : 79                  	LD	A,C
    4734/    1886 : FE 01               	CP	1
    4735/    1888 : C2 8F 18            	JP	NZ,RG6		;JR	NZ,RG6
    4736/    188B :                     	;; 8 bit register
    4737/    188B : 73                  	LD	(HL),E
    4738/    188C : C3 92 18            	JP	RG7		;JR	RG7
    4739/    188F :                     RG6:
    4740/    188F :                     	;; 16 bit register
    4741/    188F : 73                  	LD	(HL),E
    4742/    1890 : 23                  	INC	HL
    4743/    1891 : 72                  	LD	(HL),D
    4744/    1892 :                     RG7:
    4745/    1892 :                     RGR:
    4746/    1892 : C3 CD 00            	JP	WSTART
    4747/    1895 :                     RGE:
    4748/    1895 : C3 18 01            	JP	ERR
    4749/    1898 :                     
    4750/    1898 :                     RDUMP:
    4751/    1898 : 21 94 2E            	LD	HL,RDTAB
    4752/    189B :                     RD0:
    4753/    189B : 5E                  	LD	E,(HL)
    4754/    189C : 23                  	INC	HL
    4755/    189D : 56                  	LD	D,(HL)
    4756/    189E : 23                  	INC	HL
    4757/    189F : 7A                  	LD	A,D
    4758/    18A0 : B3                  	OR	E
    4759/    18A1 : CA 71 28            	JP	Z,CRLF		; End
    4760/    18A4 : D5                  	push	de
    4761/    18A5 : EB                  	EX	DE,HL
    4762/    18A6 : CD 23 28            	CALL	STROUT	; print name of register
    4763/    18A9 : EB                  	EX	DE,HL
    4764/    18AA : D1                  	pop	de
    4765/    18AB :                     
    4766/    18AB :                     ; flag check
    4767/    18AB : 3E 2E               	ld	a, RDSF_H
    4768/    18AD : BA                  	cp	d
    4769/    18AE : C2 BA 18            	jp	nz, rd101	;jr	nz, rd101
    4770/    18B1 : 3E FF               	ld	a, RDSF_L
    4771/    18B3 : BB                  	cp	e
    4772/    18B4 : C2 BA 18            	jp	nz, rd101	;jr	nz, rd101
    4773/    18B7 : C3 E8 18            	jp	rd20		;jr	rd20
    4774/    18BA :                     
    4775/    18BA :                     rd101:
    4776/    18BA : 3E 2F               	ld	a, RDSFX_H
    4777/    18BC : BA                  	cp	d
    4778/    18BD : C2 C6 18            	jp	nz, rd10	;jr	nz, rd10
    4779/    18C0 : 3E 26               	ld	a, RDSFX_L
    4780/    18C2 : BB                  	cp	e
    4781/    18C3 : CA E8 18            	jp	z, rd20		;jr	z, rd20
    4782/    18C6 :                     
    4783/    18C6 :                     rd10:
    4784/    18C6 : 5E                  	LD	E,(HL)
    4785/    18C7 : 23                  	INC	HL
    4786/    18C8 : 56                  	LD	D,(HL)
    4787/    18C9 : 23                  	INC	HL
    4788/    18CA : 7E                  	LD	A,(HL)
    4789/    18CB : 23                  	INC	HL
    4790/    18CC : EB                  	EX	DE,HL
    4791/    18CD : FE 01               	CP	1
    4792/    18CF : C2 DA 18            	JP	NZ,RD1		;JR	NZ,RD1
    4793/    18D2 :                     	;; 1 byte
    4794/    18D2 : 7E                  	LD	A,(HL)
    4795/    18D3 : CD 32 28            	CALL	HEXOUT2
    4796/    18D6 : EB                  	EX	DE,HL
    4797/    18D7 : C3 9B 18            	JP	RD0		;JR	RD0
    4798/    18DA :                     RD1:
    4799/    18DA :                     	;; 2 byte
    4800/    18DA : 23                  	INC	HL
    4801/    18DB : 7E                  	LD	A,(HL)
    4802/    18DC : CD 32 28            	CALL	HEXOUT2		; High byte
    4803/    18DF : 2B                  	DEC	HL
    4804/    18E0 : 7E                  	LD	A,(HL)
    4805/    18E1 : CD 32 28            	CALL	HEXOUT2		; Low byte
    4806/    18E4 : EB                  	EX	DE,HL
    4807/    18E5 : C3 9B 18            	JP	RD0		;JR	RD0
    4808/    18E8 :                     
    4809/    18E8 :                     ; make flag image string
    4810/    18E8 :                     rd20:
    4811/    18E8 : 5E                  	LD	E,(HL)
    4812/    18E9 : 23                  	INC	HL
    4813/    18EA : 56                  	LD	D,(HL)
    4814/    18EB : 23                  	INC	HL
    4815/    18EC : 1A                  	ld	a, (de)		; get flag values
    4816/    18ED :                     
    4817/    18ED : D5                  	push	de
    4818/    18EE : E5                  	push	hl
    4819/    18EF :                     
    4820/    18EF :                     ; make flag image
    4821/    18EF :                     
    4822/    18EF : 21 60 9F            	ld	hl, F_bit
    4823/    18F2 : 01 1F 19            	ld	bc, F_bit_on
    4824/    18F5 : 11 27 19            	ld	de, F_bit_off
    4825/    18F8 : F5                  	push	af		; adjustment SP. DO NOT DELETE THIS LINE!
    4826/    18F9 :                     
    4827/    18F9 :                     flg_loop:
    4828/    18F9 : F1                  	pop	af		; "push af" before loop back
    4829/    18FA : 87                  	ADD	A,A			;Z80 CODE sla	a ##############
    4830/    18FB : D2 05 19            	jp	nc, flg_off	;jr	nc, flg_off
    4831/    18FE : F5                  	push	af
    4832/    18FF : 0A                  	ld	a, (bc)
    4833/    1900 : 77                  	ld	(hl), a
    4834/    1901 : F1                  	pop	af
    4835/    1902 : C3 09 19            	jp	flg_nxt		;jr	flg_nxt
    4836/    1905 :                     flg_off:
    4837/    1905 : F5                  	push	af
    4838/    1906 : 1A                  	ld	a, (de)
    4839/    1907 : 77                  	ld	(hl), a
    4840/    1908 : F1                  	pop	af
    4841/    1909 :                     
    4842/    1909 :                     flg_nxt:
    4843/    1909 : 03                  	inc	bc
    4844/    190A : 13                  	inc	de
    4845/    190B : 23                  	inc	hl
    4846/    190C :                     
    4847/    190C : F5                  	push	af
    4848/    190D : 7E                  	ld	a, (hl)
    4849/    190E : B7                  	or	a		;check delimiter
    4850/    190F : C2 F9 18            	jp	nz, flg_loop	;jr	nz, flg_loop
    4851/    1912 :                     
    4852/    1912 : F1                  	pop	af		; restore stack position
    4853/    1913 : 21 60 9F            	ld	hl, F_bit
    4854/    1916 : CD 23 28            	call	STROUT		; print flag register for bit imaze
    4855/    1919 :                     
    4856/    1919 : E1                  	pop	hl
    4857/    191A : D1                  	pop	de
    4858/    191B :                     
    4859/    191B : 23                  	inc	hl
    4860/    191C : C3 9B 18            	JP	RD0		;JR	RD0
    4861/    191F :                     
    4862/    191F : 53 5A 2E 48 2E 50   F_bit_on:	db	"SZ.H.PNC"
             1925 : 4E 43             
    4863/    1927 : 2E 2E 2E 2E 2E 2E   F_bit_off:	db	"........"
             192D : 2E 2E             
    4864/    192F :                     
    4865/    192F :                     ;--------------------------------------------------
    4866/    192F :                     ;
    4867/    192F :                     ; Minimal assemble
    4868/    192F :                     ;
    4869/    192F :                     ;--------------------------------------------------
    4870/    192F :                     
    4871/    192F : =80H                 dm_bit	equ	80h
    4872/    192F :                     
    4873/    192F :                     ope_cds:
    4874/    192F :                     ; 4 bytes string
    4875/    192F : 49 4E 49 52 B9      	db	"INIR",	dm_bit | 57
    4876/    1934 : 49 4E 44 52 BB      	db	"INDR",	dm_bit | 59
    4877/    1939 : 4F 55 54 49 BD      	db	"OUTI",	dm_bit | 61
    4878/    193E : 4F 54 49 52 BE      	db	"OTIR",	dm_bit | 62
    4879/    1943 : 4F 55 54 44 BF      	db	"OUTD",	dm_bit | 63
    4880/    1948 : 4F 54 44 52 C0      	db	"OTDR",	dm_bit | 64
    4881/    194D : 48 41 4C 54 B3      	db	"HALT",	dm_bit | 51
    4882/    1952 : 52 45 54 49 AF      	db	"RETI",	dm_bit | 47
    4883/    1957 : 52 45 54 4E B0      	db	"RETN",	dm_bit | 48
    4884/    195C : 44 4A 4E 5A AC      	db	"DJNZ",	dm_bit | 44
    4885/    1961 : 43 41 4C 4C AD      	db	"CALL",	dm_bit | 45
    4886/    1966 : 43 50 44 52 A8      	db	"CPDR",	dm_bit | 40
    4887/    196B : 4C 44 49 52 83      	db	"LDIR",	dm_bit | 03
    4888/    1970 : 4C 44 44 52 85      	db	"LDDR",	dm_bit | 05
    4889/    1975 : 50 55 53 48 88      	db	"PUSH",	dm_bit | 08
    4890/    197A : 52 4C 43 41 8A      	db	"RLCA",	dm_bit | 10
    4891/    197F : 52 52 43 41 8E      	db	"RRCA",	dm_bit | 14
    4892/    1984 : 43 50 49 52 A6      	db	"CPIR",	dm_bit | 38
    4893/    1989 :                     
    4894/    1989 :                     ; 3 bytes string
    4895/    1989 : 4C 44 49 82         	db	"LDI",	dm_bit | 02
    4896/    198D : 4C 44 44 84         	db	"LDD",	dm_bit | 04
    4897/    1991 : 45 58 58 87         	db	"EXX",	dm_bit | 07
    4898/    1995 : 50 4F 50 89         	db	"POP",	dm_bit | 09
    4899/    1999 : 52 4C 41 8B         	db	"RLA",	dm_bit | 11
    4900/    199D : 52 4C 43 8C         	db	"RLC",	dm_bit | 12
    4901/    19A1 : 52 52 41 8F         	db	"RRA",	dm_bit | 15
    4902/    19A5 : 52 52 43 90         	db	"RRC",	dm_bit | 16
    4903/    19A9 : 53 4C 41 92         	db	"SLA",	dm_bit | 18
    4904/    19AD : 53 52 41 93         	db	"SRA",	dm_bit | 19
    4905/    19B1 : 53 52 4C 94         	db	"SRL",	dm_bit | 20
    4906/    19B5 : 41 44 44 95         	db	"ADD",	dm_bit | 21
    4907/    19B9 : 41 44 43 96         	db	"ADC",	dm_bit | 22
    4908/    19BD : 49 4E 43 97         	db	"INC",	dm_bit | 23
    4909/    19C1 : 53 55 42 98         	db	"SUB",	dm_bit | 24
    4910/    19C5 : 53 42 43 99         	db	"SBC",	dm_bit | 25
    4911/    19C9 : 44 45 43 9A         	db	"DEC",	dm_bit | 26
    4912/    19CD : 41 4E 44 9B         	db	"AND",	dm_bit | 27
    4913/    19D1 : 58 4F 52 9D         	db	"XOR",	dm_bit | 29
    4914/    19D5 : 43 50 4C 9E         	db	"CPL",	dm_bit | 30
    4915/    19D9 : 4E 45 47 9F         	db	"NEG",	dm_bit | 31
    4916/    19DD : 43 43 46 A0         	db	"CCF",	dm_bit | 32
    4917/    19E1 : 53 43 46 A1         	db	"SCF",	dm_bit | 33
    4918/    19E5 : 42 49 54 A2         	db	"BIT",	dm_bit | 34
    4919/    19E9 : 53 45 54 A3         	db	"SET",	dm_bit | 35
    4920/    19ED : 52 45 53 A4         	db	"RES",	dm_bit | 36
    4921/    19F1 : 43 50 49 A5         	db	"CPI",	dm_bit | 37
    4922/    19F5 : 43 50 44 A7         	db	"CPD",	dm_bit | 39
    4923/    19F9 : 52 45 54 AE         	db	"RET",	dm_bit | 46
    4924/    19FD : 52 53 54 B1         	db	"RST",	dm_bit | 49
    4925/    1A01 : 4E 4F 50 B2         	db	"NOP",	dm_bit | 50
    4926/    1A05 : 49 4E 49 B8         	db	"INI",	dm_bit | 56
    4927/    1A09 : 49 4E 44 BA         	db	"IND",	dm_bit | 58
    4928/    1A0D : 4F 55 54 BC         	db	"OUT",	dm_bit | 60
    4929/    1A11 : 44 41 41 C1         	db	"DAA",	dm_bit | 65
    4930/    1A15 : 52 4C 44 C2         	db	"RLD",	dm_bit | 66
    4931/    1A19 : 52 52 44 C3         	db	"RRD",	dm_bit | 67
    4932/    1A1D : 4F 52 47 C4         	db	"ORG",	dm_bit | 68
    4933/    1A21 :                     
    4934/    1A21 :                     ; 2 bytes string
    4935/    1A21 : 45 58 86            	db	"EX",	dm_bit | 06
    4936/    1A24 : 52 4C 8D            	db	"RL",	dm_bit | 13
    4937/    1A27 : 52 52 91            	db	"RR",	dm_bit | 17
    4938/    1A2A : 4F 52 9C            	db	"OR",	dm_bit | 28
    4939/    1A2D : 43 50 A9            	db	"CP",	dm_bit | 41
    4940/    1A30 : 4A 50 AA            	db	"JP",	dm_bit | 42
    4941/    1A33 : 4A 52 AB            	db	"JR",	dm_bit | 43
    4942/    1A36 : 49 4D B6            	db	"IM",	dm_bit | 54
    4943/    1A39 : 49 4E B7            	db	"IN",	dm_bit | 55
    4944/    1A3C : 44 49 B4            	db	"DI",	dm_bit | 52
    4945/    1A3F : 45 49 B5            	db	"EI",	dm_bit | 53
    4946/    1A42 : 4C 44 81            	db	"LD",	dm_bit | 01
    4947/    1A45 : 44 42 C5            	db	"DB",	dm_bit | 69
    4948/    1A48 : 44 57 C6            	db	"DW",	dm_bit | 70
    4949/    1A4B : 00                  	db	0	; delimiter
    4950/    1A4C :                     
    4951/    1A4C :                     operand_cds:
    4952/    1A4C :                     ; 4 bytes string
    4953/    1A4C : 28 42 43 29 9A      	db	"(BC)",	dm_bit | 26
    4954/    1A51 : 28 44 45 29 9B      	db	"(DE)",	dm_bit | 27
    4955/    1A56 : 28 48 4C 29 9C      	db	"(HL)",	dm_bit | 28
    4956/    1A5B : 28 49 58 29 9D      	db	"(IX)",	dm_bit | 29
    4957/    1A60 : 28 49 59 29 9E      	db	"(IY)",	dm_bit | 30
    4958/    1A65 : 28 53 50 29 A0      	db	"(SP)",	dm_bit | 32
    4959/    1A6A :                     
    4960/    1A6A :                     ; 3 bytes string
    4961/    1A6A : 28 43 29 9F         	db	"(C)",	dm_bit | 31
    4962/    1A6E : 41 46 27 83         	db	"AF'",	dm_bit | 3
    4963/    1A72 :                     
    4964/    1A72 :                     ; 2 bytes string
    4965/    1A72 : 41 46 82            	db	"AF",	dm_bit | 2
    4966/    1A75 : 42 43 85            	db	"BC",	dm_bit | 5
    4967/    1A78 : 44 45 88            	db	"DE",	dm_bit | 8
    4968/    1A7B : 48 4C 8B            	db	"HL",	dm_bit | 11
    4969/    1A7E : 49 58 8E            	db	"IX",	dm_bit | 14
    4970/    1A81 : 49 59 8F            	db	"IY",	dm_bit | 15
    4971/    1A84 : 53 50 90            	db	"SP",	dm_bit | 16
    4972/    1A87 : 4E 5A 94            	db	"NZ",	dm_bit | 20
    4973/    1A8A : 4E 43 95            	db	"NC",	dm_bit | 21
    4974/    1A8D : 50 4F 97            	db	"PO",	dm_bit | 23
    4975/    1A90 : 50 45 98            	db	"PE",	dm_bit | 24
    4976/    1A93 :                     
    4977/    1A93 :                     ; 1 bytes string
    4978/    1A93 : 41 81               	db	"A",  	dm_bit | 1
    4979/    1A95 : 42 84               	db	"B",	dm_bit | 4
    4980/    1A97 : 43 86               	db	"C",	dm_bit | 6
    4981/    1A99 : 44 87               	db	"D",	dm_bit | 7
    4982/    1A9B : 45 89               	db	"E",	dm_bit | 9
    4983/    1A9D : 48 8A               	db	"H",	dm_bit | 10
    4984/    1A9F : 4C 8C               	db	"L",	dm_bit | 12
    4985/    1AA1 : 49 8D               	db	"I",	dm_bit | 13
    4986/    1AA3 : 52 91               	db	"R",	dm_bit | 17
    4987/    1AA5 : 5A 92               	db	"Z",	dm_bit | 18
    4988/    1AA7 : 4D 93               	db	"M",	dm_bit | 19
    4989/    1AA9 : 50 96               	db	"P",	dm_bit | 22
    4990/    1AAB : 00                  	db	0	; delimiter
    4991/    1AAC :                     
    4992/    1AAC :                     opr_cd1:
    4993/    1AAC : 28 49 58 2B A1      	db	"(IX+",	dm_bit | 33
    4994/    1AB1 : 28 49 59 2B A2      	db	"(IY+",	dm_bit | 34
    4995/    1AB6 : 28 49 58 2D A4      	db	"(IX-",	dm_bit | 36
    4996/    1ABB : 28 49 59 2D A5      	db	"(IY-",	dm_bit | 37
    4997/    1AC0 : 00                  	db	0	; delimiter
    4998/    1AC1 :                     
    4999/    1AC1 :                     ;----------------------------------------------
    5000/    1AC1 :                     ; A[<address>] : input line assemble mode
    5001/    1AC1 :                     ; A[.]<cr> : exit assemble mode
    5002/    1AC1 :                     ;----------------------------------------------
    5003/    1AC1 :                     line_asm:
    5004/    1AC1 : 23                  	inc	hl
    5005/    1AC2 : CD 5D 27            	call	skp_sp
    5006/    1AC5 : B7                  	or	a
    5007/    1AC6 : CA DB 1A            	jp	z, skpa_adr	;jr	z, skpa_adr
    5008/    1AC9 : CD 4C 29            	call	RDHEX		; get DE: address
    5009/    1ACC : DA 18 01            	jp	c, ERR
    5010/    1ACF : EB                  	ex	de,hl		;####	ld	(asm_adr), de	; set start address
    5011/    1AD0 : 22 4B 9F            	ld	(asm_adr),hl	;##########################
    5012/    1AD3 : EB                  	ex	de,hl		;##########################
    5013/    1AD4 : CD 5D 27            	call	skp_sp
    5014/    1AD7 : B7                  	or	a
    5015/    1AD8 : C2 18 01            	jp	nz, ERR
    5016/    1ADB :                     	
    5017/    1ADB :                     	; init work area
    5018/    1ADB :                     skpa_adr:
    5019/    1ADB : 2A 4B 9F            	ld	hl, (asm_adr)
    5020/    1ADE : 22 4D 9F            	ld	(tasm_adr), hl
    5021/    1AE1 :                     	
    5022/    1AE1 :                     	; print address
    5023/    1AE1 :                     
    5024/    1AE1 :                     next_asm:
    5025/    1AE1 : AF                  	xor	a
    5026/    1AE2 : 32 4F 9F            	ld	(element_cnt), a
    5027/    1AE5 : 32 51 9F            	ld	(opc_cd), a
    5028/    1AE8 : 32 52 9F            	ld	(opr1_cd), a
    5029/    1AEB : 32 53 9F            	ld	(opr2_cd), a
    5030/    1AEE :                     
    5031/    1AEE : 2A 4D 9F            	ld	hl, (tasm_adr)
    5032/    1AF1 : CD 2D 28            	call	HEXOUT4
    5033/    1AF4 : 21 76 2E            	ld	hl, dsap
    5034/    1AF7 : CD 23 28            	call	STROUT
    5035/    1AFA :                     
    5036/    1AFA :                     ;-----------------------------
    5037/    1AFA :                     ; get a line from console
    5038/    1AFA :                     ;-----------------------------
    5039/    1AFA : 21 69 9F            	ld	hl, ky_flg
    5040/    1AFD : F5                  	push	af			;z80 code ##############
    5041/    1AFE : 7E                  	ld	a,(hl)			;set	NO_LF>>1, (hl) ;set 1,(hl)
    5042/    1AFF : F6 02               	or	NO_LF			;#######################
    5043/    1B01 : 77                  	ld	(hl),a			;#######################
    5044/    1B02 : F1                  	pop	af			;#######################
    5045/    1B03 :                     
    5046/    1B03 : CD 88 28            	call	GETLIN
    5047/    1B06 :                     
    5048/    1B06 : E5                  	push	hl
    5049/    1B07 : 21 69 9F            	ld	hl, ky_flg
    5050/    1B0A : F5                  	push	af			;z80 code ##########
    5051/    1B0B : 7E                  	ld	a,(hl)			;###	res	NO_LF>>1, (hl)
    5052/    1B0C : E6 FD               	and	11111101b		;###################
    5053/    1B0E : 77                  	ld	(hl),a			;###################
    5054/    1B0F : F1                  	pop	af			;#######################
    5055/    1B10 : E1                  	pop	hl
    5056/    1B11 :                     
    5057/    1B11 : CD B9 27            	call	recorrect
    5058/    1B14 : 7E                  	ld	a, (hl)
    5059/    1B15 : FE 1B               	cp	ESC
    5060/    1B17 : CA 29 1B            	jp	z, ext_asm	;jr	z, ext_asm
    5061/    1B1A : FE 2E               	cp	'.'
    5062/    1B1C : CA 29 1B            	jp	z, ext_asm	;jr	z, ext_asm
    5063/    1B1F : B7                  	or	a		; NULL?
    5064/    1B20 : C2 C0 1B            	jp	nz, cont_asm
    5065/    1B23 : CD 35 1B            	call	lf_out
    5066/    1B26 : C3 E1 1A            	jp	next_asm	;jr	next_asm
    5067/    1B29 :                     
    5068/    1B29 :                     ext_asm:
    5069/    1B29 : CD 35 1B            	call	lf_out
    5070/    1B2C : 2A 4D 9F            	ld	hl, (tasm_adr)
    5071/    1B2F : 22 4B 9F            	ld	(asm_adr), hl	; save new address
    5072/    1B32 : C3 CD 00            	jp	WSTART		; exit assemble mode
    5073/    1B35 :                     
    5074/    1B35 :                     lf_out:
    5075/    1B35 : 3E 0A               	ld	a, LF
    5076/    1B37 : C3 F9 30            	jp	CONOUT
    5077/    1B3A :                     
    5078/    1B3A :                     asm_err:
    5079/    1B3A : 21 FA 13            	ld	hl, com_errm
    5080/    1B3D :                     asm_err1:
    5081/    1B3D : CD 35 1B            	call	lf_out
    5082/    1B40 : CD 23 28            	call	STROUT
    5083/    1B43 : 21 67 2E            	ld	hl, ERRMSG
    5084/    1B46 : CD 23 28            	call	STROUT
    5085/    1B49 : C3 E1 1A            	jp	next_asm	;jr	next_asm
    5086/    1B4C :                     
    5087/    1B4C :                     ;-------------------------------------------------
    5088/    1B4C :                     ; post operation
    5089/    1B4C :                     ;-------------------------------------------------
    5090/    1B4C :                     cout_sp:
    5091/    1B4C : 3A 51 9F            	ld	a, (opc_cd)
    5092/    1B4F : FE 44               	cp	68
    5093/    1B51 : CA 8E 1B            	jp	z, skp_outm	;jr	z, skp_outm
    5094/    1B54 : FE 45               	cp	69
    5095/    1B56 : CA 94 1B            	jp	z, dmp_db	;jr	z, dmp_db
    5096/    1B59 : FE 46               	cp	70
    5097/    1B5B : CA A0 1B            	jp	z, dmp_dw	;jr	z, dmp_dw
    5098/    1B5E :                     
    5099/    1B5E : 3E 20               	ld	a, ' '
    5100/    1B60 : 0E 26               	ld	c, BUFLEN-2	; clear
    5101/    1B62 : 21 74 9F            	ld	hl, line_buf	; disassemble string buffer
    5102/    1B65 :                     cout_sp1:
    5103/    1B65 : 77                  	ld	(hl), a
    5104/    1B66 : 23                  	inc	hl
    5105/    1B67 : 0D                  	dec	c
    5106/    1B68 : C2 65 1B            	jp	nz, cout_sp1	;jr	nz, cout_sp1
    5107/    1B6B : 3E 0D               	ld	a, CR
    5108/    1B6D : 77                  	ld	(hl), a
    5109/    1B6E : 23                  	inc	hl
    5110/    1B6F : AF                  	xor	a
    5111/    1B70 : 77                  	ld	(hl), a		; set delimitor
    5112/    1B71 : CD 23 28            	call	STROUT
    5113/    1B74 :                     
    5114/    1B74 : 2A 4D 9F            	ld	hl, (tasm_adr)	; disassemble address
    5115/    1B77 : 11 74 9F            	ld	de, line_buf	; disassemble string buffer
    5116/    1B7A : D5                  	push	de
    5117/    1B7B : CD 17 09            	call	get_disasm_st
    5118/    1B7E : E1                  	pop	hl
    5119/    1B7F : CD 23 28            	call	STROUT		; cousole out result inline assemble
    5120/    1B82 :                     cout_sp2:
    5121/    1B82 : 2A 4D 9F            	ld	hl, (tasm_adr)	; disassemble address
    5122/    1B85 : CD B8 1B            	call	setbytec
    5123/    1B88 : 22 4D 9F            	ld	(tasm_adr), hl	; next address
    5124/    1B8B : C3 E1 1A            	jp	next_asm
    5125/    1B8E :                     
    5126/    1B8E :                     skp_outm:
    5127/    1B8E : CD 35 1B            	call	lf_out
    5128/    1B91 : C3 82 1B            	jp	cout_sp2	;jr	cout_sp2
    5129/    1B94 :                     
    5130/    1B94 :                     dmp_db:
    5131/    1B94 : CD AE 1B            	call	setdsadr
    5132/    1B97 : CD B8 1B            	call	setbytec
    5133/    1B9A : 22 02 9F            	ld	(deaddr), hl
    5134/    1B9D : C3 A8 1B            	jp	prtdmp		;jr	prtdmp
    5135/    1BA0 :                     
    5136/    1BA0 :                     dmp_dw:
    5137/    1BA0 : CD AE 1B            	call	setdsadr
    5138/    1BA3 : 23                  	inc	hl
    5139/    1BA4 : 23                  	inc	hl
    5140/    1BA5 : 22 02 9F            	ld	(deaddr), hl
    5141/    1BA8 :                     prtdmp:	
    5142/    1BA8 : CD C4 07            	call	dpm
    5143/    1BAB : C3 82 1B            	jp	cout_sp2	;jr	cout_sp2
    5144/    1BAE :                     
    5145/    1BAE :                     setdsadr:
    5146/    1BAE : CD 35 1B            	call	lf_out
    5147/    1BB1 : 2A 4D 9F            	ld	hl, (tasm_adr)
    5148/    1BB4 : 22 00 9F            	ld	(dsaddr), hl
    5149/    1BB7 : C9                  	ret
    5150/    1BB8 :                     
    5151/    1BB8 :                     setbytec:
    5152/    1BB8 : 3A 50 9F            	ld	a, (byte_count)
    5153/    1BBB : 4F                  	ld	c, a
    5154/    1BBC : AF                  	xor	a
    5155/    1BBD : 47                  	ld	b, a
    5156/    1BBE : 09                  	add	hl, bc
    5157/    1BBF : C9                  	ret
    5158/    1BC0 :                     
    5159/    1BC0 :                     ;----------------------------
    5160/    1BC0 :                     ; analize input data
    5161/    1BC0 :                     ;----------------------------
    5162/    1BC0 :                     cont_asm:
    5163/    1BC0 : CD EC 25            	call	analize_input
    5164/    1BC3 : DA 3A 1B            	jp	c, asm_err		;error
    5165/    1BC6 :                     
    5166/    1BC6 :                     ; make machine code
    5167/    1BC6 :                     
    5168/    1BC6 : 3A 4F 9F            	ld	a, (element_cnt)
    5169/    1BC9 : FE 01               	cp	1
    5170/    1BCB : CA 3A 22            	jp	z, mk_e1
    5171/    1BCE : FE 02               	cp	2
    5172/    1BD0 : CA C7 22            	jp	z, mk_e2
    5173/    1BD3 :                     
    5174/    1BD3 :                     ;333333333333333333333333333333333333333
    5175/    1BD3 :                     ;
    5176/    1BD3 :                     ; make machine code,
    5177/    1BD3 :                     ; element_cnt = 3 (ex. LD SP, HL)
    5178/    1BD3 :                     ;
    5179/    1BD3 :                     ;333333333333333333333333333333333333333
    5180/    1BD3 :                     
    5181/    1BD3 : =0DH                 el3_um	equ	el3_stbe - el3_stb
    5182/    1BD3 :                     
    5183/    1BD3 : 3A 51 9F            mk_e3:	ld	a, (opc_cd)
    5184/    1BD6 : 01 0D 00            	ld	bc, el3_um
    5185/    1BD9 : 21 EC 1B            	ld	hl, el3_stb
    5186/    1BDC : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    5187/    1BDF : C2 3A 1B            	jp	nz, asm_err
    5188/    1BE2 :                     
    5189/    1BE2 : 21 F9 1B            	ld	hl, el3_jtb
    5190/    1BE5 :                     
    5191/    1BE5 :                     jp_each:
    5192/    1BE5 : 09                  	add	hl, bc		; offset : BC = BC * 2
    5193/    1BE6 : 09                  	add	hl, bc		; HL = ent_el2 + offset
    5194/    1BE7 : 4E                  	ld	c, (hl)
    5195/    1BE8 : 23                  	inc	hl
    5196/    1BE9 : 46                  	ld	b, (hl)
    5197/    1BEA : C5                  	push	bc
    5198/    1BEB : C9                  	ret
    5199/    1BEC :                     
    5200/    1BEC : 01                  el3_stb:	db	1			; normal, DD, FD, ED
    5201/    1BED : 06 15               		db	6, 21 			; normal, DD, FD
    5202/    1BEF : 16 19               		db	22, 25			; normal, DD, FD, ED
    5203/    1BF1 : 2B                  		db	43 			; normal
    5204/    1BF2 : 37 3C               		db	55, 60			; normal, ED
    5205/    1BF4 : 2A 2D               		db	42, 45			; normal
    5206/    1BF6 : 22 24 23            		db	34, 36, 35 		; CB, DD, FD
    5207/    1BF9 :                     el3_stbe:	
    5208/    1BF9 :                     
    5209/    1BF9 : 23 1C               el3_jtb:	dw	el3_35
    5210/    1BFB : 42 1C               		dw	el3_36
    5211/    1BFD : 61 1C               		dw	el3_34
    5212/    1BFF : F1 1C               		dw	el3_45
    5213/    1C01 : FF 1C               		dw	el3_42
    5214/    1C03 : 20 1D               		dw	el3_60
    5215/    1C05 : 2D 1D               		dw	el3_55
    5216/    1C07 : 71 1D               		dw	el3_43
    5217/    1C09 : A9 1D               		dw	el3_25
    5218/    1C0B : BD 1D               		dw	el3_22
    5219/    1C0D : 5A 1E               		dw	el3_21
    5220/    1C0F : F5 1E               		dw	el3_6
    5221/    1C11 : 85 1F               		dw	el3_1
    5222/    1C13 :                     
    5223/    1C13 :                     
    5224/    1C13 :                     ;
    5225/    1C13 :                     ; SET section
    5226/    1C13 :                     ;
    5227/    1C13 :                     ; r_hl_nn:	db	1, 4, 6, 7, 9, 10, 12, 28
    5228/    1C13 :                     
    5229/    1C13 : C0 C8 D0 D8 E0 E8   set_mcb:	db	0C0h, 0C8h, 0D0h, 0D8h, 0E0h, 0E8h, 0F0h, 0F8h
             1C19 : F0 F8             
    5230/    1C1B : C6 CE D6 DE E6 EE   set_xyt:	db	0C6h, 0CEh, 0D6h, 0DEh, 0E6h, 0EEh, 0F6h, 0FEh
             1C21 : F6 FE             
    5231/    1C23 :                     
    5232/    1C23 :                     el3_35: ; SET  ( CB, DD, FD )
    5233/    1C23 :                     
    5234/    1C23 : 21 13 1C            	ld	hl, set_mcb
    5235/    1C26 : 22 5C 9F            	ld	(cb_mcw), hl
    5236/    1C29 : 21 1B 1C            	ld	hl, set_xyt
    5237/    1C2C : 22 5E 9F            	ld	(cb_xyw), hl
    5238/    1C2F : C3 6D 1C            	jp	bit_res_set	;jr	bit_res_set
    5239/    1C32 :                     
    5240/    1C32 :                     ;
    5241/    1C32 :                     ; RES section
    5242/    1C32 :                     ;
    5243/    1C32 :                     ; r_hl_nn:	db	1, 4, 6, 7, 9, 10, 12, 28
    5244/    1C32 :                     
    5245/    1C32 : 80 88 90 98 A0 A8   res_mcb:	db	80h, 88h, 90h, 98h, 0A0h, 0A8h, 0B0h, 0B8h
             1C38 : B0 B8             
    5246/    1C3A : 86 8E 96 9E A6 AE   res_xyt:	db	86h, 8Eh, 96h, 9Eh, 0A6h, 0AEh, 0B6h, 0BEh
             1C40 : B6 BE             
    5247/    1C42 :                     
    5248/    1C42 :                     el3_36: ; RES  ( CB, DD, FD )
    5249/    1C42 :                     
    5250/    1C42 : 21 32 1C            	ld	hl, res_mcb
    5251/    1C45 : 22 5C 9F            	ld	(cb_mcw), hl
    5252/    1C48 : 21 3A 1C            	ld	hl, res_xyt
    5253/    1C4B : 22 5E 9F            	ld	(cb_xyw), hl
    5254/    1C4E : C3 6D 1C            	jp	bit_res_set	;jr	bit_res_set
    5255/    1C51 :                     
    5256/    1C51 :                     ;
    5257/    1C51 :                     ; BIT section
    5258/    1C51 :                     ;
    5259/    1C51 :                     ; r_hl_nn:	db	1, 4, 6, 7, 9, 10, 12, 28
    5260/    1C51 :                     
    5261/    1C51 : =8H                  bit_mcbn	equ	bit_mcbe - bit_mcb
    5262/    1C51 : 40 48 50 58 60 68   bit_mcb:	db	40h, 48h, 50h, 58h, 60h, 68h, 70h, 78h
             1C57 : 70 78             
    5263/    1C59 :                     bit_mcbe:
    5264/    1C59 : 46 4E 56 5E 66 6E   bit_xyt:	db	46h, 4Eh, 56h, 5Eh, 66h, 6Eh, 76h, 7Eh
             1C5F : 76 7E             
    5265/    1C61 :                     
    5266/    1C61 :                     
    5267/    1C61 :                     el3_34: ; BIT  ( CB, DD, FD )
    5268/    1C61 :                     
    5269/    1C61 : 21 51 1C            	ld	hl, bit_mcb
    5270/    1C64 : 22 5C 9F            	ld	(cb_mcw), hl
    5271/    1C67 : 21 59 1C            	ld	hl, bit_xyt
    5272/    1C6A : 22 5E 9F            	ld	(cb_xyw), hl
    5273/    1C6D :                     
    5274/    1C6D :                     bit_res_set:
    5275/    1C6D : 3A 52 9F            	ld	a, (opr1_cd)
    5276/    1C70 : FE 19               	cp	25
    5277/    1C72 : C2 3A 1B            	jp	nz, asm_err
    5278/    1C75 :                     
    5279/    1C75 : 2A 54 9F            	ld	hl, (opr_num25)
    5280/    1C78 : 7C                  	ld	a, h
    5281/    1C79 : B7                  	or	a
    5282/    1C7A : C2 3A 1B            	jp	nz, asm_err
    5283/    1C7D : 7D                  	ld	a, l
    5284/    1C7E : FE 08               	cp	8
    5285/    1C80 : D2 3A 1B            	jp	nc, asm_err
    5286/    1C83 :                     
    5287/    1C83 :                     	; HL : 0 - 7
    5288/    1C83 :                     
    5289/    1C83 : 3A 53 9F            	ld	a, (opr2_cd)
    5290/    1C86 : FE 21               	cp	33
    5291/    1C88 : CA BF 1C            	jp	z, bit_ixp	;jr	z, bit_ixp
    5292/    1C8B : FE 24               	cp	36
    5293/    1C8D : CA D4 1C            	jp	z, bit_ixm	;jr	z, bit_ixm
    5294/    1C90 : FE 22               	cp	34
    5295/    1C92 : CA DA 1C            	jp	z, bit_iyp	;jr	z, bit_iyp
    5296/    1C95 : FE 25               	cp	37
    5297/    1C97 : CA E3 1C            	jp	z, bit_iym	;jr	z, bit_iym
    5298/    1C9A :                     ;
    5299/    1C9A :                     ; CB : bit n, [r | (hl)]
    5300/    1C9A :                     ;
    5301/    1C9A : D5                  	push	de			;added #########################
    5302/    1C9B : EB                  	ex	de,hl			;z80 code ld	bc, (cb_mcw)####
    5303/    1C9C : 2A 5C 9F            	ld	hl,(cb_mcw)		;###############################
    5304/    1C9F : EB                  	ex	de,hl			;###############################
    5305/    1CA0 : 19                  	add	hl,de			;add	hl,bc ##################
    5306/    1CA1 : D1                  	pop	de			;###############################
    5307/    1CA2 : 56                  	ld	d, (hl)		; get MC base
    5308/    1CA3 :                     
    5309/    1CA3 : 3A 53 9F            	ld	a, (opr2_cd)
    5310/    1CA6 : 21 58 1F            	ld	hl, r_hl_nn
    5311/    1CA9 : 01 08 00            	ld	bc, bit_mcbn
    5312/    1CAC : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    5313/    1CAF : C2 3A 1B            	jp	nz, asm_err
    5314/    1CB2 :                     
    5315/    1CB2 : 79                  	ld	a, c
    5316/    1CB3 : FE 07               	cp	7
    5317/    1CB5 : CA BB 1C            	jp	z, el3_341	;jr	z, el3_341
    5318/    1CB8 :                     
    5319/    1CB8 : 3E 06               	ld	a, 6
    5320/    1CBA : 91                  	sub	c
    5321/    1CBB :                     el3_341:
    5322/    1CBB : 82                  	add	a, d		; make 2nd MC
    5323/    1CBC : C3 94 25            	jp	el2_130
    5324/    1CBF :                     
    5325/    1CBF :                     	; HL : 0 - 7
    5326/    1CBF :                     
    5327/    1CBF :                     bit_ixp:
    5328/    1CBF : 3A 5B 9F            	ld	a, (opr_num33)
    5329/    1CC2 :                     bit_ixp1:
    5330/    1CC2 : 5F                  	ld	e, a
    5331/    1CC3 : 16 DD               	ld	d, 0DDh
    5332/    1CC5 :                     
    5333/    1CC5 :                     ; adjust I/F
    5334/    1CC5 :                     ; d: 1st MC, a: 2nd MC, c: 3rd MC, e: 4th MC
    5335/    1CC5 :                     
    5336/    1CC5 :                     el3_342:
    5337/    1CC5 : D5                  	push	de			;added #########################
    5338/    1CC6 : EB                  	ex	de,hl			;z80 code ld	bc, (cb_xyw)####
    5339/    1CC7 : 2A 5E 9F            	ld	hl,(cb_xyw)		;###############################
    5340/    1CCA : EB                  	ex	de,hl			;###############################
    5341/    1CCB : 19                  	add	hl,de			;add	hl,bc ##################
    5342/    1CCC : D1                  	pop	de			;###############################
    5343/    1CCD : 4B                  	ld	c, e		; adjust I/F
    5344/    1CCE : 5E                  	ld	e, (hl)		; 4th MC
    5345/    1CCF : 3E CB               	ld	a, 0CBh
    5346/    1CD1 : C3 B9 25            	jp	mc_end41	; save 4byte MC
    5347/    1CD4 :                     
    5348/    1CD4 :                     bit_ixm:
    5349/    1CD4 : 3A 5A 9F            	ld	a, (opr_num36)
    5350/    1CD7 : C3 C2 1C            	jp	bit_ixp1	;jr	bit_ixp1
    5351/    1CDA :                     
    5352/    1CDA :                     bit_iyp:
    5353/    1CDA : 3A 59 9F            	ld	a, (opr_num34)
    5354/    1CDD :                     bit_iyp1:
    5355/    1CDD : 5F                  	ld	e, a
    5356/    1CDE : 16 FD               	ld	d, 0FDh
    5357/    1CE0 : C3 C5 1C            	jp	el3_342		;jr	el3_342
    5358/    1CE3 :                     
    5359/    1CE3 :                     bit_iym:
    5360/    1CE3 : 3A 58 9F            	ld	a, (opr_num37)
    5361/    1CE6 : C3 DD 1C            	jp	bit_iyp1	;jr	bit_iyp1
    5362/    1CE9 :                     
    5363/    1CE9 :                     ;
    5364/    1CE9 :                     ; CALL section
    5365/    1CE9 :                     ; ret_no:	db	6, 18, 19, 20, 21, 22, 23, 24
    5366/    1CE9 :                     ;
    5367/    1CE9 : EC E4 F4 D4 C4 FC   call_mc1t:	db	0ECh, 0E4h, 0F4h, 0D4h, 0C4h, 0FCh, 0CCh, 0DCh
             1CEF : CC DC             
    5368/    1CF1 :                     
    5369/    1CF1 :                     el3_45: ; CALL ( normal )
    5370/    1CF1 :                     
    5371/    1CF1 : 11 E9 1C            	ld	de, call_mc1t
    5372/    1CF4 : C3 02 1D            	jp	el3_421		;jr	el3_421
    5373/    1CF7 :                     ;
    5374/    1CF7 :                     ; JP section
    5375/    1CF7 :                     ; ret_no:	db	6, 18, 19, 20, 21, 22, 23, 24
    5376/    1CF7 :                     ;
    5377/    1CF7 : =8H                  jp_mc1tm	equ	jp_mc1te - jp_mc1t
    5378/    1CF7 : EA E2 F2 D2 C2 FA   jp_mc1t:	db	0EAh, 0E2h, 0F2h, 0D2h, 0C2h, 0FAh, 0CAh, 0DAh
             1CFD : CA DA             
    5379/    1CFF :                     jp_mc1te:
    5380/    1CFF :                     
    5381/    1CFF :                     el3_42: ; JP   ( normal )
    5382/    1CFF :                     
    5383/    1CFF : 11 F7 1C            	ld	de, jp_mc1t
    5384/    1D02 :                     
    5385/    1D02 :                     el3_421:
    5386/    1D02 : 21 EB 23            	ld	hl, ret_no
    5387/    1D05 : 01 08 00            	ld	bc, jp_mc1tm
    5388/    1D08 : 3A 52 9F            	ld	a, (opr1_cd)
    5389/    1D0B : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    5390/    1D0E : C2 3A 1B            	jp	nz, asm_err
    5391/    1D11 :                     
    5392/    1D11 : 3A 53 9F            	ld	a, (opr2_cd)
    5393/    1D14 : FE 19               	cp	25
    5394/    1D16 : C2 3A 1B            	jp	nz, asm_err
    5395/    1D19 :                     
    5396/    1D19 : 62                  	ld	h, d		; DE : MC target table
    5397/    1D1A : 6B                  	ld	l, e		; DE : MC target table
    5398/    1D1B : 09                  	add	hl, bc
    5399/    1D1C : 7E                  	ld	a, (hl)		; get 1st MC
    5400/    1D1D : C3 6A 23            	jp	el2_451
    5401/    1D20 :                     
    5402/    1D20 :                     ;
    5403/    1D20 :                     ; OUT section
    5404/    1D20 :                     ;
    5405/    1D20 : =6H                  in_selm		equ	ld_e2_tbl1 - in_selt
    5406/    1D20 :                     
    5407/    1D20 :                     el3_60: ; OUT  ( normal, ED )
    5408/    1D20 :                     
    5409/    1D20 : EB                  	ex	de,hl			;z80 code ld bc, (opr1_cd) ; c = (opr1_cd), b = (opr2_cd)
    5410/    1D21 : 2A 52 9F            	ld	hl,(opr1_cd)		;###############################
    5411/    1D24 : EB                  	ex	de,hl			;###############################
    5412/    1D25 : 42                  	ld	b,d
    5413/    1D26 : 4B                  	ld	c,e
    5414/    1D27 : 11 D3 41            	ld	de, 41D3H
    5415/    1D2A : C3 38 1D            	jp	el3_550		;jr	el3_550
    5416/    1D2D :                     
    5417/    1D2D :                     ;
    5418/    1D2D :                     ; IN section
    5419/    1D2D :                     ;
    5420/    1D2D :                     el3_55: ; IN   ( normal, ED )
    5421/    1D2D :                     
    5422/    1D2D : 11 DB 40            	ld	de, 40DBH
    5423/    1D30 : 3A 52 9F            	ld	a, (opr1_cd)
    5424/    1D33 : 47                  	ld	b, a
    5425/    1D34 : 3A 53 9F            	ld	a, (opr2_cd)
    5426/    1D37 : 4F                  	ld	c, a
    5427/    1D38 :                     
    5428/    1D38 :                     el3_550:
    5429/    1D38 : 79                  	ld	a, c
    5430/    1D39 : FE 23               	cp	35
    5431/    1D3B : CA 5F 1D            	jp	z, in_a_nn	;jr	z, in_a_nn
    5432/    1D3E : FE 1F               	cp	31
    5433/    1D40 : C2 3A 1B            	jp	nz, asm_err
    5434/    1D43 :                     
    5435/    1D43 : 78                  	ld	a, b
    5436/    1D44 : FE 01               	cp	1
    5437/    1D46 : CA 59 1D            	jp	z, el3_551	;jr	z, el3_551	; passing search
    5438/    1D49 :                     	
    5439/    1D49 : 21 42 1F            	ld	hl, in_selt
    5440/    1D4C : 01 06 00            	ld	bc, in_selm
    5441/    1D4F : CD 95 1D            	call	mkmc_sh
    5442/    1D52 : DA 3A 1B            	jp	c, asm_err
    5443/    1D55 : 7A                  	ld	a, d
    5444/    1D56 : C3 5C 1D            	jp	el3_552		;jr	el3_552
    5445/    1D59 :                     	
    5446/    1D59 :                     el3_551:
    5447/    1D59 : 7A                  	ld	a, d
    5448/    1D5A : C6 38               	add	a, 38h		; get 2nd MC
    5449/    1D5C :                     el3_552:
    5450/    1D5C : C3 E6 25            	jp	el2_5411
    5451/    1D5F :                     
    5452/    1D5F :                     in_a_nn:
    5453/    1D5F : 2A 56 9F            	ld	hl, (opr_num35)
    5454/    1D62 : 7C                  	ld	a, h
    5455/    1D63 : B7                  	or	a
    5456/    1D64 : C2 3A 1B            	jp	nz, asm_err
    5457/    1D67 : 7D                  	ld	a, l
    5458/    1D68 : F5                  	push	af		; adjust I/F
    5459/    1D69 : 7B                  	ld	a, e		; 1st MC
    5460/    1D6A : C3 92 1D            	jp	el3_431		;jr	el3_431		; save 2byte MC (el2_441)
    5461/    1D6D :                     
    5462/    1D6D :                     ;
    5463/    1D6D :                     ; JR section
    5464/    1D6D :                     ;
    5465/    1D6D : 14 12 15 06         jr_cct:	db	20, 18, 21, 6
    5466/    1D71 :                     
    5467/    1D71 :                     el3_43: ; JR   ( normal )
    5468/    1D71 :                     
    5469/    1D71 : 21 6D 1D            	ld	hl, jr_cct
    5470/    1D74 : 01 04 00            	ld	bc, 4
    5471/    1D77 : 16 20               	ld	d, 20h		; base MC
    5472/    1D79 : 3A 52 9F            	ld	a, (opr1_cd)
    5473/    1D7C : CD 95 1D            	call	mkmc_sh
    5474/    1D7F : DA 3A 1B            	jp	c, asm_err
    5475/    1D82 :                     
    5476/    1D82 : 3A 53 9F            	ld	a, (opr2_cd)
    5477/    1D85 : FE 19               	cp	25		; number?
    5478/    1D87 : C2 3A 1B            	jp	nz, asm_err
    5479/    1D8A :                     
    5480/    1D8A : CD 83 27            	call	calc_reladr
    5481/    1D8D : DA 3A 1B            	jp	c, asm_err
    5482/    1D90 :                     	
    5483/    1D90 : F5                  	push	af		; adjust I/F
    5484/    1D91 : 7A                  	ld	a, d		; adjust I/F
    5485/    1D92 :                     el3_431:
    5486/    1D92 : C3 8D 23            	jp	el2_441		; save 2byte MC
    5487/    1D95 :                     ;
    5488/    1D95 :                     ; hl : search table
    5489/    1D95 :                     ; bc : loop counter
    5490/    1D95 :                     ; d  : base MC 
    5491/    1D95 :                     ;
    5492/    1D95 :                     ; output:
    5493/    1D95 :                     ;	  CF=1 : error
    5494/    1D95 :                     ;	  CF=0 : D = MC
    5495/    1D95 :                     mkmc_sh:
    5496/    1D95 : BE                  	cp	(hl)		;Z80 code cpi #############
    5497/    1D96 : 23                  	inc	hl		;##########################
    5498/    1D97 : 0B                  	dec	bc		;##########################
    5499/    1D98 : CA A8 1D            	jp	z, mkmc_shed	;jr	z, mkmc_shed
    5500/    1D9B :                     
    5501/    1D9B : 5F                  	ld	e, a	; save a
    5502/    1D9C : 7A                  	ld	a, d
    5503/    1D9D : C6 08               	add	a, 8
    5504/    1D9F : 57                  	ld	d, a
    5505/    1DA0 :                     
    5506/    1DA0 : 79                  	ld	a, c
    5507/    1DA1 : B0                  	or	b
    5508/    1DA2 : 7B                  	ld	a, e	; restore a
    5509/    1DA3 : C2 95 1D            	jp	nz, mkmc_sh	;jr	nz, mkmc_sh
    5510/    1DA6 : 37                  	scf
    5511/    1DA7 : C9                  	ret
    5512/    1DA8 :                     
    5513/    1DA8 :                     mkmc_shed:
    5514/    1DA8 : C9                  	ret
    5515/    1DA9 :                     
    5516/    1DA9 :                     ;
    5517/    1DA9 :                     ; ADC section
    5518/    1DA9 :                     ;
    5519/    1DA9 :                     
    5520/    1DA9 :                     el3_25: ; SBC  ( normal, DD, FD, ED )
    5521/    1DA9 :                     
    5522/    1DA9 : 11 9F 42            	ld	de, 429fh
    5523/    1DAC : 3E DE               	ld	a, 0DEh
    5524/    1DAE : E5                  	PUSH	HL			;#### ADDED ####################
    5525/    1DAF : F5                  	PUSH	AF			;Z80 CODE EX	AF,AF' #########
    5526/    1DB0 : 2A 9E 9F            	LD	HL,(alt_AF)		;###############################
    5527/    1DB3 : E5                  	PUSH	HL			;###############################
    5528/    1DB4 : F1                  	POP	AF			;###############################
    5529/    1DB5 : E1                  	POP	HL			;###############################
    5530/    1DB6 : 22 9E 9F            	LD	(alt_AF),HL		;###############################
    5531/    1DB9 : E1                  	POP	HL			;###############################
    5532/    1DBA : C3 CE 1D            	jp	el3_221		;jr	el3_221
    5533/    1DBD :                     ;
    5534/    1DBD :                     ; ADC section
    5535/    1DBD :                     ;
    5536/    1DBD :                     ; defined other section
    5537/    1DBD :                     ; r_hl_nn:	db	1, 4, 6, 7, 9, 10, 12, 28
    5538/    1DBD :                     ; ld_rr_:	db	25
    5539/    1DBD :                     ; ex_sr_:	db	33, 36, 34, 37
    5540/    1DBD :                     ; r_hl_nne:
    5541/    1DBD :                     
    5542/    1DBD : =9H                  adc_MC	equ	ex_sr_ - r_hl_nn
    5543/    1DBD : =4H                  adc_3MC	equ	r_hl_nne - ex_sr_
    5544/    1DBD :                     
    5545/    1DBD :                     el3_22: ; ADC  ( normal, DD, FD, ED )
    5546/    1DBD :                     
    5547/    1DBD : 11 8F 4A            	ld	de, 4a8fh
    5548/    1DC0 : 3E CE               	ld	a, 0CEh
    5549/    1DC2 : E5                  	PUSH	HL			;#### ADDED ####################
    5550/    1DC3 : F5                  	PUSH	AF			;Z80 CODE EX	AF,AF' #########
    5551/    1DC4 : 2A 9E 9F            	LD	HL,(alt_AF)		;###############################
    5552/    1DC7 : E5                  	PUSH	HL			;###############################
    5553/    1DC8 : F1                  	POP	AF			;###############################
    5554/    1DC9 : E1                  	POP	HL			;###############################
    5555/    1DCA : 22 9E 9F            	LD	(alt_AF),HL		;###############################
    5556/    1DCD : E1                  	POP	HL			;###############################
    5557/    1DCE :                     
    5558/    1DCE :                     el3_221:
    5559/    1DCE : 3A 52 9F            	ld	a, (opr1_cd)
    5560/    1DD1 : FE 01               	cp	1		; A?
    5561/    1DD3 : CA 06 1E            	jp	z, adc_a_	;jr	z, adc_a_
    5562/    1DD6 : FE 0B               	cp	11		; HL?
    5563/    1DD8 : C2 3A 1B            	jp	nz, asm_err
    5564/    1DDB :                     
    5565/    1DDB :                     ; adc hl,[ BC | DE | HL | SP ]
    5566/    1DDB :                     
    5567/    1DDB : 3A 53 9F            	ld	a, (opr2_cd)
    5568/    1DDE : FE 05               	cp	5
    5569/    1DE0 : CA 01 1E            	jp	z, adc_hl_bc	;jr	z, adc_hl_bc
    5570/    1DE3 : FE 08               	cp	8
    5571/    1DE5 : CA FC 1D            	jp	z, adc_hl_de	;jr	z, adc_hl_de
    5572/    1DE8 : FE 0B               	cp	11
    5573/    1DEA : CA F7 1D            	jp	z, adc_hl_hl	;jr	z, adc_hl_hl
    5574/    1DED : FE 10               	cp	16
    5575/    1DEF : C2 3A 1B            	jp	nz, asm_err
    5576/    1DF2 :                     
    5577/    1DF2 :                     adc_hl_sp:
    5578/    1DF2 : 3E 30               	ld	a, 30h
    5579/    1DF4 : C3 02 1E            	jp	adc_hl_		;jr	adc_hl_
    5580/    1DF7 :                     adc_hl_hl:
    5581/    1DF7 : 3E 20               	ld	a, 20h
    5582/    1DF9 : C3 02 1E            	jp	adc_hl_		;jr	adc_hl_
    5583/    1DFC :                     adc_hl_de:
    5584/    1DFC : 3E 10               	ld	a, 10h
    5585/    1DFE : C3 02 1E            	jp	adc_hl_		;jr	adc_hl_
    5586/    1E01 :                     adc_hl_bc:
    5587/    1E01 : AF                  	xor	a
    5588/    1E02 :                     adc_hl_:
    5589/    1E02 : 82                  	add	a, d		; make 2nd MC
    5590/    1E03 :                     
    5591/    1E03 : C3 E6 25            	jp	el2_5411
    5592/    1E06 :                     
    5593/    1E06 :                     adc_a_:
    5594/    1E06 : 3A 53 9F            	ld	a, (opr2_cd)
    5595/    1E09 : 21 58 1F            	ld	hl, r_hl_nn
    5596/    1E0C : 01 09 00            	ld	bc, adc_MC
    5597/    1E0F : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    5598/    1E12 : C2 3B 1E            	jp	nz, chk_adc3mc	;jr	nz, chk_adc3mc
    5599/    1E15 :                     
    5600/    1E15 : 79                  	ld	a, c
    5601/    1E16 : FE 08               	cp	8
    5602/    1E18 : CA 37 1E            	jp	z, adc_a_a	;jr	z, adc_a_a
    5603/    1E1B : B7                  	or	a
    5604/    1E1C : CA 24 1E            	jp	z, adc_a_n	;jr	z, adc_a_n
    5605/    1E1F : 7B                  	ld	a, e
    5606/    1E20 : 91                  	sub	c		; make MC 1
    5607/    1E21 :                     adc_a_x:
    5608/    1E21 : C3 4E 22            	jp	st_mc11
    5609/    1E24 :                     	
    5610/    1E24 :                     adc_a_n:
    5611/    1E24 : 2A 54 9F            	ld	hl, (opr_num25)
    5612/    1E27 : E5                  	PUSH	HL			;#### ADDED ####################
    5613/    1E28 : F5                  	PUSH	AF			;Z80 CODE EX	AF,AF' #########get 1st MC'
    5614/    1E29 : 2A 9E 9F            	LD	HL,(alt_AF)		;###############################
    5615/    1E2C : E5                  	PUSH	HL			;###############################
    5616/    1E2D : F1                  	POP	AF			;###############################
    5617/    1E2E : E1                  	POP	HL			;###############################
    5618/    1E2F : 22 9E 9F            	LD	(alt_AF),HL		;###############################
    5619/    1E32 : E1                  	POP	HL			;###############################
    5620/    1E33 : 57                  	ld	d, a		; adjust I/F
    5621/    1E34 : C3 20 20            	jp	ld_r251
    5622/    1E37 :                     
    5623/    1E37 :                     adc_a_a:
    5624/    1E37 :                     ;	inc	e
    5625/    1E37 : 7B                  	ld	a, e
    5626/    1E38 : C3 21 1E            	jp	adc_a_x		;jr	adc_a_x
    5627/    1E3B :                     
    5628/    1E3B :                     chk_adc3mc:
    5629/    1E3B : 21 61 1F            	ld	hl, ex_sr_
    5630/    1E3E : 01 04 00            	ld	bc, adc_3MC
    5631/    1E41 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    5632/    1E44 : C2 3A 1B            	jp	nz, asm_err
    5633/    1E47 :                     
    5634/    1E47 : 21 58 9F            	ld	hl, opr_num37
    5635/    1E4A : 09                  	add	hl, bc
    5636/    1E4B : 56                  	ld	d, (hl)		; 3rd MC
    5637/    1E4C :                     
    5638/    1E4C : 79                  	ld	a, c
    5639/    1E4D : 0E FD               	ld	c, 0FDH		; 1st MC
    5640/    1E4F : FE 02               	cp	2
    5641/    1E51 : DA 56 1E            	jp	c, adc_fd	;jr	c, adc_fd
    5642/    1E54 :                     
    5643/    1E54 : 0E DD               	ld	c, 0DDH		; 1st MC
    5644/    1E56 :                     
    5645/    1E56 :                     adc_fd:
    5646/    1E56 : 1D                  	dec	e		; get 2nd MC
    5647/    1E57 : C3 6A 20            	jp	ld_bc_n42	; save 3MC
    5648/    1E5A :                     ;
    5649/    1E5A :                     ; ADD section
    5650/    1E5A :                     ;
    5651/    1E5A :                     el3_21: ; ADD  ( normal, DD, FD )
    5652/    1E5A :                     
    5653/    1E5A : 11 87 09            	ld	de, 0987h
    5654/    1E5D : 3E C6               	ld	a, 0C6h
    5655/    1E5F : E5                  	PUSH	HL			;#### ADDED ####################
    5656/    1E60 : F5                  	PUSH	AF			;Z80 CODE EX	AF,AF' #########
    5657/    1E61 : 2A 9E 9F            	LD	HL,(alt_AF)		;###############################
    5658/    1E64 : E5                  	PUSH	HL			;###############################
    5659/    1E65 : F1                  	POP	AF			;###############################
    5660/    1E66 : E1                  	POP	HL			;###############################
    5661/    1E67 : 22 9E 9F            	LD	(alt_AF),HL		;###############################
    5662/    1E6A : E1                  	POP	HL			;###############################
    5663/    1E6B :                     
    5664/    1E6B : 3A 53 9F            	ld	a, (opr2_cd)
    5665/    1E6E : 47                  	ld	b, a
    5666/    1E6F : 3A 52 9F            	ld	a, (opr1_cd)
    5667/    1E72 : FE 01               	cp	1
    5668/    1E74 : CA 06 1E            	jp	z, adc_a_	;jr	z, adc_a_
    5669/    1E77 : FE 0B               	cp	11
    5670/    1E79 : CA CC 1E            	jp	z, add_hl_	;jr	z, add_hl_
    5671/    1E7C : FE 0E               	cp	14
    5672/    1E7E : CA 8B 1E            	jp	z, add_ix_	;jr	z, add_ix_
    5673/    1E81 : FE 0F               	cp	15
    5674/    1E83 : C2 3A 1B            	jp	nz, asm_err
    5675/    1E86 :                     ;;
    5676/    1E86 :                     ;;
    5677/    1E86 :                     add_iy_:
    5678/    1E86 : 0E FD               	ld	c, 0FDh
    5679/    1E88 : C3 8D 1E            	jp	el3_211		;jr	el3_211
    5680/    1E8B :                     ;;
    5681/    1E8B :                     ;;
    5682/    1E8B :                     add_ix_:
    5683/    1E8B : 0E DD               	ld	c, 0DDh
    5684/    1E8D :                     el3_211:
    5685/    1E8D : 78                  	ld	a, b
    5686/    1E8E : FE 05               	cp	5
    5687/    1E90 : CA AE 1E            	jp	z, add_xy_bc	;jr	z, add_xy_bc
    5688/    1E93 : FE 08               	cp	8
    5689/    1E95 : CA B3 1E            	jp	z, add_xy_de	;jr	z, add_xy_de
    5690/    1E98 : FE 0E               	cp	14
    5691/    1E9A : CA B8 1E            	jp	z, add_ix_ix	;jr	z, add_ix_ix
    5692/    1E9D : FE 0F               	cp	15
    5693/    1E9F : CA C3 1E            	jp	z, add_iy_iy
    5694/    1EA2 : FE 10               	cp	16
    5695/    1EA4 : C2 3A 1B            	jp	nz, asm_err
    5696/    1EA7 :                     add_xy_sp:
    5697/    1EA7 : 3E 39               	ld	a, 39h
    5698/    1EA9 :                     el3_212:
    5699/    1EA9 : F5                  	push	af		; adjust I/F
    5700/    1EAA : 79                  	ld	a, c
    5701/    1EAB : C3 8D 23            	jp	el2_441
    5702/    1EAE :                     
    5703/    1EAE :                     add_xy_bc:
    5704/    1EAE : 3E 09               	ld	a, 9h
    5705/    1EB0 : C3 A9 1E            	jp	el3_212		;jr	el3_212
    5706/    1EB3 :                     add_xy_de:
    5707/    1EB3 : 3E 19               	ld	a, 19h
    5708/    1EB5 : C3 A9 1E            	jp	el3_212		;jr	el3_212
    5709/    1EB8 :                     add_ix_ix:
    5710/    1EB8 : 79                  	ld	a, c
    5711/    1EB9 : FE DD               	cp	0ddh
    5712/    1EBB : C2 3A 1B            	jp	nz, asm_err
    5713/    1EBE :                     add_xy_xy:
    5714/    1EBE : 3E 29               	ld	a, 29h
    5715/    1EC0 : C3 A9 1E            	jp	el3_212		;jr	el3_212
    5716/    1EC3 :                     add_iy_iy:
    5717/    1EC3 : 79                  	ld	a, c
    5718/    1EC4 : FE FD               	cp	0fdh
    5719/    1EC6 : C2 3A 1B            	jp	nz, asm_err
    5720/    1EC9 : C3 BE 1E            	jp	add_xy_xy	;jr	add_xy_xy
    5721/    1ECC :                     
    5722/    1ECC :                     ;;
    5723/    1ECC :                     ;;
    5724/    1ECC :                     add_hl_:
    5725/    1ECC : 78                  	ld	a, b
    5726/    1ECD : FE 05               	cp	5
    5727/    1ECF : CA E6 1E            	jp	z, add_hl_bc	;jr	z, add_hl_bc
    5728/    1ED2 : FE 08               	cp	8
    5729/    1ED4 : CA EB 1E            	jp	z, add_hl_de	;jr	z, add_hl_de
    5730/    1ED7 : FE 0B               	cp	11
    5731/    1ED9 : CA F0 1E            	jp	z, add_hl_hl	;jr	z, add_hl_hl
    5732/    1EDC : FE 10               	cp	16
    5733/    1EDE : C2 3A 1B            	jp	nz, asm_err
    5734/    1EE1 :                     add_hl_sp:
    5735/    1EE1 : 3E 39               	ld	a, 39h
    5736/    1EE3 : C3 21 1E            	jp	adc_a_x
    5737/    1EE6 :                     add_hl_bc:
    5738/    1EE6 : 3E 09               	ld	a, 09h
    5739/    1EE8 : C3 21 1E            	jp	adc_a_x
    5740/    1EEB :                     add_hl_de:
    5741/    1EEB : 3E 19               	ld	a, 19h
    5742/    1EED : C3 21 1E            	jp	adc_a_x
    5743/    1EF0 :                     add_hl_hl:
    5744/    1EF0 : 3E 29               	ld	a, 29h
    5745/    1EF2 : C3 21 1E            	jp	adc_a_x
    5746/    1EF5 :                     
    5747/    1EF5 :                     ;
    5748/    1EF5 :                     ; EX section
    5749/    1EF5 :                     ;
    5750/    1EF5 :                     
    5751/    1EF5 :                     el3_6:  ; EX   ( normal, DD, FD )
    5752/    1EF5 :                     
    5753/    1EF5 : 3A 53 9F            	ld	a, (opr2_cd)
    5754/    1EF8 : 47                  	ld	b, a
    5755/    1EF9 : 3A 52 9F            	ld	a, (opr1_cd)
    5756/    1EFC : FE 02               	cp	2
    5757/    1EFE : CA 2B 1F            	jp	z, ex_af_	;jr	z, ex_af_
    5758/    1F01 : FE 08               	cp	8
    5759/    1F03 : CA 36 1F            	jp	z, ex_de_	;jr	z, ex_de_
    5760/    1F06 : FE 20               	cp	32
    5761/    1F08 : C2 3A 1B            	jp	nz, asm_err
    5762/    1F0B :                     
    5763/    1F0B :                     ; ex (sp),
    5764/    1F0B : 78                  	ld	a, b
    5765/    1F0C : 1E E3               	ld	e, 0E3h
    5766/    1F0E :                     
    5767/    1F0E : FE 0B               	cp	11		; hl
    5768/    1F10 : CA 27 1F            	jp	z, ex_sp_hl	;jr	z, ex_sp_hl
    5769/    1F13 : FE 0E               	cp	14
    5770/    1F15 : 16 DD               	ld	d, 0ddh
    5771/    1F17 : CA 21 1F            	jp	z, ex_sp_ix	;jr	z, ex_sp_ix
    5772/    1F1A : FE 0F               	cp	15
    5773/    1F1C : C2 3A 1B            	jp	nz, asm_err
    5774/    1F1F : 16 FD               	ld	d, 0fdh
    5775/    1F21 :                     ex_sp_ix:
    5776/    1F21 : 7B                  	ld	a, e
    5777/    1F22 : F5                  	push	af		; adjust I/F
    5778/    1F23 : 7A                  	ld	a, d
    5779/    1F24 : C3 8D 23            	jp	el2_441
    5780/    1F27 :                     
    5781/    1F27 :                     ex_sp_hl:
    5782/    1F27 : 7B                  	ld	a, e
    5783/    1F28 : C3 3E 1F            	jp	el3_61		;jr	el3_61
    5784/    1F2B :                     
    5785/    1F2B :                     ex_af_:
    5786/    1F2B : 78                  	ld	a, b
    5787/    1F2C : FE 03               	cp	3
    5788/    1F2E : C2 3A 1B            	jp	nz, asm_err
    5789/    1F31 : 3E 08               	ld	a, 08h		; 1st MC
    5790/    1F33 : C3 3E 1F            	jp	el3_61		;jr	el3_61
    5791/    1F36 :                     
    5792/    1F36 :                     ex_de_:
    5793/    1F36 : 78                  	ld	a, b
    5794/    1F37 : FE 0B               	cp	11		; hl
    5795/    1F39 : C2 3A 1B            	jp	nz, asm_err
    5796/    1F3C : 3E EB               	ld	a, 0ebh		; 1st MC
    5797/    1F3E :                     el3_61:
    5798/    1F3E : C3 4E 22            	jp	st_mc11
    5799/    1F41 :                     
    5800/    1F41 :                     ;
    5801/    1F41 :                     ; LD section
    5802/    1F41 :                     ;
    5803/    1F41 :                     
    5804/    1F41 :                     ; ld_en1 = 7 (1, 4, 6, 7, 9, 10, 12)
    5805/    1F41 :                     ; ld_en2 = 5 (5, 8, 11, 14, 15)
    5806/    1F41 :                     ; ld_en3 = 4 (33, 36, 34, 37 )
    5807/    1F41 :                     ; ld_en4 =  7 (13, 16, 17, 26, 27, 28, 35)
    5808/    1F41 : =7H                  ld_en1		equ	ld_e2_tbl1 - ld_e2_tbl
    5809/    1F41 : =5H                  ld_en2		equ	ld_e2_tbl2 - ld_e2_tbl1
    5810/    1F41 : =4H                  ld_en3		equ	ld_e2_tbl3 - ld_e2_tbl2
    5811/    1F41 : =7H                  ld_en4		equ	ld_e2_tble - ld_e2_tbl3
    5812/    1F41 :                     
    5813/    1F41 : 01                  ld_e2_tbl:	db	1
    5814/    1F42 : 04 06 07 09 0A 0C   in_selt:	db	4, 6, 7, 9, 10, 12
    5815/    1F48 : 05 08 0B 0E 0F      ld_e2_tbl1:	db	5, 8, 11, 14, 15
    5816/    1F4D : 21 24 22 25         ld_e2_tbl2:	db	33, 36, 34, 37
    5817/    1F51 : 0D                  ld_e2_tbl3:	db	13
    5818/    1F52 : 10                  		db	16
    5819/    1F53 : 11                  		db	17
    5820/    1F54 : 1A                  		db	26
    5821/    1F55 : 1B                  		db	27
    5822/    1F56 : 1C                  		db	28
    5823/    1F57 : 23                  		db	35
    5824/    1F58 :                     ld_e2_tble:
    5825/    1F58 :                     
    5826/    1F58 : =0DH                 rhlnnxy		equ	r_hl_nne - r_hl_nn
    5827/    1F58 : =8H                  ld_rrn		equ	ld_rr_ -  r_hl_nn
    5828/    1F58 : =0AH                 ld_rxyn_sp	equ	lda_spe - ld_rr_
    5829/    1F58 :                     
    5830/    1F58 : =5H                  m_num		equ	r_hl_nne - ld_rr_	; except No.0 - 4  (IX+,IY+,IX-,IY-,nn)
    5831/    1F58 :                     
    5832/    1F58 : 01 04 06 07 09 0A   r_hl_nn:	db	1, 4, 6, 7, 9, 10, 12, 28
             1F5E : 0C 1C             
    5833/    1F60 : 19                  ld_rr_:		db	25
    5834/    1F61 : 21 24 22 25         ex_sr_:		db	33, 36, 34, 37
    5835/    1F65 :                     r_hl_nne:
    5836/    1F65 : 1A                  lda_sp:		db	26 ; LD A (BC)
    5837/    1F66 : 1B                  		db	27 ; LD A (DE)
    5838/    1F67 : 0D                  		db	13 ; LD A I
    5839/    1F68 : 11                  		db	17 ; LD A R
    5840/    1F69 : 23                  		db	35 ; LD A (1234H)
    5841/    1F6A :                     lda_spe:
    5842/    1F6A :                     
    5843/    1F6A : 68                  ld1_base:	db	68h	; L
    5844/    1F6B : 60                  		db	60h	; H
    5845/    1F6C : 58                  		db	58h	; E
    5846/    1F6D : 50                  		db	50h	; D
    5847/    1F6E : 48                  		db	48h	; C
    5848/    1F6F : 40                  		db	40h	; B
    5849/    1F70 : 78                  		db	78h	; A
    5850/    1F71 :                     
    5851/    1F71 : D3 1F               ld_r_jt:	dw	ld_r35 ; LD A (1234H)
    5852/    1F73 : E5 1F               		dw	ld_r17 ; LD A R
    5853/    1F75 : EA 1F               		dw	ld_r13 ; LD A I
    5854/    1F77 : EF 1F               		dw	ld_r27 ; LD A (DE)
    5855/    1F79 : F4 1F               		dw	ld_r26 ; LD A (BC)
    5856/    1F7B : F9 1F               		dw	ld_r37
    5857/    1F7D : 07 20               		dw	ld_r34
    5858/    1F7F : 0D 20               		dw	ld_r36
    5859/    1F81 : 16 20               		dw	ld_r33
    5860/    1F83 : 1C 20               		dw	ld_r25
    5861/    1F85 :                     
    5862/    1F85 :                     ; LD XXXX, XXXX
    5863/    1F85 :                     el3_1:
    5864/    1F85 : 3A 52 9F            	ld	a, (opr1_cd)
    5865/    1F88 : 21 41 1F            	ld	hl, ld_e2_tbl
    5866/    1F8B : 01 07 00            	ld	bc, ld_en1
    5867/    1F8E : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    5868/    1F91 : C2 2E 20            	jp	nz, el3_11
    5869/    1F94 :                     	
    5870/    1F94 : 21 6A 1F            	ld	hl, ld1_base
    5871/    1F97 : 09                  	add	hl, bc
    5872/    1F98 : 56                  	ld	d, (hl)		; met MC base code
    5873/    1F99 :                     
    5874/    1F99 : 3A 53 9F            	ld	a, (opr2_cd)
    5875/    1F9C : 21 58 1F            	ld	hl, r_hl_nn
    5876/    1F9F : 01 08 00            	ld	bc, ld_rrn
    5877/    1FA2 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    5878/    1FA5 : C2 B5 1F            	jp	nz, el3_125	;jr	nz, el3_125
    5879/    1FA8 :                     	
    5880/    1FA8 : 79                  	ld	a, c
    5881/    1FA9 : FE 07               	cp	7		; A param?
    5882/    1FAB : CA B1 1F            	jp	z, el3_12	;jr	z, el3_12
    5883/    1FAE : 3E 06               	ld	a, 6
    5884/    1FB0 : 91                  	sub	c		; make B, C, D, E, H, L, (HL) param
    5885/    1FB1 :                     el3_12:
    5886/    1FB1 : B2                  	or	d		; make MC
    5887/    1FB2 : C3 4E 22            	jp	st_mc11	
    5888/    1FB5 :                     
    5889/    1FB5 :                     
    5890/    1FB5 :                     el3_125:
    5891/    1FB5 : 21 60 1F            	ld	hl, ld_rr_
    5892/    1FB8 : 01 0A 00            	ld	bc, ld_rxyn_sp
    5893/    1FBB : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    5894/    1FBE : C2 3A 1B            	jp	nz, asm_err
    5895/    1FC1 :                     
    5896/    1FC1 : 79                  	ld	a, c
    5897/    1FC2 : FE 05               	cp	5		; check LD A, special
    5898/    1FC4 : D2 CD 1F            	jp	nc, el3_126	;jr	nc, el3_126
    5899/    1FC7 :                     
    5900/    1FC7 : 7A                  	ld	a, d
    5901/    1FC8 : FE 78               	cp	78h		; LD A ?
    5902/    1FCA : C2 3A 1B            	jp	nz, asm_err	; err, if B, C, D, E, H, L, (HL)
    5903/    1FCD :                     
    5904/    1FCD :                     el3_126:
    5905/    1FCD : 21 71 1F            	ld	hl, ld_r_jt
    5906/    1FD0 : C3 E5 1B            	jp	jp_each
    5907/    1FD3 :                     
    5908/    1FD3 :                     ld_r35: ; LD A,(1234H)
    5909/    1FD3 : 3E 3A               	ld	a, 3ah		; 1st MC
    5910/    1FD5 :                     
    5911/    1FD5 : 2A 4D 9F            	ld	hl, (tasm_adr)
    5912/    1FD8 : 77                  	ld	(hl), a
    5913/    1FD9 : 23                  	inc	hl
    5914/    1FDA : EB                  	ex	de,hl			;Z80 code ld	de, (opr_num35)####
    5915/    1FDB : 2A 56 9F            	ld	hl,(opr_num35)		;##################################
    5916/    1FDE : EB                  	ex	de,hl			;##################################
    5917/    1FDF : 73                  	ld	(hl), e
    5918/    1FE0 : 23                  	inc	hl
    5919/    1FE1 : 72                  	ld	(hl), d
    5920/    1FE2 : C3 77 23            	jp	mc_end3
    5921/    1FE5 :                     
    5922/    1FE5 :                     ld_r17: ; LD A,R
    5923/    1FE5 : 3E 5F               	ld	a, 5fh
    5924/    1FE7 :                     ld_r171:
    5925/    1FE7 : C3 E6 25            	jp	el2_5411
    5926/    1FEA :                     	
    5927/    1FEA :                     ld_r13: ; LD A,I
    5928/    1FEA : 3E 57               	ld	a, 57h
    5929/    1FEC : C3 E7 1F            	jp	ld_r171		;jr	ld_r171
    5930/    1FEF :                     
    5931/    1FEF :                     ld_r27: ; LD A,(DE)
    5932/    1FEF : 3E 1A               	ld	a, 1ah
    5933/    1FF1 : C3 4E 22            	jp	st_mc11
    5934/    1FF4 :                     	
    5935/    1FF4 :                     ld_r26: ; LD A,(BC)
    5936/    1FF4 : 3E 0A               	ld	a, 0ah
    5937/    1FF6 : C3 4E 22            	jp	st_mc11
    5938/    1FF9 :                     
    5939/    1FF9 :                     ld_r37:	; LD r,(IY-nn)
    5940/    1FF9 : 3A 58 9F            	ld	a, (opr_num37)
    5941/    1FFC :                     ld_r371:
    5942/    1FFC : 4F                  	ld	c, a
    5943/    1FFD : 1E FD               	ld	e, 0FDH
    5944/    1FFF :                     ld_r372:
    5945/    1FFF : 3E 06               	ld	a, 6
    5946/    2001 : B2                  	or	d		; make 2nd MC
    5947/    2002 : 57                  	ld	d, a		; adjust I/F
    5948/    2003 : 7B                  	ld	a, e		; adjust I/F
    5949/    2004 : C3 8F 24            	jp	cp_xy1
    5950/    2007 :                     
    5951/    2007 :                     ld_r34: ; LD r,(IY+nn)
    5952/    2007 : 3A 59 9F            	ld	a, (opr_num34)
    5953/    200A : C3 FC 1F            	jp	ld_r371		;jr	ld_r371
    5954/    200D :                     
    5955/    200D :                     ld_r36: ; LD r,(IX-nn)
    5956/    200D : 3A 5A 9F            	ld	a, (opr_num36)
    5957/    2010 :                     ld_r361:
    5958/    2010 : 4F                  	ld	c, a
    5959/    2011 : 1E DD               	ld	e, 0DDH
    5960/    2013 : C3 FF 1F            	jp	ld_r372		;jr	ld_r372
    5961/    2016 :                     
    5962/    2016 :                     ld_r33: ; LD r,(IX+nn)
    5963/    2016 : 3A 5B 9F            	ld	a, (opr_num33)
    5964/    2019 : C3 10 20            	jp	ld_r361		;jr	ld_r361
    5965/    201C :                     
    5966/    201C :                     ld_r25: ; LD r, nn
    5967/    201C : 7A                  	ld	a, d		; get 1st MC base
    5968/    201D : D6 3A               	sub	3ah		; get 1st MC
    5969/    201F : 57                  	ld	d, a
    5970/    2020 :                     
    5971/    2020 :                     ld_r251:
    5972/    2020 : 2A 54 9F            	ld	hl, (opr_num25)
    5973/    2023 : 7C                  	ld	a, h
    5974/    2024 : B7                  	or	a
    5975/    2025 : C2 3A 1B            	jp	nz, asm_err
    5976/    2028 : 7D                  	ld	a, l
    5977/    2029 : F5                  	push	af		; adjust I/F
    5978/    202A : 7A                  	ld	a, d		; adjust I/F
    5979/    202B : C3 8D 23            	jp	el2_441
    5980/    202E :                     
    5981/    202E :                     ;
    5982/    202E :                     ; LD rp16, nnnn
    5983/    202E :                     ; LD rp16, (nnnn)
    5984/    202E :                     ; rp16 : BC, DE, HL, IX, IY
    5985/    202E :                     ; ld_e2_tbl1:	db	5, 8, 11, 14, 15
    5986/    202E :                     
    5987/    202E :                     el3_11:
    5988/    202E :                     ;	hl = ld_e2_tbl1
    5989/    202E : 01 05 00            	ld	bc, ld_en2
    5990/    2031 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    5991/    2034 : C2 B7 20            	jp	nz, el3_1_2	;jr	nz, el3_1_2
    5992/    2037 : 79                  	ld	a, c
    5993/    2038 : B7                  	or	a
    5994/    2039 : CA B2 20            	jp	z, ld_iy_n4	;jr	z, ld_iy_n4
    5995/    203C : FE 01               	cp	1
    5996/    203E : CA 97 20            	jp	z, ld_ix_n4	;jr	z, ld_ix_n4
    5997/    2041 : FE 02               	cp	2
    5998/    2043 : CA 7E 20            	jp	z, ld_hl_n4	;jr	z, ld_hl_n4
    5999/    2046 : FE 03               	cp	3
    6000/    2048 : CA 75 20            	jp	z, ld_de_n4	;jr	z, ld_de_n4
    6001/    204B :                     
    6002/    204B :                     
    6003/    204B :                     ; LD BC, nnnn; LD BC, (nnnn)
    6004/    204B :                     ld_bc_n4:
    6005/    204B : 16 ED               	ld	d, 0EDH		; 1st MC
    6006/    204D : 1E 4B               	ld	e, 4bh		; 2nd MC
    6007/    204F : 0E 01               	ld	c, 1		; 1st MC
    6008/    2051 :                     
    6009/    2051 :                     ld_bc_n40:
    6010/    2051 : 3A 53 9F            	ld	a, (opr2_cd)
    6011/    2054 : FE 19               	cp	25
    6012/    2056 : CA 63 20            	jp	z, ld_bc_n41	;jr	z, ld_bc_n41
    6013/    2059 :                     
    6014/    2059 : 7B                  	ld	a, e		; 2nd MC
    6015/    205A : 21 56 9F            	ld	hl, opr_num35
    6016/    205D : 4E                  	ld	c, (hl)		; 3rd MC
    6017/    205E : 23                  	inc	hl
    6018/    205F : 5E                  	ld	e, (hl)		; 4th MC
    6019/    2060 : C3 B9 25            	jp	mc_end41
    6020/    2063 :                     
    6021/    2063 :                     ld_bc_n41:
    6022/    2063 : 21 54 9F            	ld	hl, opr_num25
    6023/    2066 : 5E                  	ld	e, (hl)		; 2rd MC
    6024/    2067 : 23                  	inc	hl
    6025/    2068 : 56                  	ld	d, (hl)		; 3rd MC
    6026/    2069 : 79                  	ld	a, c		; 1st MC
    6027/    206A :                     
    6028/    206A :                     ld_bc_n42:
    6029/    206A : 2A 4D 9F            	ld	hl, (tasm_adr)
    6030/    206D : 71                  	ld	(hl), c		; save 1st MC
    6031/    206E : 23                  	inc	hl
    6032/    206F : 73                  	ld	(hl), e
    6033/    2070 : 23                  	inc	hl
    6034/    2071 : 72                  	ld	(hl), d
    6035/    2072 : C3 77 23            	jp	mc_end3
    6036/    2075 :                     	
    6037/    2075 :                     ; LD DE, nnnn; LD DE, (nnnn)
    6038/    2075 :                     ld_de_n4:
    6039/    2075 : 16 ED               	ld	d, 0EDH		; 1st MC
    6040/    2077 : 1E 5B               	ld	e, 5bh		; 2nd MC
    6041/    2079 : 0E 11               	ld	c, 11h		; 1st MC
    6042/    207B : C3 51 20            	jp	ld_bc_n40	;jr	ld_bc_n40
    6043/    207E :                     
    6044/    207E :                     ; LD HL, nnnn; LD HL, (nnnn)
    6045/    207E :                     ld_hl_n4:
    6046/    207E : 0E 21               	ld	c, 21h
    6047/    2080 : EB                  	ex	de,hl			;Z80 code ld	de, (opr_num25)####
    6048/    2081 : 2A 54 9F            	ld	hl,(opr_num25)		;##################################
    6049/    2084 : EB                  	ex	de,hl			;##################################
    6050/    2085 : 3A 53 9F            	ld	a, (opr2_cd)
    6051/    2088 : FE 19               	cp	25
    6052/    208A : CA 6A 20            	jp	z, ld_bc_n42	;jr	z, ld_bc_n42
    6053/    208D : 0E 2A               	ld	c, 2Ah
    6054/    208F : EB                  	ex	de,hl			;Z80 code ld	de, (opr_num35)####
    6055/    2090 : 2A 56 9F            	ld	hl,(opr_num35)		;##################################
    6056/    2093 : EB                  	ex	de,hl			;##################################
    6057/    2094 : C3 6A 20            	jp	ld_bc_n42	;jr	ld_bc_n42
    6058/    2097 :                     
    6059/    2097 :                     ; LD IX, nnnn; LD IX, (nnnn)
    6060/    2097 :                     ld_ix_n4:
    6061/    2097 : 16 DD               	ld	d, 0DDh		; 1st MC
    6062/    2099 :                     
    6063/    2099 :                     ld_ix_n40:
    6064/    2099 : 0E 21               	ld	c, 21h
    6065/    209B : 21 54 9F            	ld	hl, opr_num25
    6066/    209E :                     
    6067/    209E : 3A 53 9F            	ld	a, (opr2_cd)
    6068/    20A1 : FE 19               	cp	25
    6069/    20A3 : CA AB 20            	jp	z, ld_ix_n42	;jr	z, ld_ix_n42
    6070/    20A6 :                     
    6071/    20A6 : 0E 2A               	ld	c, 2Ah
    6072/    20A8 : 21 56 9F            	ld	hl, opr_num35
    6073/    20AB :                     
    6074/    20AB :                     ld_ix_n42:
    6075/    20AB : 79                  	ld	a, c		; 2nd MC
    6076/    20AC : 4E                  	ld	c, (hl)		; 3rd MC
    6077/    20AD : 23                  	inc	hl
    6078/    20AE : 5E                  	ld	e, (hl)		; 4th MC
    6079/    20AF : C3 B9 25            	jp	mc_end41
    6080/    20B2 :                     
    6081/    20B2 :                     ; LD IY, nnnn; LD IY, (nnnn)
    6082/    20B2 :                     ld_iy_n4:
    6083/    20B2 : 16 FD               	ld	d, 0FDh		; 1st MC
    6084/    20B4 : C3 99 20            	jp	ld_ix_n40	;jr	ld_ix_n40
    6085/    20B7 :                     
    6086/    20B7 :                     ;
    6087/    20B7 :                     ; LD ([IX|IY][+|-]nn), [r|nn]
    6088/    20B7 :                     ;
    6089/    20B7 :                     ;ld_e2_tbl2:	db	33, 36, 34, 37
    6090/    20B7 :                     ; LD (IX | IY +|- nn), r | nn
    6091/    20B7 :                     el3_1_2:
    6092/    20B7 :                     ;	hl = ld_e2_tbl2
    6093/    20B7 : 01 04 00            	ld	bc, ld_en3
    6094/    20BA : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    6095/    20BD : C2 03 21            	jp	nz, el3_13	;jr	nz, el3_13
    6096/    20C0 :                     	
    6097/    20C0 : 21 58 9F            	ld	hl, opr_num37
    6098/    20C3 : 09                  	add	hl, bc
    6099/    20C4 : 56                  	ld	d, (hl)		; get 3rd MC
    6100/    20C5 :                     
    6101/    20C5 : 79                  	ld	a, c
    6102/    20C6 : 1E FD               	ld	e, 0FDh		; 1st MC
    6103/    20C8 : FE 02               	cp	2
    6104/    20CA : DA CF 20            	jp	c, el3_121	;jr	c, el3_121
    6105/    20CD : 1E DD               	ld	e, 0DDh		; 1st MC
    6106/    20CF :                     
    6107/    20CF :                     ; reg_A = (opr2_cd)
    6108/    20CF :                     ; if (reg_A = 25) 2nd_MC = 36h
    6109/    20CF :                     ; else {
    6110/    20CF :                     ;     if (Reg_C = 6) 2nd_MC =77h
    6111/    20CF :                     ;     else 2nd_MC = 75h - reg_C
    6112/    20CF :                     ; }
    6113/    20CF :                     el3_121: ; check element No.3
    6114/    20CF : 3A 53 9F            	ld	a, (opr2_cd)
    6115/    20D2 : FE 19               	cp	25
    6116/    20D4 : CA F3 20            	jp	z, ld_xynln	;jr	z, ld_xynln
    6117/    20D7 :                     
    6118/    20D7 : 21 41 1F            	ld	hl, ld_e2_tbl
    6119/    20DA : 01 07 00            	ld	bc, ld_en1
    6120/    20DD : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    6121/    20E0 : C2 3A 1B            	jp	nz, asm_err
    6122/    20E3 :                     
    6123/    20E3 : 79                  	ld	a, c
    6124/    20E4 : FE 06               	cp	6
    6125/    20E6 : 3E 77               	ld	a, 077h		; a : 2nd MC
    6126/    20E8 : CA EE 20            	jp	z, mc2_77	;jr	z, mc2_77
    6127/    20EB :                     
    6128/    20EB : 3E 75               	ld	a, 75h
    6129/    20ED : 91                  	sub	c	; a : 2nd MC
    6130/    20EE :                     
    6131/    20EE :                      ; adjust 1: c, 2: e, 3: d
    6132/    20EE :                     mc2_77:
    6133/    20EE : 4B                  	ld	c, e		; adjust I/F
    6134/    20EF : 5F                  	ld	e, a		; adjust I/F
    6135/    20F0 : C3 6A 20            	jp	ld_bc_n42
    6136/    20F3 :                     
    6137/    20F3 :                     ld_xynln: ; 4byte MC 
    6138/    20F3 :                     	  ; LD ([IX|IY] [+|-]), nn
    6139/    20F3 :                     	  ; 2nd MC = 36h
    6140/    20F3 :                     
    6141/    20F3 : 2A 54 9F            	ld	hl, (opr_num25)
    6142/    20F6 : 7C                  	ld	a, h
    6143/    20F7 : B7                  	or	a
    6144/    20F8 : C2 3A 1B            	jp	nz, asm_err
    6145/    20FB :                     
    6146/    20FB :                     ; adjust I/F
    6147/    20FB :                     ; d: 1st MC, a: 2nd MC, c: 3rd MC, e: 4th MC
    6148/    20FB :                     
    6149/    20FB : 3E 36               	ld	a, 36h		; 2nd MC
    6150/    20FD : 4A                  	ld	c, d		; 3rd MC
    6151/    20FE : 53                  	ld	d, e		; 1st MC
    6152/    20FF : 5D                  	ld	e, l		; 4th MC
    6153/    2100 : C3 B9 25            	jp	mc_end41
    6154/    2103 :                     
    6155/    2103 :                     ;
    6156/    2103 :                     ; 35 : ld (nnnn), reg
    6157/    2103 :                     ; 28 : ld (hl), r | nn
    6158/    2103 :                     ; 16 : ld SP, hl | ix | iy | nnnn | (nnnn)
    6159/    2103 :                     ; 27 : LD (DE), A
    6160/    2103 :                     ; 26 : LD (BC), A
    6161/    2103 :                     ; 17 : LD R, A
    6162/    2103 :                     ; 13 : LD I, A
    6163/    2103 :                     ;
    6164/    2103 :                     el3_13:
    6165/    2103 :                     ;	hl = ld_e2_tbl3
    6166/    2103 : 01 07 00            	ld	bc, ld_en4
    6167/    2106 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    6168/    2109 : C2 3A 1B            	jp	nz, asm_err
    6169/    210C : 21 12 21            	ld	hl, el3_14
    6170/    210F : C3 E5 1B            	jp	jp_each
    6171/    2112 :                     
    6172/    2112 :                     ; jump table
    6173/    2112 : 2E 21               el3_14:		dw	el3_s35
    6174/    2114 : 68 21               		dw	el3_s28
    6175/    2116 : E0 21               		dw	el3_s27
    6176/    2118 : E5 21               		dw	el3_s26
    6177/    211A : EA 21               		dw	el3_s17
    6178/    211C : 9B 21               		dw	el3_s16
    6179/    211E : EF 21               		dw	el3_s13
    6180/    2120 :                     
    6181/    2120 : =7H                  ldnr_n	equ	ldnr_c - ldnr_t
    6182/    2120 :                     
    6183/    2120 : 01 0B 05 08 10 0E   ldnr_t:		db	1, 11, 5, 8, 16, 14, 15
             2126 : 0F                
    6184/    2127 : 22 22 73 53 43 22   ldnr_c:		db	22h, 22h, 73h, 53h, 43h, 22h, 32h
             212D : 32                
    6185/    212E :                     
    6186/    212E :                     el3_s35: ; ld (nnnn), reg
    6187/    212E :                     
    6188/    212E : 3A 53 9F            	ld	a, (opr2_cd)
    6189/    2131 :                     
    6190/    2131 : 21 20 21            	ld	hl, ldnr_t
    6191/    2134 : 01 07 00            	ld	bc, ldnr_n
    6192/    2137 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    6193/    213A : C2 3A 1B            	jp	nz, asm_err
    6194/    213D :                     
    6195/    213D : 21 27 21            	ld	hl, ldnr_c
    6196/    2140 : 09                  	add	hl, bc
    6197/    2141 : 79                  	ld	a, c
    6198/    2142 : 4E                  	ld	c, (hl)		; 1st MC
    6199/    2143 :                     
    6200/    2143 : 2A 56 9F            	ld	hl, (opr_num35)
    6201/    2146 : FE 05               	cp	5
    6202/    2148 : DA 50 21            	jp	c, el3_s351	;jr	c, el3_s351
    6203/    214B :                     
    6204/    214B :                      ; adjust 1: c, 2: e, 3: d
    6205/    214B :                     
    6206/    214B : 5D                  	ld	e, l			; 2nd MC
    6207/    214C : 54                  	ld	d, h			; 3rd MC
    6208/    214D : C3 6A 20            	jp	ld_bc_n42
    6209/    2150 :                     
    6210/    2150 :                     el3_s351:
    6211/    2150 : FE 02               	cp	2
    6212/    2152 : DA 5D 21            	jp	c, el3_s352	;jr	c, el3_s352
    6213/    2155 :                      ; ED
    6214/    2155 :                     ; d: 1st MC, a: 2nd MC, c: 3rd MC, e: 4th MC
    6215/    2155 :                     
    6216/    2155 : 16 ED               	ld	d, 0EDH			; 1st MC
    6217/    2157 :                     el3_s353:
    6218/    2157 : 79                  	ld	a, c			; 2nd MC
    6219/    2158 : 4D                  	ld	c, l			; 3rd MC
    6220/    2159 : 5C                  	ld	e, h			; 4th mc
    6221/    215A : C3 B9 25            	jp	mc_end41
    6222/    215D :                     
    6223/    215D :                     el3_s352: ; DD, FD
    6224/    215D : 16 FD               	ld	d, 0FDh			; 1st MC
    6225/    215F : B7                  	or	a
    6226/    2160 : CA 57 21            	jp	z, el3_s353	;jr	z, el3_s353
    6227/    2163 : 16 DD               	ld	d, 0DDh			; 1st MC
    6228/    2165 : C3 57 21            	jp	el3_s353	;jr	el3_s353
    6229/    2168 :                     
    6230/    2168 :                     ; ld (hl), r | nn
    6231/    2168 :                     el3_s28:
    6232/    2168 : 3A 53 9F            	ld	a, (opr2_cd)
    6233/    216B : FE 19               	cp	25
    6234/    216D : CA 8C 21            	jp	z, el3_s281	;jr	z, el3_s281
    6235/    2170 : FE 01               	cp	1
    6236/    2172 : CA 87 21            	jp	z, el3_s282	;jr	z, el3_s282
    6237/    2175 : 21 42 1F            	ld	hl, ld_e2_tbl + 1
    6238/    2178 : 01 06 00            	ld	bc, ld_en1 - 1
    6239/    217B : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    6240/    217E : C2 3A 1B            	jp	nz, asm_err
    6241/    2181 : 3E 75               	ld	a, 75h
    6242/    2183 : 91                  	sub	c
    6243/    2184 :                     el3_s283:
    6244/    2184 : C3 4E 22            	jp	st_mc11
    6245/    2187 :                     
    6246/    2187 :                     el3_s282: ; LD (HL), A
    6247/    2187 : 3E 77               	ld	a, 77h
    6248/    2189 : C3 84 21            	jp	el3_s283	;jr	el3_s283
    6249/    218C :                     
    6250/    218C :                     el3_s281: ; LD (HL), nn
    6251/    218C : 2A 54 9F            	ld	hl, (opr_num25)
    6252/    218F : 7C                  	ld	a, h
    6253/    2190 : B7                  	or	a
    6254/    2191 : C2 3A 1B            	jp	nz, asm_err
    6255/    2194 :                     
    6256/    2194 : 7D                  	ld	a, l
    6257/    2195 : F5                  	push	af		; adjust I/F
    6258/    2196 : 3E 36               	ld	a, 36h		; 1st MC
    6259/    2198 : C3 8D 23            	jp	el2_441
    6260/    219B :                     
    6261/    219B :                     el3_s16: ; ld SP, hl | ix | iy | nnnn | (nnnn)
    6262/    219B :                     
    6263/    219B : 3A 53 9F            	ld	a, (opr2_cd)
    6264/    219E : FE 0B               	cp	11
    6265/    21A0 : CA C3 21            	jp	z, el3_s161	;jr	z, el3_s161
    6266/    21A3 : FE 0E               	cp	14
    6267/    21A5 : CA C8 21            	jp	z, el3_s162	;jr	z, el3_s162
    6268/    21A8 : FE 0F               	cp	15
    6269/    21AA : CA CD 21            	jp	z, el3_s163	;jr	z, el3_s163
    6270/    21AD : FE 19               	cp	25
    6271/    21AF : CA D6 21            	jp	z, el3_s164	;jr	z, el3_s164
    6272/    21B2 : FE 23               	cp	35
    6273/    21B4 : C2 3A 1B            	jp	nz, asm_err
    6274/    21B7 :                     
    6275/    21B7 :                     ; LD SP, (nnnn)
    6276/    21B7 :                     ; d: 1st MC, a: 2nd MC, c: 3rd MC, e: 4th MC
    6277/    21B7 :                     
    6278/    21B7 : 16 ED               	ld	d, 0edh		; 1st MC
    6279/    21B9 : 3E 7B               	ld	a, 7bh		; 2nd MC
    6280/    21BB : 2A 56 9F            	ld	hl, (opr_num35)
    6281/    21BE : 4D                  	ld	c, l		; 3rd MC
    6282/    21BF : 5C                  	ld	e, h		; 4th MC
    6283/    21C0 : C3 B9 25            	jp	mc_end41
    6284/    21C3 :                     
    6285/    21C3 :                     
    6286/    21C3 :                     el3_s161: ; LD SP, HL
    6287/    21C3 : 3E F9               	ld	a, 0f9h
    6288/    21C5 : C3 E7 21            	jp	el3_s261	;jr	el3_s261
    6289/    21C8 :                     
    6290/    21C8 :                     el3_s162: ; LD SP, IX
    6291/    21C8 : 16 DD               	ld	d, 0DDh
    6292/    21CA : C3 CF 21            	jp	el3_s1631	;jr	el3_s1631
    6293/    21CD :                     
    6294/    21CD :                     el3_s163: ; LD SP, IY
    6295/    21CD : 16 FD               	ld	d, 0FDh
    6296/    21CF :                     el3_s1631:
    6297/    21CF : 3E F9               	ld	a, 0f9h
    6298/    21D1 : F5                  	push	af		; adjust I/F
    6299/    21D2 : 7A                  	ld	a, d
    6300/    21D3 : C3 8D 23            	jp	el2_441
    6301/    21D6 :                     
    6302/    21D6 :                     el3_s164: ; LD SP, nnnn
    6303/    21D6 :                     ; adjust 1: c, 2: e, 3: d
    6304/    21D6 :                     
    6305/    21D6 : 0E 31               	ld	c, 31h		; 1st MC
    6306/    21D8 : EB                  	ex	de,hl			;z80 code ld	de, (opr_num25)	; e: 2nd MC, d: 3rd MC
    6307/    21D9 : 2A 54 9F            	ld	hl,(opr_num25)		;############################
    6308/    21DC : EB                  	ex	de,hl			;############################
    6309/    21DD : C3 6A 20            	jp	ld_bc_n42
    6310/    21E0 :                     
    6311/    21E0 :                     el3_s27: ; LD (DE), A
    6312/    21E0 : 3E 12               	ld	a, 12h		; set MC
    6313/    21E2 : C3 E7 21            	jp	el3_s261	;jr	el3_s261
    6314/    21E5 :                     	
    6315/    21E5 :                     el3_s26: ; LD (BC), A
    6316/    21E5 : 3E 02               	ld	a, 2h		; set MC
    6317/    21E7 :                     el3_s261:
    6318/    21E7 : C3 4E 22            	jp	st_mc11
    6319/    21EA :                     	
    6320/    21EA :                     el3_s17: ; LD R, A
    6321/    21EA : 3E 4F               	ld	a, 4fh		; set 2nd MC
    6322/    21EC : C3 E6 25            	jp	el2_5411
    6323/    21EF :                     
    6324/    21EF :                     el3_s13: ; LD I, A
    6325/    21EF : 3E 47               	ld	a, 47h		; set 2nd MC
    6326/    21F1 : C3 E6 25            	jp	el2_5411
    6327/    21F4 :                     
    6328/    21F4 :                     ;1111111111111111111111111111111111
    6329/    21F4 :                     ;
    6330/    21F4 :                     ; element count = 1 
    6331/    21F4 :                     ;
    6332/    21F4 :                     ;1111111111111111111111111111111111
    6333/    21F4 :                     
    6334/    21F4 : =0EH                 e1s	equ	e1_e - e1_s
    6335/    21F4 : =15H                 e1s1	equ	e1_e1 - e1_s1
    6336/    21F4 :                     
    6337/    21F4 :                     e1_s: ;------------------------------------------------
    6338/    21F4 : 07 0A 0B 0E 0F 1E   elem1_cd:	db	7, 10, 11, 14, 15, 30, 32
             21FA : 20                
    6339/    21FB : 21 2E 32 33 34 35   		db	33, 46, 50, 51, 52, 53, 65
             2201 : 41                
    6340/    2202 :                     e1_e: ;------------------------------------------------
    6341/    2202 :                     
    6342/    2202 : 27 FB F3 76 00 C9   elem1_opcd:	db	27H, 0FBH, 0F3H, 76H, 00H, 0C9H, 37H
             2208 : 37                
    6343/    2209 : 3F 2F 1F 0F 17 07   		db	3FH, 2FH, 1FH, 0FH, 17H, 07H, 0D9H
             220F : D9                
    6344/    2210 :                     
    6345/    2210 :                     e1_s1: ; ----------------------------------------------
    6346/    2210 : 27 28 25 26 3A 3B   elem1_cd1:	db	39, 40, 37, 38, 58, 59, 56
             2216 : 38                
    6347/    2217 : 39 04 05 02 03 1F   		db	57, 4,  5,  2,  3,  31, 64
             221D : 40                
    6348/    221E : 3E 3F 3D 2F 30 42   		db	62, 63, 61, 47, 48, 66, 67
             2224 : 43                
    6349/    2225 :                     e1_e1: ; ----------------------------------------------
    6350/    2225 :                     
    6351/    2225 : 67 6F 45 4D A3 AB   elem1_opcd1:	db	 67h,  6Fh,  45h,  4Dh, 0A3h, 0ABh, 0B3h
             222B : B3                
    6352/    222C : BB 44 B0 A0 B8 A8   		db	0BBh,  44h, 0B0h, 0A0h, 0B8h, 0A8h, 0B2h
             2232 : B2                
    6353/    2233 : A2 BA AA B1 A1 B9   		db	0A2h, 0BAh, 0AAh, 0B1h, 0A1h, 0B9h, 0A9h
             2239 : A9                
    6354/    223A :                     
    6355/    223A :                     ;
    6356/    223A :                     ; make machine code,
    6357/    223A :                     ; element_cnt = 1 (ex. NOP)
    6358/    223A :                     ; output : 1 byte Machine code
    6359/    223A :                     ;
    6360/    223A :                     mk_e1:	; 1byte MC
    6361/    223A : 3A 51 9F            	ld	a, (opc_cd)
    6362/    223D : 01 0E 00            	ld	bc, e1s
    6363/    2240 : 21 F4 21            	ld	hl, elem1_cd
    6364/    2243 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    6365/    2246 : C2 5A 22            	jp	nz, mk_e11
    6366/    2249 :                     	
    6367/    2249 : 21 02 22            	ld	hl, elem1_opcd
    6368/    224C :                     
    6369/    224C :                     st_mc1:
    6370/    224C : 09                  	add	hl, bc
    6371/    224D :                     	; get MC
    6372/    224D : 7E                  	ld	a, (hl)
    6373/    224E :                     st_mc11:
    6374/    224E : 2A 4D 9F            	ld	hl, (tasm_adr)
    6375/    2251 : 77                  	ld	(hl), a
    6376/    2252 : 3E 01               	ld	a, 1
    6377/    2254 :                     
    6378/    2254 :                     mc_end:
    6379/    2254 : 32 50 9F            	ld	(byte_count), a	; set MC bytes
    6380/    2257 : C3 4C 1B            	jp	cout_sp
    6381/    225A :                     
    6382/    225A :                     mk_e11: ; 2byte MC (0EDh, XX)
    6383/    225A : 01 15 00            	ld	bc, e1s1
    6384/    225D : 21 10 22            	ld	hl, elem1_cd1
    6385/    2260 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    6386/    2263 : C2 3A 1B            	jp	nz, asm_err
    6387/    2266 :                     	
    6388/    2266 : 2A 4D 9F            	ld	hl, (tasm_adr)
    6389/    2269 : 3E ED               	ld	a, 0EDH
    6390/    226B : 77                  	ld	(hl), a		; set MC No.1
    6391/    226C : 23                  	inc	hl
    6392/    226D : EB                  	ex	de, hl
    6393/    226E :                     
    6394/    226E : 21 25 22            	ld	hl, elem1_opcd1
    6395/    2271 : 09                  	add	hl, bc
    6396/    2272 :                     	; get MC
    6397/    2272 : 7E                  	ld	a, (hl)
    6398/    2273 : 12                  	ld	(de), a		; set MC No.2
    6399/    2274 :                     
    6400/    2274 :                     mc_end2:
    6401/    2274 : 3E 02               	ld	a, 2
    6402/    2276 : C3 54 22            	jp	mc_end		;jr	mc_end
    6403/    2279 :                     
    6404/    2279 :                     ;2222222222222222222222222222222222222222222222
    6405/    2279 :                     ;
    6406/    2279 :                     ; element count = 2 
    6407/    2279 :                     ;
    6408/    2279 :                     ;2222222222222222222222222222222222222222222222
    6409/    2279 :                     
    6410/    2279 : =1AH                 e2s	equ	e2_e - e2_s
    6411/    2279 :                     
    6412/    2279 :                     e2_s:
    6413/    2279 :                     elem2_cd:
    6414/    2279 : 08 09               	db	8, 9			; DD, FD
    6415/    227B : 17 1A               	db	23, 26			; DD, FD
    6416/    227D : 18 1B 1C 1D 29      	db	24, 27, 28 ,29, 41	; DD, FD
    6417/    2282 : 2A                  	db	42			; DD, FD
    6418/    2283 : 2E                  	db	46
    6419/    2284 : 31                  	db	49
    6420/    2285 : 2B                  	db	43
    6421/    2286 : 2C                  	db	44
    6422/    2287 : 2D                  	db	45
    6423/    2288 :                     ; CB
    6424/    2288 : 0C                  	db	12			; DD, FD
    6425/    2289 : 10                  	db	16			; DD, FD
    6426/    228A : 0D                  	db	13			; DD, FD
    6427/    228B : 11                  	db	17			; DD, FD
    6428/    228C : 12                  	db	18			; DD, FD
    6429/    228D : 13                  	db	19			; DD, FD
    6430/    228E : 14                  	db	20			; DD, FD
    6431/    228F :                     ; ED
    6432/    228F : 36                  	db	54			; ED
    6433/    2290 : 44                  	db	68			; ORG
    6434/    2291 : 45                  	db	69			; DB
    6435/    2292 : 46                  	db	70			; DW
    6436/    2293 :                     e2_e:
    6437/    2293 :                     
    6438/    2293 :                     ent_el2:
    6439/    2293 : DC 22               	dw	el2_70		; DW
    6440/    2295 : F4 22               	dw	el2_69		; DB
    6441/    2297 : 35 23               	dw	el2_68		; ORG
    6442/    2299 : C8 25               	dw	el2_54		; IM
    6443/    229B : 58 25               	dw	el2_20		; SRL
    6444/    229D : 5E 25               	dw	el2_19		; SRA
    6445/    229F : 64 25               	dw	el2_18		; SLA
    6446/    22A1 : 6A 25               	dw	el2_17		; RR
    6447/    22A3 : 70 25               	dw	el2_13		; RL
    6448/    22A5 : 76 25               	dw	el2_16		; RRC
    6449/    22A7 : 7C 25               	dw	el2_12		; RLC
    6450/    22A9 :                     
    6451/    22A9 : 60 23               	dw	el2_45		; CALL nnnn
    6452/    22AB : 7C 23               	dw	el2_44		; DJNZ e
    6453/    22AD : 97 23               	dw	el2_43		; jR e
    6454/    22AF : AB 23               	dw	el2_49		; RST nn
    6455/    22B1 : D6 23               	dw	el2_46		; RET CC
    6456/    22B3 : FB 23               	dw	el2_42		; JP (HL), JP nnnn
    6457/    22B5 :                     
    6458/    22B5 :                     ; code base 0a0h, or 00h, 08h, 10h, 18h
    6459/    22B5 : 38 24               	dw	el2_41		; CP
    6460/    22B7 : 3D 24               	dw	el2_29		; XOR
    6461/    22B9 : 42 24               	dw	el2_28		; OR
    6462/    22BB : 47 24               	dw	el2_27		; AND
    6463/    22BD :                     
    6464/    22BD : 4C 24               	dw	el2_24		; SUB
    6465/    22BF :                     
    6466/    22BF : D1 24               	dw	el2_26		; DEC
    6467/    22C1 : D7 24               	dw	el2_23		; INC
    6468/    22C3 :                     
    6469/    22C3 : 1D 25               	dw	el2_9		; POP
    6470/    22C5 : 22 25               	dw	el2_8		; PUSH
    6471/    22C7 :                     
    6472/    22C7 :                     ;
    6473/    22C7 :                     ; make machine code,
    6474/    22C7 :                     ; element_cnt = 2 (ex. PUSH AF)
    6475/    22C7 :                     ; output : 1 to 3 bytes Machine code
    6476/    22C7 :                     ;
    6477/    22C7 :                     
    6478/    22C7 :                     mk_e2:
    6479/    22C7 : 3A 51 9F            	ld	a, (opc_cd)
    6480/    22CA : 01 1A 00            	ld	bc, e2s
    6481/    22CD : 21 79 22            	ld	hl, elem2_cd
    6482/    22D0 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    6483/    22D3 : C2 3A 1B            	jp	nz, asm_err
    6484/    22D6 :                     	
    6485/    22D6 : 21 93 22            	ld	hl, ent_el2
    6486/    22D9 : C3 E5 1B            	jp	jp_each
    6487/    22DC :                     
    6488/    22DC :                     el2_70: ; DW
    6489/    22DC : 3A 52 9F            	ld	a, (opr1_cd)
    6490/    22DF : FE 19               	cp	25
    6491/    22E1 : C2 3A 1B            	jp	nz, asm_err
    6492/    22E4 :                     
    6493/    22E4 : EB                  	ex	de,hl			;z80 code ld	bc, (opr_num25)
    6494/    22E5 : 2A 54 9F            	ld	hl,(opr_num25)		;#############################
    6495/    22E8 : EB                  	ex	de,hl			;#############################
    6496/    22E9 : 42                  	ld	b,d			;#############################
    6497/    22EA : 4B                  	ld	c,e			;#############################
    6498/    22EB : 2A 4D 9F            	ld	hl, (tasm_adr)
    6499/    22EE : 71                  	ld	(hl), c
    6500/    22EF : 23                  	inc	hl
    6501/    22F0 : 70                  	ld	(hl), b
    6502/    22F1 : C3 74 22            	jp	mc_end2
    6503/    22F4 :                     
    6504/    22F4 :                     el2_69: ; DB
    6505/    22F4 : 3A 52 9F            	ld	a, (opr1_cd)
    6506/    22F7 : FE 19               	cp	25
    6507/    22F9 : CA 20 23            	jp	z, el2_691	;jr	z, el2_691
    6508/    22FC : FE 26               	cp	38
    6509/    22FE : C2 3A 1B            	jp	nz, asm_err
    6510/    2301 :                     	
    6511/    2301 : 2A 54 9F            	ld	hl, (opr_num25)
    6512/    2304 :                     
    6513/    2304 : AF                  	xor	a
    6514/    2305 : 4F                  	ld	c, a
    6515/    2306 : EB                  	ex	de,hl			;z80 code ld	de, (tasm_adr)
    6516/    2307 : 2A 4D 9F            	ld	hl,(tasm_adr)		;#############################
    6517/    230A : EB                  	ex	de,hl			;#############################
    6518/    230B :                     el2_692:
    6519/    230B : 7E                  	ld	a, (hl)
    6520/    230C : FE 22               	cp	'"'
    6521/    230E : CA 1C 23            	jp	z, cpstrend	;jr	z, cpstrend
    6522/    2311 : B7                  	or	a
    6523/    2312 : CA 1C 23            	jp	z, cpstrend	;jr	z, cpstrend
    6524/    2315 :                     
    6525/    2315 : 12                  	ld	(de), a
    6526/    2316 : 23                  	inc	hl
    6527/    2317 : 13                  	inc	de
    6528/    2318 : 0C                  	inc	c
    6529/    2319 : C3 0B 23            	jp	el2_692		;jr	el2_692
    6530/    231C :                     
    6531/    231C :                     cpstrend:
    6532/    231C : 79                  	ld	a, c
    6533/    231D : C3 54 22            	jp	mc_end
    6534/    2320 :                     
    6535/    2320 :                     el2_691:
    6536/    2320 : EB                  	ex	de,hl			;z80 code ld	bc, (opr_num25)
    6537/    2321 : 2A 54 9F            	ld	hl,(opr_num25)		;#############################
    6538/    2324 : EB                  	ex	de,hl			;#############################
    6539/    2325 : 42                  	ld	b,d			;#############################
    6540/    2326 : 4B                  	ld	c,e			;#############################
    6541/    2327 : 78                  	ld	a, b
    6542/    2328 : B7                  	or	a
    6543/    2329 : C2 3A 1B            	jp	nz, asm_err
    6544/    232C :                     
    6545/    232C : 2A 4D 9F            	ld	hl, (tasm_adr)
    6546/    232F : 71                  	ld	(hl), c
    6547/    2330 : 3E 01               	ld	a, 1
    6548/    2332 : C3 54 22            	jp	mc_end
    6549/    2335 :                     
    6550/    2335 :                     el2_68: ; ORG
    6551/    2335 : 3A 52 9F            	ld	a, (opr1_cd)
    6552/    2338 : FE 19               	cp	25
    6553/    233A : C2 3A 1B            	jp	nz, asm_err
    6554/    233D :                     
    6555/    233D : AF                  	xor	a
    6556/    233E : 2A 54 9F            	ld	hl, (opr_num25)
    6557/    2341 : 01 00 80            	ld	bc, RAM_B
    6558/    2344 : CD B4 30            	call	sbc_hlbc		;z80 code sbc	hl, bc #####
    6559/    2347 : DA 3A 1B            	jp	c, asm_err
    6560/    234A :                     
    6561/    234A : 01 00 A0            	ld	bc, RAM_B + RAM_SIZ
    6562/    234D : 2A 54 9F            	ld	hl, (opr_num25)
    6563/    2350 : CD B4 30            	call	sbc_hlbc		;z80 code sbc	hl, bc #####
    6564/    2353 : DA 56 23            	jp	c, okram	;jr	c, okram
    6565/    2356 :                     
    6566/    2356 :                     okram:
    6567/    2356 : 2A 54 9F            	ld	hl, (opr_num25)
    6568/    2359 : 22 4D 9F            	ld	(tasm_adr), hl
    6569/    235C : AF                  	xor	a
    6570/    235D : C3 54 22            	jp	mc_end
    6571/    2360 :                     
    6572/    2360 :                     ; CALL nnnn
    6573/    2360 :                     el2_45:
    6574/    2360 : 3A 52 9F            	ld	a, (opr1_cd)
    6575/    2363 : FE 19               	cp	25
    6576/    2365 : C2 3A 1B            	jp	nz, asm_err
    6577/    2368 :                     
    6578/    2368 : 3E CD               	ld	a, 0CDH
    6579/    236A :                     
    6580/    236A :                     el2_451:
    6581/    236A : 2A 4D 9F            	ld	hl, (tasm_adr)
    6582/    236D : 77                  	ld	(hl), a		; save op_code
    6583/    236E : 23                  	inc	hl
    6584/    236F : EB                  	ex	de,hl			;z80 code ld	de, (opr_num25)
    6585/    2370 : 2A 54 9F            	ld	hl,(opr_num25)		;#############################
    6586/    2373 : EB                  	ex	de,hl			;#############################
    6587/    2374 : 73                  	ld	(hl), e
    6588/    2375 : 23                  	inc	hl
    6589/    2376 : 72                  	ld	(hl), d
    6590/    2377 :                     
    6591/    2377 :                     mc_end3:
    6592/    2377 : 3E 03               	ld	a, 3
    6593/    2379 : C3 54 22            	jp	mc_end
    6594/    237C :                     
    6595/    237C :                     ; DJNZ relative number
    6596/    237C :                     el2_44:
    6597/    237C : 3A 52 9F            	ld	a, (opr1_cd)
    6598/    237F : FE 19               	cp	25
    6599/    2381 : C2 3A 1B            	jp	nz, asm_err
    6600/    2384 :                     
    6601/    2384 : CD 83 27            	call	calc_reladr
    6602/    2387 : DA 3A 1B            	jp	c, asm_err
    6603/    238A : F5                  	push	af
    6604/    238B : 3E 10               	ld	a, 10H
    6605/    238D :                     el2_441:
    6606/    238D : 2A 4D 9F            	ld	hl, (tasm_adr)
    6607/    2390 : 77                  	ld	(hl), a		; save op_code
    6608/    2391 : 23                  	inc	hl
    6609/    2392 : F1                  	pop	af
    6610/    2393 : 77                  	ld	(hl), a
    6611/    2394 : C3 74 22            	jp	mc_end2
    6612/    2397 :                     
    6613/    2397 :                     ;ovr_msg:
    6614/    2397 :                     ;	db	"Over. ", 0
    6615/    2397 :                     
    6616/    2397 :                     ; JR e
    6617/    2397 :                     el2_43:
    6618/    2397 : 3A 52 9F            	ld	a, (opr1_cd)
    6619/    239A : FE 19               	cp	25
    6620/    239C : C2 3A 1B            	jp	nz, asm_err
    6621/    239F : CD 83 27            	call	calc_reladr
    6622/    23A2 : DA 3A 1B            	jp	c, asm_err
    6623/    23A5 : F5                  	push	af
    6624/    23A6 : 3E 18               	ld	a, 18H
    6625/    23A8 : C3 8D 23            	jp	el2_441		;jr	el2_441
    6626/    23AB :                     
    6627/    23AB :                     ; RST
    6628/    23AB :                     el2_49:
    6629/    23AB : 2A 54 9F            	ld	hl, (opr_num25)
    6630/    23AE : 7C                  	ld	a, h
    6631/    23AF : B7                  	or	a
    6632/    23B0 : C2 3A 1B            	jp	nz, asm_err
    6633/    23B3 : 7D                  	ld	a, l
    6634/    23B4 : 21 C6 23            	ld	hl, rst_no
    6635/    23B7 : 01 08 00            	ld	bc, 8
    6636/    23BA : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    6637/    23BD : C2 3A 1B            	jp	nz, asm_err
    6638/    23C0 :                     
    6639/    23C0 : 21 CE 23            	ld	hl, rst_cd
    6640/    23C3 : C3 4C 22            	jp	st_mc1		; get and store MC code
    6641/    23C6 :                     
    6642/    23C6 : 00 08 10 18 20 28   rst_no:	db	0, 8, 10H, 18H, 20H, 28H, 30H, 38H
             23CC : 30 38             
    6643/    23CE : FF F7 EF E7 DF D7   rst_cd:	db	0FFH, 0F7H, 0EFH, 0E7H, 0DFH, 0D7H, 0CFH, 0C7H
             23D4 : CF C7             
    6644/    23D6 :                     
    6645/    23D6 :                     ;ill_num:	db	"Ill-No. ", 0
    6646/    23D6 :                     
    6647/    23D6 :                     ; RET CC
    6648/    23D6 :                     el2_46:
    6649/    23D6 : 3A 52 9F            	ld	a, (opr1_cd)	; get code number of operand No.1
    6650/    23D9 : 21 EB 23            	ld	hl, ret_no
    6651/    23DC : 01 08 00            	ld	bc, 8
    6652/    23DF : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    6653/    23E2 : C2 3A 1B            	jp	nz, asm_err
    6654/    23E5 :                     
    6655/    23E5 : 21 F3 23            	ld	hl, ret_cd
    6656/    23E8 : C3 4C 22            	jp	st_mc1		; get and store MC code
    6657/    23EB :                     
    6658/    23EB : 06 12 13 14 15 16   ret_no:	db	6, 18, 19, 20, 21, 22, 23, 24
             23F1 : 17 18             
    6659/    23F3 : E8 E0 F0 D0 C0 F8   ret_cd:	db	0E8H, 0E0H, 0F0H, 0D0H, 0C0H, 0F8H, 0C8H, 0D8H
             23F9 : C8 D8             
    6660/    23FB :                     
    6661/    23FB :                     ; JP (HL), JP nnnn, JP (IX), JP (IY)
    6662/    23FB :                     el2_42:
    6663/    23FB : 3A 52 9F            	ld	a, (opr1_cd)	; get code number of operand No.1
    6664/    23FE : FE 19               	cp	25
    6665/    2400 : CA 26 24            	jp	z, jpnnnn	;jr z, jpnnnn	; JP nnnn
    6666/    2403 : 2E E9               	ld	l, 0E9H
    6667/    2405 : FE 1C               	cp	28		; (HL)?
    6668/    2407 : CA 22 24            	jp	z, jphl		;jr	z, jphl
    6669/    240A : FE 1D               	cp	29		; (IX)?
    6670/    240C : CA 1B 24            	jp	z, jpix		;jr	z, jpix
    6671/    240F : FE 1E               	cp	30		; (IY)?
    6672/    2411 : C2 3A 1B            	jp	nz, asm_err
    6673/    2414 :                     
    6674/    2414 :                     ; JP (IY)
    6675/    2414 : 7D                  	ld	a, l
    6676/    2415 : F5                  	push	af
    6677/    2416 : 3E FD               	ld	a, 0FDH
    6678/    2418 : C3 8D 23            	jp	el2_441
    6679/    241B :                     
    6680/    241B :                     ; JP (IX)
    6681/    241B :                     jpix:
    6682/    241B : 7D                  	ld	a, l
    6683/    241C : F5                  	push	af
    6684/    241D : 3E DD               	ld	a, 0DDH
    6685/    241F : C3 8D 23            	jp	el2_441
    6686/    2422 :                     
    6687/    2422 :                     ; JP (HL)
    6688/    2422 :                     jphl:
    6689/    2422 : 7D                  	ld	a, l
    6690/    2423 : C3 4E 22            	jp	st_mc11		; set JP (HL) MC code
    6691/    2426 :                     
    6692/    2426 :                     ; JP nnnn
    6693/    2426 :                     jpnnnn:
    6694/    2426 : 3E C3               	ld	a, 0c3h
    6695/    2428 : C3 6A 23            	jp	el2_451		; save OP and jmp address
    6696/    242B :                     
    6697/    242B :                     ;
    6698/    242B :                     ; CP, XOR, OR, AND, SUB section
    6699/    242B :                     ;
    6700/    242B :                     ; (defined already)
    6701/    242B :                     ;rhlnnxy	equ	r_hl_nne - r_hl_nn
    6702/    242B :                     ;m_num		equ	5	; except No.0 - 4  (IX+,IY+,IX-,IY-,nnnn)
    6703/    242B :                     ;r_hl_nn:	db	1, 4, 6, 7, 9, 10, 12, 28
    6704/    242B :                     ;		db	25
    6705/    242B :                     ;ex_sr_:	db	33, 36, 34, 37
    6706/    242B :                     ;r_hl_nne:
    6707/    242B :                     ;
    6708/    242B : 06 06 06 06 46      base1:		db	06H, 06H, 06H, 06H, 46h
    6709/    2430 : 06 05 04 03 02 01   		db	06H, 05H, 04H, 03H, 02H, 01H, 00H, 07H
             2436 : 00 07             
    6710/    2438 :                     
    6711/    2438 :                     el2_41: ; CP
    6712/    2438 : 16 B8               	ld	d, 0b8h
    6713/    243A : C3 4E 24            	jp	and_cp		;jr	and_cp
    6714/    243D :                     
    6715/    243D :                     el2_29: ; XOR
    6716/    243D : 16 A8               	ld	d, 0a8h
    6717/    243F : C3 4E 24            	jp	and_cp		;jr	and_cp
    6718/    2442 :                     
    6719/    2442 :                     el2_28: ; OR
    6720/    2442 : 16 B0               	ld	d, 0b0h
    6721/    2444 : C3 4E 24            	jp	and_cp		;jr	and_cp
    6722/    2447 :                     
    6723/    2447 :                     el2_27: ; AND
    6724/    2447 : 16 A0               	ld	d, 0a0h
    6725/    2449 : C3 4E 24            	jp	and_cp		;jr	and_cp
    6726/    244C :                     
    6727/    244C :                     el2_24: ; SUB
    6728/    244C : 16 90               	ld	d, 090h
    6729/    244E :                     
    6730/    244E :                     and_cp:
    6731/    244E : 3A 52 9F            	ld	a, (opr1_cd)	; get code number of operand No.1
    6732/    2451 : 21 58 1F            	ld	hl, r_hl_nn
    6733/    2454 : 01 0D 00            	ld	bc, rhlnnxy
    6734/    2457 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    6735/    245A : C2 3A 1B            	jp	nz, asm_err
    6736/    245D :                     
    6737/    245D : 21 2B 24            	ld	hl, base1
    6738/    2460 : 09                  	add	hl, bc
    6739/    2461 : 7E                  	ld	a, (hl)
    6740/    2462 : B2                  	or	a, d		; make code operand1
    6741/    2463 : 57                  	ld	d, a		; save operand1
    6742/    2464 : 79                  	ld	a, c
    6743/    2465 : FE 05               	cp	m_num		; check IX+,IY+,IX-,IY-,nnnn
    6744/    2467 : DA 6E 24            	jp	c, el2_410
    6745/    246A : 7A                  	ld	a, d		; restore
    6746/    246B : C3 4E 22            	jp	st_mc11
    6747/    246E :                     	
    6748/    246E :                     ; IX+,IY+,IX-,IY-,nnnn
    6749/    246E :                     el2_410:
    6750/    246E : FE 04               	cp	4 		; cp nn ?
    6751/    2470 : DA 81 24            	jp	c, cp_ixiy	;jr	c, cp_ixiy	; no, IX+,IY+,IX-,IY-
    6752/    2473 :                     
    6753/    2473 :                     ; CP nn
    6754/    2473 : 2A 54 9F            	ld	hl, (opr_num25)
    6755/    2476 : 7C                  	ld	a, h
    6756/    2477 : B7                  	or	a
    6757/    2478 : C2 3A 1B            	jp	nz, asm_err
    6758/    247B :                     
    6759/    247B : 7D                  	ld	a, l
    6760/    247C :                     el2_411:
    6761/    247C : F5                  	push	af		; adjust save I/F
    6762/    247D : 7A                  	ld	a, d		; restore cp opecode
    6763/    247E : C3 8D 23            	jp	el2_441
    6764/    2481 :                     	
    6765/    2481 :                     ; CP (IX+nn), CP (IY+nn), CP (IX-nn), CP (IY-nn)
    6766/    2481 :                     
    6767/    2481 :                     cp_ixiy:
    6768/    2481 : FE 02               	cp	2
    6769/    2483 : 3E FD               	ld	a, 0FDH
    6770/    2485 : DA 8A 24            	jp	c, cp_iy	;jr	c, cp_iy
    6771/    2488 : 3E DD               	ld	a, 0DDH
    6772/    248A :                     cp_iy:
    6773/    248A : 21 58 9F            	ld	hl, opr_num37
    6774/    248D : 09                  	add	hl, bc
    6775/    248E : 4E                  	ld	c, (hl)
    6776/    248F :                     cp_xy1:	
    6777/    248F : 2A 4D 9F            	ld	hl, (tasm_adr)
    6778/    2492 : 77                  	ld	(hl), a		; save op_code
    6779/    2493 : 7A                  	ld	a, d		; restore 2nd operand
    6780/    2494 : 23                  	inc	hl
    6781/    2495 : 77                  	ld	(hl), a
    6782/    2496 : 23                  	inc	hl
    6783/    2497 : 71                  	ld	(hl), c
    6784/    2498 : C3 77 23            	jp	mc_end3
    6785/    249B :                     
    6786/    249B :                     ;
    6787/    249B :                     ; DEC, INC section
    6788/    249B :                     ;
    6789/    249B :                     
    6790/    249B : =12H                 di_nbs		equ	d_i_tbe - d_i_tb
    6791/    249B : =6H                  di_ixynum	equ	d_i_tbe - dix_tbl
    6792/    249B : =4H                  di_ixnnum	equ	d_i_tbe - dixn_tbl
    6793/    249B : =2H                  di_iynnum	equ	d_i_tbe - diyn_tbl
    6794/    249B :                     
    6795/    249B : 01 04 05 06 07 08   d_i_tb:		db	1, 4, 5, 6, 7, 8
    6796/    24A1 : 09 0A 0B 0C 10 1C   		db	9, 10, 11, 12, 16, 28
    6797/    24A7 : 0E 0F               dix_tbl:	db	14, 15		; IX, IY
    6798/    24A9 : 21 24               dixn_tbl:	db	33, 36		; IX+nn, IX-nn
    6799/    24AB : 22 25               diyn_tbl:	db	34, 37		; IY+nn, IY-nn
    6800/    24AD :                     d_i_tbe:
    6801/    24AD :                     
    6802/    24AD : 35 35               DEC_opr:	db	35h, 35h	; IY-, IY+
    6803/    24AF : 35 35               		db	35h, 35h	; IX-, IX+
    6804/    24B1 : 2B 2B               		db	2bh, 2bh 	; IY, IX
    6805/    24B3 : 35 3B 2D 2B 25 1D   		db	35h, 3Bh, 2Dh, 2Bh, 25h, 1Dh
    6806/    24B9 : 1B 15 0D 0B 05 3D   		db	1Bh, 15h, 0Dh, 0Bh, 05h, 3Dh
    6807/    24BF :                     
    6808/    24BF : 34 34               INC_opr:	db	34h, 34h	; IY-, IY+
    6809/    24C1 : 34 34               		db	34h, 34h	; IX-, IX+
    6810/    24C3 : 23 23               		db	23h, 23h	; IY,  IX
    6811/    24C5 : 34 33 2C 23 24 1C   		db	34h, 33h, 2Ch, 23h, 24h, 1Ch
    6812/    24CB : 13 14 0C 03 04 3C   		db	13h, 14h, 0Ch, 03h, 04h, 3Ch
    6813/    24D1 :                     
    6814/    24D1 :                     el2_26: ; DEC
    6815/    24D1 : 11 AD 24            	ld	de, DEC_opr
    6816/    24D4 : C3 DA 24            	jp	el2_di		;jr	el2_di
    6817/    24D7 :                     
    6818/    24D7 :                     el2_23: ; INC
    6819/    24D7 : 11 BF 24            	ld	de, INC_opr
    6820/    24DA :                     
    6821/    24DA :                     el2_di:
    6822/    24DA : 3A 52 9F            	ld	a, (opr1_cd)	; get code number of operand No.1
    6823/    24DD : 21 9B 24            	ld	hl, d_i_tb
    6824/    24E0 : 01 12 00            	ld	bc, di_nbs
    6825/    24E3 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    6826/    24E6 : 62                  	ld	h, d
    6827/    24E7 : 6B                  	ld	l, e
    6828/    24E8 : C2 3A 1B            	jp	nz, asm_err
    6829/    24EB :                     
    6830/    24EB : 79                  	ld	a, c
    6831/    24EC : 16 FD               	ld	d, 0FDH		; set IY extended OP
    6832/    24EE : FE 06               	cp	di_ixynum
    6833/    24F0 : D2 4C 22            	jp	nc, st_mc1	; 1 MC code
    6834/    24F3 :                     
    6835/    24F3 : 09                  	add	hl, bc
    6836/    24F4 : 7E                  	ld	a, (hl)		; get 2nd operand
    6837/    24F5 : 5F                  	ld	e, a		; save
    6838/    24F6 : 79                  	ld	a, c
    6839/    24F7 : FE 04               	cp	di_ixnnum
    6840/    24F9 : DA 05 25            	jp	c, di_3mc	;jr	c, di_3mc
    6841/    24FC :                     	
    6842/    24FC :                     	; 2 MC. : INC IX, IY, DEC IX, IY
    6843/    24FC :                     	
    6844/    24FC : CA 01 25            	jp	z, di_iy	;jr	z, di_iy
    6845/    24FF : 16 DD               	ld	d, 0DDH		; set IX extended OP
    6846/    2501 :                     di_iy:
    6847/    2501 : 7B                  	ld	a, e		; restoe 2nd operand
    6848/    2502 : C3 7C 24            	jp	el2_411		; 2 MC (IX, IY)
    6849/    2505 :                     
    6850/    2505 :                     	; 3 MC. : INC (IX+nn) etc,.
    6851/    2505 :                     di_3mc:
    6852/    2505 : FE 02               	cp	di_iynnum	; IY+-nn?
    6853/    2507 : DA 0C 25            	jp	c, di_3mc1	;jr	c, di_3mc1
    6854/    250A : 16 DD               	ld	d, 0DDH		; set IX extended OP
    6855/    250C :                     di_3mc1:
    6856/    250C : 7A                  	ld	a, d		; adjust I/F
    6857/    250D : 53                  	ld	d, e		; adjust I/F
    6858/    250E : C3 8A 24            	jp	cp_iy		; make 3 MC
    6859/    2511 :                     	
    6860/    2511 :                     ;
    6861/    2511 :                     ; PUSH, POP section
    6862/    2511 :                     ;
    6863/    2511 :                     
    6864/    2511 : =6H                  pp_no		equ	pp_tble - pp_tbl
    6865/    2511 : =2H                  pp_ixiy		equ	pp_tble - pp_ixy
    6866/    2511 :                     
    6867/    2511 : 02 05 08 0B         pp_tbl:		db	2, 5, 8, 11
    6868/    2515 : 0E 0F               pp_ixy:		db	14, 15
    6869/    2517 :                     pp_tble:	
    6870/    2517 :                     
    6871/    2517 : E0 E0               pp_base:	db	0E0h, 0E0h ; IY, IX
    6872/    2519 : E0 D0 C0 F0         		db	0E0h, 0D0h, 0C0h, 0f0h
    6873/    251D :                     
    6874/    251D :                     el2_9:  ; POP
    6875/    251D : 16 01               	ld	d, 01h		; base code for pop operand
    6876/    251F : C3 24 25            	jp	el2_81		;jr	el2_81
    6877/    2522 :                     
    6878/    2522 :                     el2_8:  ; PUSH
    6879/    2522 : 16 05               	ld	d, 05h
    6880/    2524 :                     
    6881/    2524 :                     el2_81:
    6882/    2524 : 21 11 25            	ld	hl, pp_tbl
    6883/    2527 : 01 06 00            	ld	bc, pp_no
    6884/    252A : 3A 52 9F            	ld	a, (opr1_cd)	; get code number of operand No.1
    6885/    252D : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    6886/    2530 : C2 3A 1B            	jp	nz, asm_err
    6887/    2533 :                     
    6888/    2533 : 21 17 25            	ld	hl, pp_base
    6889/    2536 : 09                  	add	hl, bc
    6890/    2537 : 7E                  	ld	a, (hl)
    6891/    2538 : B2                  	or	d		; make opecode
    6892/    2539 : 57                  	ld	d, a		; save
    6893/    253A :                     
    6894/    253A : 79                  	ld	a, c
    6895/    253B : FE 02               	cp	pp_ixiy
    6896/    253D : 7A                  	ld	a, d		; restore
    6897/    253E : D2 4E 22            	jp	nc, st_mc11	; 1 MC code
    6898/    2541 :                     
    6899/    2541 : 1E FD               	ld	e, 0FDH		; set IY extended OP
    6900/    2543 : 79                  	ld	a, c
    6901/    2544 : B7                  	or	a		; IY
    6902/    2545 : CA 4A 25            	jp	z, el2_82	;jr	z, el2_82
    6903/    2548 : 1E DD               	ld	e, 0DDH		; set IX code
    6904/    254A :                     el2_82:
    6905/    254A : 7A                  	ld	a, d
    6906/    254B : F5                  	push	af		; adjust I/F
    6907/    254C : 7B                  	ld	a, e		; adjust I/F
    6908/    254D : C3 8D 23            	jp	el2_441		; make 2 MC
    6909/    2550 :                     
    6910/    2550 :                     ;
    6911/    2550 :                     ; SRL, SRA, SLA, RR, RL, RRC, RLC section
    6912/    2550 :                     ;
    6913/    2550 :                     
    6914/    2550 :                     
    6915/    2550 :                     ; already defined
    6916/    2550 :                     ; r_hl_nn:	db	1, 4, 6, 7, 9, 10, 12, 28
    6917/    2550 :                     ;		db	25
    6918/    2550 :                     ; ex_sr_:		db	33, 36, 34, 37
    6919/    2550 :                     
    6920/    2550 : =8H                  sr_num		equ	8
    6921/    2550 : =4H                  ex_sr_num	equ	ld_en3
    6922/    2550 :                     
    6923/    2550 :                     ;SRL_cd:	db	3Eh, 3Dh, 3Ch, 3Bh, 3Ah, 39h, 38h, 3Fh
    6924/    2550 :                     ;SRA_cd:	db	2Eh, 2Dh, 2Ch, 2Bh, 2Ah, 29h, 28h, 2Fh
    6925/    2550 :                     ;RR_cd:		db	1Eh, 1Dh, 1Ch, 1Bh, 1Ah, 19h, 18h, 1Fh
    6926/    2550 :                     ;RRC_cd:	db	0Eh, 0Dh, 0Ch, 0Bh, 0Ah, 09h, 08h, 0Fh
    6927/    2550 :                     ;SLA_cd:	db	26h, 25h, 24h, 23h, 22h, 21h, 20h, 27h
    6928/    2550 :                     ;RL_cd:		db	16h, 15h, 14h, 13h, 12h, 11h, 10h, 17h
    6929/    2550 :                     ;RLC_cd:	db	06h, 05h, 04h, 03h, 02h, 01h, 00h, 07h
    6930/    2550 :                     ;RLC_cd:	db	06h, 05h, 04h, 03h, 02h, 01h, 00h, 07h
    6931/    2550 :                     
    6932/    2550 : =0H                  RLC_or	equ	0
    6933/    2550 : =10H                 RL_or	equ	10h
    6934/    2550 : =20H                 SLA_or	equ	20h
    6935/    2550 : =8H                  RRC_or	equ	08h
    6936/    2550 : =18H                 RR_or	equ	18h
    6937/    2550 : =28H                 SRA_or	equ	28h
    6938/    2550 : =38H                 SRL_or	equ	38h
    6939/    2550 :                     
    6940/    2550 : 06 05 04 03 02 01   SR_base:	db	06h, 05h, 04h, 03h, 02h, 01h, 00h, 07h
             2556 : 00 07             
    6941/    2558 :                     
    6942/    2558 :                     
    6943/    2558 :                     
    6944/    2558 :                     el2_20:	; SRL
    6945/    2558 : 11 3E 38            	ld	de, (SRL_or << 8) | 3Eh
    6946/    255B : C3 7F 25            	jp	sr_lookfor	;jr	sr_lookfor
    6947/    255E :                     el2_19:	; SRA
    6948/    255E : 11 2E 28            	ld	de, (SRA_or << 8) | 2Eh
    6949/    2561 : C3 7F 25            	jp	sr_lookfor	;jr	sr_lookfor
    6950/    2564 :                     el2_18:	; SLA
    6951/    2564 : 11 26 20            	ld	de, (SLA_or << 8) | 26h
    6952/    2567 : C3 7F 25            	jp	sr_lookfor	;jr	sr_lookfor
    6953/    256A :                     el2_17:	; RR
    6954/    256A : 11 1E 18            	ld	de, (RR_or << 8) | 1Eh
    6955/    256D : C3 7F 25            	jp	sr_lookfor	;jr	sr_lookfor
    6956/    2570 :                     el2_13:	; RL
    6957/    2570 : 11 16 10            	ld	de, (RL_or << 8) | 16h
    6958/    2573 : C3 7F 25            	jp	sr_lookfor	;jr	sr_lookfor
    6959/    2576 :                     el2_16:	; RRC
    6960/    2576 : 11 0E 08            	ld	de, (RRC_or << 8) | 0Eh
    6961/    2579 : C3 7F 25            	jp	sr_lookfor	;jr	sr_lookfor
    6962/    257C :                     el2_12:	; RLC
    6963/    257C : 11 06 00            	ld	de, (RLC_or << 8) | 06h
    6964/    257F :                     
    6965/    257F :                     sr_lookfor:
    6966/    257F : 3A 52 9F            	ld	a, (opr1_cd)	; get code number of operand No.1
    6967/    2582 : 21 58 1F            	ld	hl, r_hl_nn
    6968/    2585 : 01 08 00            	ld	bc, sr_num
    6969/    2588 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    6970/    258B : C2 9A 25            	jp	nz, nxt_sr	;jr	nz, nxt_sr
    6971/    258E :                     
    6972/    258E : 21 50 25            	ld	hl, SR_base
    6973/    2591 : 09                  	add	hl, bc
    6974/    2592 : 7E                  	ld	a, (hl)
    6975/    2593 : B2                  	or	d		; make 2nd opcode
    6976/    2594 :                     
    6977/    2594 :                     el2_130:
    6978/    2594 : F5                  	push	af		; adjust I/F
    6979/    2595 : 3E CB               	ld	a, 0cbh		; set OP code
    6980/    2597 : C3 8D 23            	jp	el2_441
    6981/    259A :                     
    6982/    259A :                     nxt_sr:
    6983/    259A : 21 61 1F            	ld	hl, ex_sr_
    6984/    259D : 01 04 00            	ld	bc, ex_sr_num
    6985/    25A0 : CD A4 30            	CALL	CPIR80			;Z80 CODE cpir #################
    6986/    25A3 : C2 3A 1B            	jp	nz, asm_err
    6987/    25A6 :                     
    6988/    25A6 : 16 FD               	ld	d, 0FDh		; for IY
    6989/    25A8 : 79                  	ld	a, c
    6990/    25A9 : FE 02               	cp	2
    6991/    25AB : DA B0 25            	jp	c, sr_iy1	;jr	c, sr_iy1
    6992/    25AE : 16 DD               	ld	d, 0DDh		; for IX
    6993/    25B0 :                     
    6994/    25B0 :                     sr_iy1:	; D: opecode, E : code operand4
    6995/    25B0 :                     
    6996/    25B0 : 21 58 9F            	ld	hl, opr_num37
    6997/    25B3 : 09                  	add	hl, bc
    6998/    25B4 : 4E                  	ld	c, (hl)
    6999/    25B5 : 23                  	inc	hl
    7000/    25B6 : 46                  	ld	b, (hl)
    7001/    25B7 : 3E CB               	ld	a, 0CBH
    7002/    25B9 :                     
    7003/    25B9 :                     mc_end41:
    7004/    25B9 : 2A 4D 9F            	ld	hl, (tasm_adr)
    7005/    25BC : 72                  	ld	(hl), d		; save 1st MC
    7006/    25BD : 23                  	inc	hl
    7007/    25BE : 77                  	ld	(hl), a		; save 2nd MC 
    7008/    25BF : 23                  	inc	hl
    7009/    25C0 : 71                  	ld	(hl), c		; save 3rd MC (8bit litelal)
    7010/    25C1 : 23                  	inc	hl
    7011/    25C2 : 73                  	ld	(hl), e		; save 4th MC
    7012/    25C3 :                     mc_end4:
    7013/    25C3 : 3E 04               	ld	a, 4
    7014/    25C5 : C3 54 22            	jp	mc_end
    7015/    25C8 :                     
    7016/    25C8 :                     ;
    7017/    25C8 :                     ; IM section
    7018/    25C8 :                     ;
    7019/    25C8 :                     el2_54:	; IM
    7020/    25C8 : 3A 55 9F            	ld	a, (opr_num25+1)	; get high byte
    7021/    25CB : B7                  	or	a
    7022/    25CC : C2 3A 1B            	jp	nz, asm_err
    7023/    25CF : 3A 54 9F            	ld	a, (opr_num25)		; get low byte
    7024/    25D2 : FE 03               	cp	3
    7025/    25D4 : D2 3A 1B            	jp	nc, asm_err
    7026/    25D7 :                     
    7027/    25D7 : 0E 46               	ld	c, 046h		; IM 0
    7028/    25D9 : B7                  	or	a
    7029/    25DA : CA E5 25            	jp	z, el2_541	;jr	z, el2_541
    7030/    25DD :                     
    7031/    25DD : 0E 56               	ld	c, 056h		; IM 1
    7032/    25DF : 3D                  	dec	a
    7033/    25E0 : CA E5 25            	jp	z, el2_541	;jr	z, el2_541
    7034/    25E3 : 0E 5E               	ld	c, 05Eh		; IM 2
    7035/    25E5 :                     
    7036/    25E5 :                     el2_541:
    7037/    25E5 : 79                  	ld	a, c
    7038/    25E6 :                     
    7039/    25E6 :                     el2_5411:
    7040/    25E6 : F5                  	push	af		; adjust I/F
    7041/    25E7 : 3E ED               	ld	a, 0EDh		; set MC 1
    7042/    25E9 : C3 8D 23            	jp	el2_441
    7043/    25EC :                     
    7044/    25EC :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    7045/    25EC :                     ; get opecode
    7046/    25EC :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    7047/    25EC :                     analize_input:
    7048/    25EC : CD D9 26            	call	sch_opecode
    7049/    25EF : D8                  	ret	c		; error return
    7050/    25F0 : 32 51 9F            	ld	(opc_cd), a	; save code number of opecode
    7051/    25F3 : CD 3E 26            	call	inc_element
    7052/    25F6 :                     
    7053/    25F6 : 7E                  	ld	a, (hl)
    7054/    25F7 : B7                  	or	a
    7055/    25F8 : C8                  	ret	z		; no operand
    7056/    25F9 : FE 20               	cp	a, ' '		; check opecode delimiter
    7057/    25FB : C2 3C 26            	jp	nz, sx_err	; not space then syntax error
    7058/    25FE :                     
    7059/    25FE :                     	; get code of operand 1
    7060/    25FE :                     
    7061/    25FE : CD 46 26            	call	analize_opr
    7062/    2601 : D8                  	ret	c		; error
    7063/    2602 : 32 52 9F            	ld	(opr1_cd), a	; save operand code to opr1
    7064/    2605 : E5                  	PUSH	HL			;#### ADDED ####################
    7065/    2606 : F5                  	PUSH	AF			;Z80 CODE EX	AF,AF' #########
    7066/    2607 : 2A 9E 9F            	LD	HL,(alt_AF)		;###############################
    7067/    260A : E5                  	PUSH	HL			;###############################
    7068/    260B : F1                  	POP	AF			;###############################
    7069/    260C : E1                  	POP	HL			;###############################
    7070/    260D : 22 9E 9F            	LD	(alt_AF),HL		;###############################
    7071/    2610 : E1                  	POP	HL			;###############################
    7072/    2611 : CD 3E 26            	call	inc_element
    7073/    2614 : E5                  	PUSH	HL			;#### ADDED ####################
    7074/    2615 : F5                  	PUSH	AF			;Z80 CODE EX	AF,AF' #########
    7075/    2616 : 2A 9E 9F            	LD	HL,(alt_AF)		;###############################
    7076/    2619 : E5                  	PUSH	HL			;###############################
    7077/    261A : F1                  	POP	AF			;###############################
    7078/    261B : E1                  	POP	HL			;###############################
    7079/    261C : 22 9E 9F            	LD	(alt_AF),HL		;###############################
    7080/    261F : E1                  	POP	HL			;###############################
    7081/    2620 : FE 26               	cp	38		; check operand code 38:='"'
    7082/    2622 : C8                  	ret	z
    7083/    2623 : 7E                  	ld	a, (hl)
    7084/    2624 : B7                  	or	a
    7085/    2625 : C8                  	ret	z		; no operand2
    7086/    2626 : FE 2C               	cp	a, ','		; check opecode delimiter
    7087/    2628 : C2 3C 26            	jp	nz, sx_err	;jr	nz, sx_err
    7088/    262B :                     
    7089/    262B :                     	; get code of operand 2
    7090/    262B :                     
    7091/    262B : CD 46 26            	call	analize_opr
    7092/    262E : D8                  	ret	c		; error
    7093/    262F : 32 53 9F            	ld	(opr2_cd), a	; save operand code to opr1
    7094/    2632 : CD 3E 26            	call	inc_element
    7095/    2635 :                     
    7096/    2635 : 7E                  	ld	a, (hl)
    7097/    2636 : B7                  	or	a
    7098/    2637 : C2 3C 26            	jp	nz, sx_err	;jr	nz, sx_err	; error end
    7099/    263A : C9                  	ret
    7100/    263B :                     
    7101/    263B :                     an_err:
    7102/    263B : F1                  	pop	af
    7103/    263C :                     sx_err:
    7104/    263C : 37                  	scf
    7105/    263D : C9                  	ret
    7106/    263E :                     
    7107/    263E :                     inc_element:
    7108/    263E : 3A 4F 9F            	ld	a, (element_cnt)
    7109/    2641 : 3C                  	inc	a
    7110/    2642 : 32 4F 9F            	ld	(element_cnt), a
    7111/    2645 : C9                  	ret
    7112/    2646 :                     
    7113/    2646 :                     ;------------------------
    7114/    2646 :                     ; HL : input buffer
    7115/    2646 :                     ;------------------------
    7116/    2646 :                     analize_opr:
    7117/    2646 : 23                  	inc	hl		; HL : top of operand strings point
    7118/    2647 : CD CD 26            	call	sch_operand1
    7119/    264A : D0                  	ret	nc		; match, then retrun
    7120/    264B :                     	
    7121/    264B :                     	; search (IX+, (IY+, (IX-, (IY-
    7122/    264B :                     
    7123/    264B : CD D3 26            	call	sch_operand1_1
    7124/    264E : DA 9B 26            	jp	c, nxt_a1	;jr	c, nxt_a1	; jump, in not match
    7125/    2651 :                     
    7126/    2651 :                     	; analize "nn)"
    7127/    2651 :                     
    7128/    2651 : F5                  	push	af		; save operand code
    7129/    2652 : CD 08 27            	call	get_number	; DE : binary
    7130/    2655 : DA 3B 26            	jp	c, an_err
    7131/    2658 :                     	
    7132/    2658 : 7A                  	ld	a, d
    7133/    2659 : B7                  	or	a
    7134/    265A : C2 3B 26            	jp	nz, an_err	;jr	nz, an_err	; over 255
    7135/    265D :                     	
    7136/    265D : 7E                  	ld	a, (hl)
    7137/    265E : FE 29               	cp	')'
    7138/    2660 : C2 3B 26            	jp	nz, an_err	;jr	nz, an_err
    7139/    2663 :                     
    7140/    2663 : 23                  	inc	hl
    7141/    2664 : F1                  	pop	af		; restore operand code
    7142/    2665 :                     
    7143/    2665 : F5                  	push	af
    7144/    2666 : FE 21               	cp 	33		; IX+?
    7145/    2668 : C2 71 26            	jp	nz, nxt_a2	;jr	nz, nxt_a2
    7146/    266B : 01 5B 9F            	ld	bc, opr_num33
    7147/    266E : C3 79 26            	jp	nxt_a21		;jr	nxt_a21
    7148/    2671 :                     
    7149/    2671 :                     nxt_a2:
    7150/    2671 : FE 22               	cp 	34		; IY+?
    7151/    2673 : C2 82 26            	jp	nz, nxt_a3	;jr	nz, nxt_a3
    7152/    2676 : 01 59 9F            	ld	bc, opr_num34
    7153/    2679 :                     
    7154/    2679 :                     nxt_a21:
    7155/    2679 : 7B                  	ld	a, e
    7156/    267A : FE 80               	cp	80H
    7157/    267C : D2 3B 26            	jp	nc, an_err	;jr	nc, an_err
    7158/    267F :                     
    7159/    267F :                     nxt_a22:
    7160/    267F : 02                  	ld	(bc),a		; save binary
    7161/    2680 : F1                  	pop	af
    7162/    2681 : C9                  	ret
    7163/    2682 :                     	
    7164/    2682 :                     nxt_a3:
    7165/    2682 : FE 24               	cp 	36		; IX-?
    7166/    2684 : C2 95 26            	jp	nz, nxt_a4	;jr	nz, nxt_a4
    7167/    2687 : 01 5A 9F            	ld	bc, opr_num36
    7168/    268A :                     
    7169/    268A :                     nxt_a31:
    7170/    268A : 7B                  	ld	a, e
    7171/    268B : FE 81               	cp	81H
    7172/    268D : D2 3B 26            	jp	nc, an_err	;jr	nc, an_err
    7173/    2690 : 2F                  	CPL				;Z80 CODE neg
    7174/    2691 : 3C                  	INC	A			;flags may be wrong, it's OK here
    7175/    2692 : C3 7F 26            	jp	nxt_a22		;jr	nxt_a22
    7176/    2695 :                     	
    7177/    2695 :                     nxt_a4:	; IY-
    7178/    2695 : 01 58 9F            	ld	bc, opr_num37
    7179/    2698 : C3 8A 26            	jp	nxt_a31		;jr	nxt_a31
    7180/    269B :                     
    7181/    269B :                     ; check '('
    7182/    269B :                     nxt_a1:
    7183/    269B : 7E                  	ld	a, (hl)
    7184/    269C : FE 28               	cp	'('
    7185/    269E : C2 B5 26            	jp	nz, chk_strings	;jr	nz, chk_strings
    7186/    26A1 :                     	
    7187/    26A1 :                     	; get number
    7188/    26A1 :                     	
    7189/    26A1 : 23                  	inc	hl
    7190/    26A2 : CD 08 27            	call	get_number
    7191/    26A5 : D8                  	ret	c		; error number
    7192/    26A6 :                     
    7193/    26A6 : 7E                  	ld	a, (hl)
    7194/    26A7 : FE 29               	cp	')'
    7195/    26A9 : C2 3C 26            	jp	nz, sx_err	;jr	nz, sx_err
    7196/    26AC :                     
    7197/    26AC : 23                  	inc	hl
    7198/    26AD : EB                  	ex	de,hl			;z80 code ld	(opr_num35),de	; save binary
    7199/    26AE : 22 56 9F            	ld	(opr_num35),hl		;#######################################
    7200/    26B1 : EB                  	ex	de,hl			;#######################################
    7201/    26B2 : 3E 23               	ld	a, 35		; set operand code
    7202/    26B4 : C9                  	ret			; normal end
    7203/    26B5 :                     
    7204/    26B5 :                     chk_strings:
    7205/    26B5 : FE 22               	cp	'"'
    7206/    26B7 : C2 C1 26            	jp	nz, only_num	;jr	nz, only_num
    7207/    26BA : 23                  	inc	hl
    7208/    26BB : 22 54 9F            	ld	(opr_num25), hl
    7209/    26BE : 3E 26               	ld	a, 38
    7210/    26C0 : C9                  	ret
    7211/    26C1 :                     
    7212/    26C1 :                     only_num:
    7213/    26C1 : CD 08 27            	call	get_number
    7214/    26C4 : D8                  	ret	c		; error number
    7215/    26C5 : EB                  	ex	de,hl			;z80 code ld	(opr_num25),de	; save binary
    7216/    26C6 : 22 54 9F            	ld	(opr_num25),hl		;#######################################
    7217/    26C9 : EB                  	ex	de,hl			;#######################################
    7218/    26CA : 3E 19               	ld	a, 25		; set operand code
    7219/    26CC : C9                  	ret			; normal end
    7220/    26CD :                     
    7221/    26CD :                     ;------------------
    7222/    26CD :                     ; HL : input buffer
    7223/    26CD :                     ;------------------
    7224/    26CD :                     sch_operand1:
    7225/    26CD : 11 4C 1A            	ld	de, operand_cds
    7226/    26D0 : C3 DF 26            	jp	sh_0		;jr	sh_0
    7227/    26D3 :                     
    7228/    26D3 :                     ;------------------
    7229/    26D3 :                     ; HL : input buffer
    7230/    26D3 :                     ; search (IX+, (IY+, (IX-, (IY-
    7231/    26D3 :                     ;------------------
    7232/    26D3 :                     sch_operand1_1:
    7233/    26D3 : 11 AC 1A            	ld	de, opr_cd1
    7234/    26D6 : C3 DF 26            	jp	sh_0		;jr	sh_0		;	sh_0
    7235/    26D9 :                     
    7236/    26D9 :                     ;----------------------------------------------------------
    7237/    26D9 :                     ; Search code number of opecode from input strings
    7238/    26D9 :                     ; 
    7239/    26D9 :                     ; output:
    7240/    26D9 :                     ; if mach opecode ; HL : next point of input strings
    7241/    26D9 :                     ;		    A  : a code number of opecode
    7242/    26D9 :                     ; not mach	  ; CF = 1
    7243/    26D9 :                     ;----------------------------------------------------------
    7244/    26D9 :                     sch_opecode:
    7245/    26D9 : 21 74 9F            	ld	hl, line_buf
    7246/    26DC : 11 2F 19            	ld	de, ope_cds
    7247/    26DF :                     
    7248/    26DF :                     sh_0:
    7249/    26DF : E5                  	push	hl
    7250/    26E0 :                     sh_1:
    7251/    26E0 : 1A                  	ld	a, (de)
    7252/    26E1 : BE                  	cp	(hl)
    7253/    26E2 : C2 EA 26            	jp	nz, sch_next	;jr	nz, sch_next
    7254/    26E5 :                     	
    7255/    26E5 :                     	; match
    7256/    26E5 : 23                  	inc	hl
    7257/    26E6 : 13                  	inc	de
    7258/    26E7 : C3 E0 26            	jp	sh_1		;jr	sh_1
    7259/    26EA :                     
    7260/    26EA :                     sch_next:
    7261/    26EA : E6 80               	and	dm_bit		; delimiter?
    7262/    26EC : C2 00 27            	jp	nz, ok_match	;jr	nz, ok_match
    7263/    26EF :                     	
    7264/    26EF :                     skip_next:
    7265/    26EF : 13                  	inc	de
    7266/    26F0 : 1A                  	ld	a, (de)
    7267/    26F1 : E6 80               	and	dm_bit
    7268/    26F3 : CA EF 26            	jp	z, skip_next	;jr	z, skip_next
    7269/    26F6 :                     
    7270/    26F6 :                     	; detect delimiter string
    7271/    26F6 :                     
    7272/    26F6 : 13                  	inc	de		; next search strings
    7273/    26F7 :                     	
    7274/    26F7 : 1A                  	ld	a, (de)
    7275/    26F8 : B7                  	or	a		; tabel end?
    7276/    26F9 : CA 05 27            	jp	z, n_end	;jr	z, n_end	; yes, no match return
    7277/    26FC :                     
    7278/    26FC : E1                  	pop	hl
    7279/    26FD : C3 DF 26            	jp	sh_0		;jr	sh_0		; search again
    7280/    2700 :                     
    7281/    2700 :                     	; match opecode strings
    7282/    2700 :                     	; a : opecode number
    7283/    2700 :                     
    7284/    2700 :                     ok_match:
    7285/    2700 : 1A                  	ld	a, (de)
    7286/    2701 : E6 7F               	and	a, 7Fh		; mask dm_bit, get code of opecode
    7287/    2703 : D1                  	pop	de		; discard top string address
    7288/    2704 : C9                  	ret
    7289/    2705 :                     	
    7290/    2705 :                     ; no opecode strings maching
    7291/    2705 :                     n_end:
    7292/    2705 : E1                  	pop	hl
    7293/    2706 : 37                  	scf
    7294/    2707 : C9                  	ret
    7295/    2708 :                     
    7296/    2708 :                     ;---------------------
    7297/    2708 :                     ; HL : string buffer
    7298/    2708 :                     ;
    7299/    2708 :                     ; output : de or CF
    7300/    2708 :                     ;----------------------
    7301/    2708 :                     get_number:
    7302/    2708 :                     
    7303/    2708 : 11 97 9F            	ld	de, num_string
    7304/    270B : 0E 00               	ld	c, 0
    7305/    270D :                     	
    7306/    270D :                     ; check first character
    7307/    270D :                     
    7308/    270D : CD 65 27            	call	dec_chr		; check decimal chrarcter
    7309/    2710 : D8                  	ret	c		; no number inputs detect
    7310/    2711 :                     
    7311/    2711 :                     ;  detect 1st number( only 0 to 9 )
    7312/    2711 :                     
    7313/    2711 : 12                  	ld	(de), a		; save to buffer
    7314/    2712 : 13                  	inc	de
    7315/    2713 : 23                  	inc	hl
    7316/    2714 : 0C                  	inc	c
    7317/    2715 :                     
    7318/    2715 :                     ; check 2nd, 3rd, 4th, 5th number string
    7319/    2715 :                     
    7320/    2715 :                     lop_gnum:
    7321/    2715 : CD 70 27            	call	hex_chr
    7322/    2718 : DA 28 27            	jp	c, ck_endmk	;jr	c, ck_endmk	; no number inputs detect
    7323/    271B :                     
    7324/    271B :                     ; detect 2nd, 3rd, 4th, 5th number (include A to F)
    7325/    271B :                     
    7326/    271B : 12                  	ld	(de), a		; save to buffer
    7327/    271C : 13                  	inc	de
    7328/    271D : 23                  	inc	hl
    7329/    271E : 0C                  	inc	c
    7330/    271F : 79                  	ld	a, c
    7331/    2720 : FE 07               	cp	NUMLEN		; buffer check
    7332/    2722 : CA 6E 27            	jp	z, no_num	;jr	z, no_num	; overfllow. error return
    7333/    2725 : C3 15 27            	jp	lop_gnum	;jr	lop_gnum
    7334/    2728 :                     
    7335/    2728 :                     ck_endmk:
    7336/    2728 : E5                  	PUSH	HL			;#### ADDED ####################
    7337/    2729 : F5                  	PUSH	AF			;Z80 CODE EX	AF,AF' #########
    7338/    272A : 2A 9E 9F            	LD	HL,(alt_AF)		;###############################
    7339/    272D : E5                  	PUSH	HL			;###############################
    7340/    272E : F1                  	POP	AF			;###############################
    7341/    272F : E1                  	POP	HL			;###############################
    7342/    2730 : 22 9E 9F            	LD	(alt_AF),HL		;###############################
    7343/    2733 : E1                  	POP	HL			;###############################
    7344/    2734 : AF                  	xor	a
    7345/    2735 : 12                  	ld	(de), a		; set delimiter
    7346/    2736 : E5                  	PUSH	HL			;#### ADDED ####################
    7347/    2737 : F5                  	PUSH	AF			;Z80 CODE EX	AF,AF' #########
    7348/    2738 : 2A 9E 9F            	LD	HL,(alt_AF)		;###############################
    7349/    273B : E5                  	PUSH	HL			;###############################
    7350/    273C : F1                  	POP	AF			;###############################
    7351/    273D : E1                  	POP	HL			;###############################
    7352/    273E : 22 9E 9F            	LD	(alt_AF),HL		;###############################
    7353/    2741 : E1                  	POP	HL			;###############################
    7354/    2742 : FE 48               	cp	'H'		; check hex?
    7355/    2744 : CA 52 27            	jp	z, bi_hex	;jr	z, bi_hex
    7356/    2747 :                     
    7357/    2747 :                     ;	get binary from decimal string
    7358/    2747 :                     ;bi_dec:
    7359/    2747 : E5                  	push	hl
    7360/    2748 : 21 97 9F            	ld	hl, num_string
    7361/    274B : CD 38 02            	call	GET_dNUM	; return bc
    7362/    274E : E1                  	pop	hl
    7363/    274F : 50                  	ld	d, b		; set binary to DE
    7364/    2750 : 59                  	ld	e, c		; set binary to DE
    7365/    2751 : C9                  	ret
    7366/    2752 :                     
    7367/    2752 :                     ;	ret	nc		; if CF =1, try hex to bin
    7368/    2752 :                     ;	dec	hl		; adjust hl pointer
    7369/    2752 :                     
    7370/    2752 :                     	;hex to binary
    7371/    2752 :                     bi_hex:
    7372/    2752 : 23                  	inc	hl
    7373/    2753 : E5                  	push	hl
    7374/    2754 : 21 97 9F            	ld	hl, num_string
    7375/    2757 : CD 4C 29            	call	RDHEX		; get binary to DE
    7376/    275A : E1                  	pop	hl
    7377/    275B : B7                  	or	a		; clear CF
    7378/    275C : C9                  	ret
    7379/    275D :                     
    7380/    275D :                     ;--------------------------
    7381/    275D :                     ; skip sp
    7382/    275D :                     ;--------------------------
    7383/    275D :                     skp_sp:
    7384/    275D : 7E                  	ld	a, (hl)
    7385/    275E : FE 20               	cp	' '
    7386/    2760 : C0                  	ret	nz
    7387/    2761 : 23                  	inc	hl
    7388/    2762 : C3 5D 27            	jp	skp_sp		;jr	skp_sp
    7389/    2765 :                     
    7390/    2765 :                     ;--------------------------
    7391/    2765 :                     ; check decimal char
    7392/    2765 :                     ;--------------------------
    7393/    2765 :                     dec_chr:
    7394/    2765 : 7E                  	ld	a, (hl)
    7395/    2766 : FE 3A               	cp	':'
    7396/    2768 : D2 6E 27            	jp	nc, no_num	;jr	nc, no_num
    7397/    276B : FE 30               	cp	'0'
    7398/    276D : D0                  	ret	nc
    7399/    276E :                     	
    7400/    276E : 37                  no_num:	scf
    7401/    276F : C9                  	ret
    7402/    2770 :                     
    7403/    2770 :                     ;--------------------------
    7404/    2770 :                     ; check HEX char
    7405/    2770 :                     ;--------------------------
    7406/    2770 :                     hex_chr:
    7407/    2770 : 7E                  	ld	a, (hl)
    7408/    2771 : FE 30               	cp	'0'
    7409/    2773 : D8                  	ret	c	; error return
    7410/    2774 : FE 3A               	cp	'9'+1
    7411/    2776 : DA 81 27            	jp	c, dec_num	;jr	c, dec_num
    7412/    2779 : FE 41               	cp	'A'
    7413/    277B : D8                  	ret	c	; error return
    7414/    277C : FE 47               	cp	'F'+1
    7415/    277E : D2 6E 27            	jp	nc, no_num	;jr	nc, no_num
    7416/    2781 :                     dec_num:
    7417/    2781 : B7                  	or	a	; clear carry
    7418/    2782 : C9                  	ret
    7419/    2783 :                     
    7420/    2783 :                     ;--------------------------------------
    7421/    2783 :                     ; 2 byte machine code branch
    7422/    2783 :                     ; - 2nd byte is Relative address
    7423/    2783 :                     ; - output a = (e-2) relative number
    7424/    2783 :                     ;          CF=1 : target address error
    7425/    2783 :                     ;--------------------------------------
    7426/    2783 :                     calc_reladr:
    7427/    2783 : E5                  	push	hl
    7428/    2784 : D5                  	push	de
    7429/    2785 :                     
    7430/    2785 : EB                  	ex	de,hl			;z80 code ld	de, (tasm_adr)	; base address
    7431/    2786 : 2A 4D 9F            	ld	hl,(tasm_adr)		;###########################
    7432/    2789 : EB                  	ex	de,hl			;###########################
    7433/    278A : 13                  	inc	de
    7434/    278B : 13                  	inc	de
    7435/    278C : 2A 54 9F            	ld	hl, (opr_num25)	; target address
    7436/    278F : AF                  	xor	a
    7437/    2790 : CD CF 30            	call	sbc_hlde		;z80 coce sbc	hl, de #####
    7438/    2793 : DA A5 27            	jp	c, cal_1	;jr	c, cal_1	; CF=1 :target address is lower
    7439/    2796 :                     
    7440/    2796 : 7C                  	ld	a, h
    7441/    2797 : B7                  	or	a
    7442/    2798 : C2 B5 27            	jp	nz, adr_ovr	;jr	nz, adr_ovr
    7443/    279B :                     
    7444/    279B : 7D                  	ld	a, l
    7445/    279C : FE 80               	cp	80H
    7446/    279E : D2 B5 27            	jp	nc, adr_ovr	;jr	nc, adr_ovr
    7447/    27A1 : B7                  	or	a
    7448/    27A2 :                     
    7449/    27A2 :                     cal_01:
    7450/    27A2 : D1                  	pop	de
    7451/    27A3 : E1                  	pop	hl
    7452/    27A4 : C9                  	ret
    7453/    27A5 :                     
    7454/    27A5 :                     cal_1:
    7455/    27A5 : 7C                  	ld	a, h
    7456/    27A6 : FE FF               	cp	0ffh
    7457/    27A8 : C2 B5 27            	jp	nz, adr_ovr	;jr	nz, adr_ovr
    7458/    27AB : 7D                  	ld	a, l
    7459/    27AC : 2F                  	CPL				;Z80 CODE neg
    7460/    27AD : 3C                  	INC	A			;flags may be wrong, it's OK here
    7461/    27AE : FE 81               	cp	81h
    7462/    27B0 : 7D                  	ld	a, l
    7463/    27B1 : 3F                  	ccf
    7464/    27B2 : C3 A2 27            	jp	cal_01		;jr	cal_01
    7465/    27B5 :                     
    7466/    27B5 :                     adr_ovr:
    7467/    27B5 : 37                  	scf
    7468/    27B6 : C3 A2 27            	jp	cal_01		;jr	cal_01
    7469/    27B9 :                     
    7470/    27B9 :                     ;-----------------------------
    7471/    27B9 :                     ;
    7472/    27B9 :                     ; Recorrect input strings
    7473/    27B9 :                     ;
    7474/    27B9 :                     ;-----------------------------
    7475/    27B9 :                     recorrect:
    7476/    27B9 : E5                  	push	hl
    7477/    27BA : D5                  	push	de
    7478/    27BB : C5                  	push	bc
    7479/    27BC :                     
    7480/    27BC : 21 74 9F            	ld	hl, line_buf
    7481/    27BF : 54                  	ld	d, h
    7482/    27C0 : 5D                  	ld	e, l
    7483/    27C1 :                     
    7484/    27C1 : 0E 20               	ld	c, ' '		; space delimitor. (opecode and operand)
    7485/    27C3 : CD 5D 27            	call	skp_sp
    7486/    27C6 : CD E0 27            	call	recorr
    7487/    27C9 : B7                  	or	a
    7488/    27CA : CA DC 27            	jp	z, gle_end	;jr	z, gle_end
    7489/    27CD :                     
    7490/    27CD : 0E 00               	ld	c, 0		; end delimitor. (end strings)
    7491/    27CF : 23                  	inc	hl
    7492/    27D0 : CD 5D 27            	call	skp_sp
    7493/    27D3 : B7                  	or	a
    7494/    27D4 : CA DA 27            	jp	z, gle_end1	;jr	z, gle_end1
    7495/    27D7 : CD E0 27            	call	recorr
    7496/    27DA :                     
    7497/    27DA :                     gle_end1:
    7498/    27DA : 1B                  	dec	de
    7499/    27DB : 12                  	ld	(de), a		; replace space to 0
    7500/    27DC :                     gle_end:
    7501/    27DC : C1                  	pop	bc
    7502/    27DD : D1                  	pop	de
    7503/    27DE : E1                  	pop	hl
    7504/    27DF : C9                  	ret
    7505/    27E0 :                     
    7506/    27E0 :                     ; extract space from input buffer
    7507/    27E0 :                     recorr:
    7508/    27E0 : 06 00               	ld	b, 0
    7509/    27E2 :                     recorr1:
    7510/    27E2 : 12                  	ld	(de), a
    7511/    27E3 : 13                  	inc	de
    7512/    27E4 : B7                  	or	a
    7513/    27E5 : C8                  	ret	z
    7514/    27E6 : B9                  	cp	c
    7515/    27E7 : C8                  	ret	z
    7516/    27E8 :                     
    7517/    27E8 :                     next_char:
    7518/    27E8 : FE 22               	cp	'"'
    7519/    27EA : C2 09 28            	jp	nz, nxchr	;jr	nz, nxchr
    7520/    27ED :                     
    7521/    27ED : E5                  	PUSH	HL			;#### ADDED ####################
    7522/    27EE : F5                  	PUSH	AF			;Z80 CODE EX	AF,AF' #########
    7523/    27EF : 2A 9E 9F            	LD	HL,(alt_AF)		;###############################
    7524/    27F2 : E5                  	PUSH	HL			;###############################
    7525/    27F3 : F1                  	POP	AF			;###############################
    7526/    27F4 : E1                  	POP	HL			;###############################
    7527/    27F5 : 22 9E 9F            	LD	(alt_AF),HL		;###############################
    7528/    27F8 : E1                  	POP	HL			;###############################
    7529/    27F9 : 78                  	ld	a, b
    7530/    27FA : EE 01               	xor	a, 1
    7531/    27FC : 47                  	ld	b, a		; toggle '"' flag
    7532/    27FD : E5                  	PUSH	HL			;#### ADDED ####################
    7533/    27FE : F5                  	PUSH	AF			;Z80 CODE EX	AF,AF' #########
    7534/    27FF : 2A 9E 9F            	LD	HL,(alt_AF)		;###############################
    7535/    2802 : E5                  	PUSH	HL			;###############################
    7536/    2803 : F1                  	POP	AF			;###############################
    7537/    2804 : E1                  	POP	HL			;###############################
    7538/    2805 : 22 9E 9F            	LD	(alt_AF),HL		;###############################
    7539/    2808 : E1                  	POP	HL			;###############################
    7540/    2809 :                     ;"	
    7541/    2809 :                     nxchr:
    7542/    2809 : 23                  	inc	hl
    7543/    280A : 7E                  	ld	a, (hl)
    7544/    280B : B9                  	cp	c
    7545/    280C : CA E2 27            	jp	z, recorr1	;jr	z, recorr1
    7546/    280F : 32 9F 9F            	ld	(alt_A),a	;z80 code bit	0, b ##################
    7547/    2812 : 78                  	ld	a,b		;######################################
    7548/    2813 : E6 01               	and	1		;######################################
    7549/    2815 : 3A 9F 9F            	ld	a,(alt_A)	;######################################
    7550/    2818 : C2 E2 27            	jp	nz, recorr1	;jr	nz, recorr1
    7551/    281B :                     
    7552/    281B : FE 20               	cp	' '
    7553/    281D : CA E8 27            	jp	z, next_char	;jr	z, next_char
    7554/    2820 : C3 E2 27            	jp	recorr1		;jr	recorr1
    7555/    2823 :                     
    7556/    2823 :                     ;;;
    7557/    2823 :                     ;;; Other support routines
    7558/    2823 :                     ;;;
    7559/    2823 :                     
    7560/    2823 :                     STROUT:
    7561/    2823 : 7E                  	LD	A,(HL)
    7562/    2824 : A7                  	AND	A
    7563/    2825 : C8                  	RET	Z
    7564/    2826 : CD F9 30            	CALL	CONOUT
    7565/    2829 : 23                  	INC	HL
    7566/    282A : C3 23 28            	JP	STROUT		;JR	STROUT
    7567/    282D :                     
    7568/    282D :                     ; input:  HL
    7569/    282D :                     ; output: 4 hex_char output console
    7570/    282D :                     
    7571/    282D :                     HEXOUT4:
    7572/    282D : 7C                  	LD	A,H
    7573/    282E : CD 32 28            	CALL	HEXOUT2
    7574/    2831 : 7D                  	LD	A,L
    7575/    2832 :                     
    7576/    2832 :                     ; input:  A
    7577/    2832 :                     ; output: 2 hex_char output console
    7578/    2832 :                     HEXOUT2:
    7579/    2832 : F5                  	PUSH	AF
    7580/    2833 : 1F                  	RRA
    7581/    2834 : 1F                  	RRA
    7582/    2835 : 1F                  	RRA
    7583/    2836 : 1F                  	RRA
    7584/    2837 : CD 3B 28            	CALL	HEXOUT1
    7585/    283A : F1                  	POP	AF
    7586/    283B :                     
    7587/    283B :                     ; input:  A
    7588/    283B :                     ; output: 1 hex_char output console
    7589/    283B :                     HEXOUT1:
    7590/    283B : E6 0F               	AND	0FH
    7591/    283D : C6 30               	ADD	A,'0'
    7592/    283F : FE 3A               	CP	'9'+1
    7593/    2841 : DA F9 30            	JP	C,CONOUT
    7594/    2844 : C6 07               	ADD	A,'A'-'9'-1
    7595/    2846 : C3 F9 30            	JP	CONOUT
    7596/    2849 :                     
    7597/    2849 :                     HEXIN:
    7598/    2849 : AF                  	XOR	A
    7599/    284A : CD 51 28            	CALL	HI0
    7600/    284D : 07                  	RLCA
    7601/    284E : 07                  	RLCA
    7602/    284F : 07                  	RLCA
    7603/    2850 : 07                  	RLCA
    7604/    2851 :                     HI0:
    7605/    2851 : C5                  	PUSH	BC
    7606/    2852 : 4F                  	LD	C,A
    7607/    2853 : CD EA 30            	CALL	CONIN
    7608/    2856 : FE 30               	CP	'0'
    7609/    2858 : DA 6F 28            	JP	C,HIR		;JR	C,HIR
    7610/    285B : FE 3A               	CP	'9'+1
    7611/    285D : DA 6C 28            	JP	C,HI1		;JR	C,HI1
    7612/    2860 : FE 41               	CP	'A'
    7613/    2862 : DA 6F 28            	JP	C,HIR		;JR	C,HIR
    7614/    2865 : FE 47               	CP	'F'+1
    7615/    2867 : D2 6F 28            	JP	NC,HIR		;JR	NC,HIR
    7616/    286A : D6 07               	SUB	'A'-'9'-1
    7617/    286C :                     HI1:
    7618/    286C : D6 30               	SUB	'0'
    7619/    286E : B1                  	OR	C
    7620/    286F :                     HIR:
    7621/    286F : C1                  	POP	BC
    7622/    2870 : C9                  	RET
    7623/    2871 :                     	
    7624/    2871 :                     CRLF:
    7625/    2871 : 3E 0D               	LD	A,CR
    7626/    2873 : CD F9 30            	CALL	CONOUT
    7627/    2876 : 3E 0A               	LD	A,LF
    7628/    2878 : C3 F9 30            	JP	CONOUT
    7629/    287B :                     
    7630/    287B :                     CLR_CRT:
    7631/    287B : E5                  	PUSH	HL
    7632/    287C : 21 84 28            	LD	HL, ESC_CRT_CLR
    7633/    287F : CD 23 28            	CALL	STROUT
    7634/    2882 : E1                  	POP	HL
    7635/    2883 : C9                  	RET
    7636/    2884 :                     	
    7637/    2884 :                     ESC_CRT_CLR:
    7638/    2884 : 1B                  	db	01BH
    7639/    2885 : 5B 32               	db	"[2"
    7640/    2887 : 00                  	db	0
    7641/    2888 :                     
    7642/    2888 :                     GETLIN:
    7643/    2888 : 21 74 9F            	LD	HL,INBUF
    7644/    288B : 06 28               	ld	b, BUFLEN
    7645/    288D :                     
    7646/    288D :                     GL0:	; input hl
    7647/    288D :                     
    7648/    288D : D5                  	PUSH	de
    7649/    288E : E5                  	push	hl
    7650/    288F : 58                  	ld	e, b	; E: buffer length
    7651/    2890 : 1D                  	dec	e	; buffer lenght -1
    7652/    2891 : 06 00               	LD	B,0
    7653/    2893 :                     
    7654/    2893 :                     GL00:
    7655/    2893 : CD EA 30            	CALL	CONIN
    7656/    2896 : FE 0D               	CP	CR
    7657/    2898 : CA 09 29            	JP	Z,GLE		;JR	Z,GLE
    7658/    289B : FE 0A               	CP	LF
    7659/    289D : CA 09 29            	JP	Z,GLE		;JR	Z,GLE
    7660/    28A0 : FE 08               	CP	BS
    7661/    28A2 : CA F0 28            	JP	Z,GLB		;JR	Z,GLB
    7662/    28A5 : FE 7F               	CP	DEL
    7663/    28A7 : CA F0 28            	JP	Z,GLB		;JR	Z,GLB
    7664/    28AA : FE 22               	cp	'"'
    7665/    28AC : C2 B9 28            	jp	nz, GL001	;jr	nz, GL001
    7666/    28AF : F5                  	push	af
    7667/    28B0 : 3A 69 9F            	ld	a, (ky_flg)
    7668/    28B3 : EE 04               	xor	NO_UPPER	; toggle UPPER or NO UPPER
    7669/    28B5 : 32 69 9F            	ld	(ky_flg), a
    7670/    28B8 : F1                  	pop	af
    7671/    28B9 :                     
    7672/    28B9 : FE 20               GL001:	CP	' '
    7673/    28BB : DA 93 28            	JP	C,GL00		;JR	C,GL00
    7674/    28BE : FE 80               	CP	80H
    7675/    28C0 : D2 93 28            	JP	NC,GL00		;JR	NC,GL00
    7676/    28C3 : 4F                  	LD	C,A
    7677/    28C4 : 78                  	LD	A,B
    7678/    28C5 : BB                  	CP	e	; buffer full check
    7679/    28C6 : D2 93 28            	JP	NC,GL00		;JR	NC,GL00	; Too long
    7680/    28C9 : 04                  	INC	B
    7681/    28CA : 79                  	LD	A,C
    7682/    28CB : CD F9 30            	CALL	CONOUT
    7683/    28CE : FE 61               	cp	'a'
    7684/    28D0 : DA EB 28            	jp	c, GL1		;jr	c, GL1
    7685/    28D3 : FE 7B               	cp	'z'+1
    7686/    28D5 : D2 EB 28            	jp	nc, GL1		;jr	nc, GL1
    7687/    28D8 :                     
    7688/    28D8 : E5                  	push	hl
    7689/    28D9 : 21 69 9F            	ld	hl, ky_flg
    7690/    28DC : 32 9F 9F            	ld	(alt_A),a	;Z80 code bit	NO_UPPER>>1, (hl)
    7691/    28DF : 7E                  	ld	a,(hl)		;#################################
    7692/    28E0 : E6 04               	and	NO_UPPER	;#################################
    7693/    28E2 : 3A 9F 9F            	ld	a,(alt_A)	;#################################
    7694/    28E5 : C2 EA 28            	jp	nz, skip_upper	;jr	nz, skip_upper
    7695/    28E8 : E6 DF               	and	0DFH	; make upper code
    7696/    28EA :                     skip_upper:
    7697/    28EA : E1                  	pop	hl
    7698/    28EB :                     GL1:
    7699/    28EB : 77                  	LD	(HL),A
    7700/    28EC : 23                  	INC	HL
    7701/    28ED : C3 93 28            	JP	GL00		;JR	GL00
    7702/    28F0 :                     GLB:
    7703/    28F0 : 78                  	LD	A,B
    7704/    28F1 : A7                  	AND	A
    7705/    28F2 : CA 93 28            	JP	Z,GL00		;JR	Z,GL00
    7706/    28F5 : 05                  	DEC	B
    7707/    28F6 : 2B                  	DEC	HL
    7708/    28F7 : 3E 08               	LD	A,08H
    7709/    28F9 : CD F9 30            	CALL	CONOUT
    7710/    28FC : 3E 20               	LD	A,' '
    7711/    28FE : CD F9 30            	CALL	CONOUT
    7712/    2901 : 3E 08               	LD	A,08H
    7713/    2903 : CD F9 30            	CALL	CONOUT
    7714/    2906 : C3 93 28            	JP	GL00		;JR	GL00
    7715/    2909 :                     GLE:
    7716/    2909 : E5                  	push	hl
    7717/    290A : 21 69 9F            	ld	hl, ky_flg
    7718/    290D : 32 9F 9F            	ld	(alt_A),a	;z80 code bit	NO_CR>>1, (hl)
    7719/    2910 : 7E                  	ld	a,(hl)		;################################
    7720/    2911 : E6 01               	and	NO_CR		;################################
    7721/    2913 : 3A 9F 9F            	ld	a,(alt_A)	;################################
    7722/    2916 : C2 1E 29            	jp	nz, skip_cr	;jr	nz, skip_cr
    7723/    2919 : 3E 0D               	ld	a, CR
    7724/    291B : CD F9 30            	call	CONOUT
    7725/    291E :                     skip_cr:
    7726/    291E : 32 9F 9F            	ld	(alt_A),a	;z80 code bit	NO_LF>>1, (hl)
    7727/    2921 : 7E                  	ld	a,(hl)		;################################
    7728/    2922 : E6 02               	and	NO_LF		;################################
    7729/    2924 : 3A 9F 9F            	ld	a,(alt_A)	;################################
    7730/    2927 :                     
    7731/    2927 : C2 2F 29            	jp	nz, skip_lf	;jr	nz, skip_lf
    7732/    292A : 3E 0A               	ld	a, LF
    7733/    292C : CD F9 30            	call	CONOUT
    7734/    292F :                     skip_lf:
    7735/    292F : F5                  	push	af		;z80 code res	NO_UPPER>>1,(HL)	; set upper flag
    7736/    2930 : 7E                  	ld	a,(hl)		;##############################
    7737/    2931 : E6 FB               	and	11111011b	;##############################
    7738/    2933 : 77                  	ld	(hl),a		;##############################
    7739/    2934 : F1                  	pop	af		;##############################
    7740/    2935 : E1                  	pop	hl
    7741/    2936 : 36 00               	LD	(HL),00H
    7742/    2938 :                     
    7743/    2938 : E1                  	pop	hl
    7744/    2939 : D1                  	POP	de
    7745/    293A : C9                  	RET
    7746/    293B :                     
    7747/    293B :                     SKIPSP:
    7748/    293B : 7E                  	LD	A,(HL)
    7749/    293C : FE 20               	CP	' '
    7750/    293E : C0                  	RET	NZ
    7751/    293F : 23                  	INC	HL
    7752/    2940 : C3 3B 29            	JP	SKIPSP		;JR	SKIPSP
    7753/    2943 :                     
    7754/    2943 :                     UPPER:
    7755/    2943 : FE 61               	CP	'a'
    7756/    2945 : D8                  	RET	C
    7757/    2946 : FE 7B               	CP	'z'+1
    7758/    2948 : D0                  	RET	NC
    7759/    2949 : C6 E0               	ADD	A,'A'-'a'
    7760/    294B : C9                  	RET
    7761/    294C :                     
    7762/    294C :                     RDHEX:
    7763/    294C : 0E 00               	LD	C,0
    7764/    294E : 11 00 00            	LD	DE,0
    7765/    2951 :                     RH0:
    7766/    2951 : 7E                  	LD	A,(HL)
    7767/    2952 : FE 30               	CP	'0'
    7768/    2954 : DA 99 29            	JP	C,RHE		;JR	C,RHE
    7769/    2957 : FE 3A               	CP	'9'+1
    7770/    2959 : DA 68 29            	JP	C,RH1		;JR	C,RH1
    7771/    295C : FE 41               	CP	'A'
    7772/    295E : DA 99 29            	JP	C,RHE		;JR	C,RHE
    7773/    2961 : FE 47               	CP	'F'+1
    7774/    2963 : D2 99 29            	JP	NC,RHE		;JR	NC,RHE
    7775/    2966 : D6 07               	SUB	'A'-'9'-1
    7776/    2968 :                     RH1:
    7777/    2968 : D6 30               	SUB	'0'
    7778/    296A : 17                  	RLA
    7779/    296B : 17                  	RLA
    7780/    296C : 17                  	RLA
    7781/    296D : 17                  	RLA
    7782/    296E : 17                  	RLA
    7783/    296F : C5                  	PUSH	BC		;###### ADDED ##########################
    7784/    2970 : 47                  	LD	B,A		;## DO NOT USE PUSH AF #################
    7785/    2971 : 7B                  	LD	A,E		;Z80 CODE RL	E ######################
    7786/    2972 : 8B                  	ADC	A,E		;#######################################
    7787/    2973 : 5F                  	LD	E,A		;#######################################
    7788/    2974 : 7A                  	LD	A,D		;Z80 CODE RL	D ######################
    7789/    2975 : 8A                  	ADC	A,D		;#######################################
    7790/    2976 : 57                  	LD	D,A		;#######################################
    7791/    2977 : 78                  	LD	A,B		;#######################################
    7792/    2978 : 17                  	RLA
    7793/    2979 : 47                  	LD	B,A		;#######################################
    7794/    297A : 7B                  	LD	A,E		;Z80 CODE RL	E ######################
    7795/    297B : 8B                  	ADC	A,E		;#######################################
    7796/    297C : 5F                  	LD	E,A		;#######################################
    7797/    297D : 7A                  	LD	A,D		;Z80 CODE RL	D ######################
    7798/    297E : 8A                  	ADC	A,D		;#######################################
    7799/    297F : 57                  	LD	D,A		;#######################################
    7800/    2980 : 78                  	LD	A,B		;#######################################
    7801/    2981 : 17                  	RLA
    7802/    2982 : 47                  	LD	B,A		;#######################################
    7803/    2983 : 7B                  	LD	A,E		;Z80 CODE RL	E ######################
    7804/    2984 : 8B                  	ADC	A,E		;#######################################
    7805/    2985 : 5F                  	LD	E,A		;#######################################
    7806/    2986 : 7A                  	LD	A,D		;Z80 CODE RL	D ######################
    7807/    2987 : 8A                  	ADC	A,D		;#######################################
    7808/    2988 : 57                  	LD	D,A		;#######################################
    7809/    2989 : 78                  	LD	A,B		;#######################################
    7810/    298A : 17                  	RLA
    7811/    298B : 47                  	LD	B,A		;#######################################
    7812/    298C : 7B                  	LD	A,E		;Z80 CODE RL	E ######################
    7813/    298D : 8B                  	ADC	A,E		;#######################################
    7814/    298E : 5F                  	LD	E,A		;#######################################
    7815/    298F : 7A                  	LD	A,D		;Z80 CODE RL	D ######################
    7816/    2990 : 8A                  	ADC	A,D		;#######################################
    7817/    2991 : 57                  	LD	D,A		;#######################################
    7818/    2992 : 78                  	LD	A,B		;## DO NOT USE POP AF ##################
    7819/    2993 : C1                  	POP	BC		;###### ADDED ##########################
    7820/    2994 : 23                  	INC	HL
    7821/    2995 : 0C                  	INC	C
    7822/    2996 : C3 51 29            	JP	RH0		;JR	RH0
    7823/    2999 :                     RHE:
    7824/    2999 : 79                  	ld	a, c
    7825/    299A : B7                  	or	a
    7826/    299B : CA A5 29            	jp	z, rhe1		;jr	z, rhe1
    7827/    299E : FE 05               	cp	5
    7828/    29A0 : D2 A5 29            	jp	nc, rhe1	;jr	nc, rhe1
    7829/    29A3 : B7                  	or	a	; clear carry
    7830/    29A4 : C9                  	ret
    7831/    29A5 :                     	
    7832/    29A5 :                     rhe1:
    7833/    29A5 : 37                  	scf	; set carry
    7834/    29A6 : C9                  	RET
    7835/    29A7 :                     
    7836/    29A7 :                     ;;;
    7837/    29A7 :                     ;;; API Handler
    7838/    29A7 :                     ;;:   C : API entory NO.
    7839/    29A7 :                     ;;;
    7840/    29A7 :                     
    7841/    29A7 :                     RST30H_IN:
    7842/    29A7 :                     
    7843/    29A7 : E5                  	PUSH	HL
    7844/    29A8 : C5                  	PUSH	BC
    7845/    29A9 : 21 C6 29            	LD	HL,APITBL
    7846/    29AC : 06 00               	LD	B,0
    7847/    29AE : 09                  	ADD	HL,BC
    7848/    29AF : 09                  	ADD	HL,BC
    7849/    29B0 :                     
    7850/    29B0 : 01 F2 29            	ld	bc, APITBL_E
    7851/    29B3 : B7                  	or	a
    7852/    29B4 : E5                  	push	hl
    7853/    29B5 : CD B4 30            	call	sbc_hlbc		;Z80 CODE sbc	hl, bc #####
    7854/    29B8 : E1                  	pop	hl
    7855/    29B9 : D2 C3 29            	jp	nc, no_api	;jr	nc, no_api	; request No. is not exist
    7856/    29BC :                     
    7857/    29BC : 46                  	LD	B,(HL)
    7858/    29BD : 23                  	INC	HL
    7859/    29BE : 66                  	LD	H,(HL)
    7860/    29BF : 68                  	LD	L,B
    7861/    29C0 :                     
    7862/    29C0 : C1                  	POP	BC
    7863/    29C1 : E3                  	EX	(SP),HL		; Restore HL, jump address on stack top
    7864/    29C2 :                     no_operate:
    7865/    29C2 : C9                  	RET
    7866/    29C3 :                     
    7867/    29C3 :                     no_api:
    7868/    29C3 : C1                  	pop	bc
    7869/    29C4 : E1                  	pop	hl
    7870/    29C5 : C9                  	ret
    7871/    29C6 :                     
    7872/    29C6 :                     APITBL:
    7873/    29C6 : 43 00               	DW	CSTART		; 00: CSTART
    7874/    29C8 : F2 29               	DW	API01		; 01: WSTART
    7875/    29CA : F9 30               	DW	CONOUT		; 02: CONOUT
    7876/    29CC : 23 28               	DW	STROUT		; 03: STROUT
    7877/    29CE : EA 30               	DW	CONIN		; 04: CONIN
    7878/    29D0 : F4 30               	DW	CONST		; 05: CONST
    7879/    29D2 : 39 2A               	DW	API06		; 06: PSPEC
    7880/    29D4 : 2D 28               	DW	HEXOUT4		; 07: CONOUT HEX4bytes: input HL
    7881/    29D6 : 32 28               	DW	HEXOUT2		; 08: CONOUT HEX2bytes: input A
    7882/    29D8 : 3B 28               	DW	HEXOUT1		; 09: CONOUT HEX1byte : input A
    7883/    29DA : 7B 28               	DW	CLR_CRT		; 10: Clear screen (ESC+[2)
    7884/    29DC : 8D 28               	DW	GL0		; 11: GET a line.  input HL : input buffer address)
    7885/    29DE :                     				;                         B : buffer length
    7886/    29DE :                     				;                  output B : length of strings
    7887/    29DE : 3B 29               	DW	SKIPSP		; 12: SKIP Spase
    7888/    29E0 : 71 28               	DW	CRLF		; 13: CONOUT CRLF
    7889/    29E2 : 43 29               	DW	UPPER		; 14: Lower to UPPER
    7890/    29E4 : 4C 29               	DW	RDHEX		; 15: get hex number from chr buffer
    7891/    29E6 :                     				;     input  HL : hex string buffer
    7892/    29E6 :                     				;     output DE : hex number
    7893/    29E6 :                     				;            CF=1 : error, C, A = hex counts(1-4)
    7894/    29E6 : 5D 2B               	DW	DEC_STR		; 16: get decimal srtings
    7895/    29E8 :                     				; input hl : return strings buffer addr.
    7896/    29E8 :                     				;       de : 16bit binary
    7897/    29E8 : 9B 2B               	DW	DIV16_8		; 17; division 16bit / 8bit
    7898/    29EA : 25 2C               	DW	MUL_8		; 18: multiply 8bit * 8bit
    7899/    29EC : =>FALSE              	IF RAM12K
    7900/    29EC :                     	DW	STOPW		; 19: stopwatch
    7901/    29EC : =>TRUE               	ELSE
    7902/    29EC : C2 29               	DW	no_operate	; 19: no operation : if RAM12K=0
    7903/    29EE : [7899]               	ENDIF
    7904/    29EE : 17 09               	dw	get_disasm_st	; 20: dis assemble string
    7905/    29F0 :                     				;     input: HL buffer. need 42bytes
    7906/    29F0 :                     				;     output : DE : next MC address
    7907/    29F0 :                     				;              A  : disassembled MC size
    7908/    29F0 : 38 02               	dw	GET_dNUM	; 21: get number from decimal strings
    7909/    29F2 :                     				;     input HL : string buffer
    7910/    29F2 :                     				;     Return
    7911/    29F2 :                     				;        CF =1 : Error
    7912/    29F2 :                     				;        BC: Calculation result
    7913/    29F2 :                     APITBL_E:
    7914/    29F2 :                     
    7915/    29F2 :                     	;; WSTART from API
    7916/    29F2 :                     API01:
    7917/    29F2 : 31 00 9F            	LD	SP,STACKM	; reset SP for monitor
    7918/    29F5 :                     
    7919/    29F5 :                     ; check stop by bp and trace operation
    7920/    29F5 :                     
    7921/    29F5 : 3A 47 9F            	ld	a, (tmpb_f)
    7922/    29F8 : B7                  	or	a
    7923/    29F9 : CA 02 2A            	jp	z, ws_chk1	;jr	z, ws_chk1
    7924/    29FC : 21 48 9F            	ld	hl, tmpb_op
    7925/    29FF : CD 15 2B            	call	rstr_tpt
    7926/    2A02 :                     ws_chk1:
    7927/    2A02 : 3A 37 9F            	ld	a, (tpt1_f)
    7928/    2A05 : B7                  	or	a
    7929/    2A06 : CA 0F 2A            	jp	z, ws_chk2	;jr	z, ws_chk2
    7930/    2A09 : 21 38 9F            	ld	hl, tpt1_op
    7931/    2A0C : CD 15 2B            	call	rstr_tpt
    7932/    2A0F :                     
    7933/    2A0F :                     ws_chk2:
    7934/    2A0F : 3A 3B 9F            	ld	a, (tpt2_f)
    7935/    2A12 : B7                  	or	a
    7936/    2A13 : CA 1C 2A            	jp	z, ws_chk3	;jr	z, ws_chk3
    7937/    2A16 : 21 3C 9F            	ld	hl, tpt2_op
    7938/    2A19 : CD 15 2B            	call	rstr_tpt
    7939/    2A1C :                     ws_chk3:
    7940/    2A1C : 3A 43 9F            	ld	a, (bpt2_f)
    7941/    2A1F : B7                  	or	a
    7942/    2A20 : CA 29 2A            	jp	z, ws_chk4	;jr	z, ws_chk4
    7943/    2A23 : 21 44 9F            	ld	hl, bpt2_op
    7944/    2A26 : CD 21 2B            	call	rstr_bpt
    7945/    2A29 :                     ws_chk4:
    7946/    2A29 : 3A 3F 9F            	ld	a, (bpt1_f)
    7947/    2A2C : B7                  	or	a
    7948/    2A2D : CA 36 2A            	jp	z, ws_chk5	;jr	z, ws_chk5
    7949/    2A30 : 21 40 9F            	ld	hl, bpt1_op
    7950/    2A33 : CD 21 2B            	call	rstr_bpt
    7951/    2A36 :                     ws_chk5:
    7952/    2A36 : C3 EA 2A            	JP	backTomon
    7953/    2A39 :                     
    7954/    2A39 :                     	;; PSPEC
    7955/    2A39 :                     API06:
    7956/    2A39 : AF                  	XOR	A
    7957/    2A3A : C9                  	RET
    7958/    2A3B :                     
    7959/    2A3B :                     ;;;
    7960/    2A3B :                     ;;; Break Point
    7961/    2A3B :                     ;;; trace Point
    7962/    2A3B :                     ;;; go, stop point
    7963/    2A3B :                     ;;; operation handler
    7964/    2A3B :                     ;;
    7965/    2A3B :                     RST38H_IN:
    7966/    2A3B : F5                  	PUSH	AF
    7967/    2A3C :                     ;	LD	A,R			;Z80 CODE ignore now ###########
    7968/    2A3C :                     ;	LD	(REGR),A		;## save R reister ignore now ##
    7969/    2A3C :                     ;	LD	A,I			;Z80 CODE ignore now ###########
    7970/    2A3C :                     ;	LD	(REGI),A		;## save I reister ignore now ##
    7971/    2A3C : 22 12 9F            	LD	(REGHL),HL
    7972/    2A3F : 62                  	LD	H,D			;Z80 CODE LD	(REGDE),DE #####
    7973/    2A40 : 6B                  	LD	L,E			;Z80 CODE LD	(REGDE),DE #####
    7974/    2A41 : 22 10 9F            	LD	(REGDE),HL		;## HL destroyed it's ok here ##
    7975/    2A44 : 60                  	LD	H,B			;Z80 CODE LD	(REGBC),BC #####
    7976/    2A45 : 69                  	LD	L,C			;Z80 CODE LD	(REGBC),BC #####
    7977/    2A46 : 22 0E 9F            	LD	(REGBC),HL		;## HL destroyed it's ok here ##
    7978/    2A49 : E1                  	POP	HL
    7979/    2A4A : 22 0C 9F            	LD	(REGAF),HL
    7980/    2A4D :                     ;	EX	AF,AF'			;Z80 CODE ignore now ###########
    7981/    2A4D :                     ;	PUSH	AF
    7982/    2A4D :                     ;	EXX				;Z80 CODE ignore now ###########
    7983/    2A4D :                     ;	LD	(REGHLX),HL		;# save HL' reister ignore now #
    7984/    2A4D :                     ;	LD	(REGDEX),DE		;# save DE' reister ignore now #
    7985/    2A4D :                     ;	LD	(REGBCX),BC		;# save BC' reister ignore now #
    7986/    2A4D :                     ;	POP	HL			;# save AF' reister ignore now #
    7987/    2A4D :                     ;	LD	(REGAFX),HL		;# save AF' reister ignore now #
    7988/    2A4D :                     ;	LD	(REGIX),IX		;Z80 CODE ignore now ###########
    7989/    2A4D :                     ;	LD	(REGIY),IY		;Z80 CODE ignore now ###########
    7990/    2A4D : E1                  	POP	HL
    7991/    2A4E : 2B                  	DEC	HL
    7992/    2A4F : 22 22 9F            	LD	(REGPC),HL
    7993/    2A52 : 21 00 00            	LD	HL,0			;Z80 CODE LD	(REGSP),SP #####
    7994/    2A55 : 39                  	ADD	HL,SP			;Z80 CODE LD	(REGSP),SP #####
    7995/    2A56 : 22 20 9F            	LD	(REGSP),HL		;## HL destroyed it's ok here ##
    7996/    2A59 :                     
    7997/    2A59 :                     ; check bp and trace operation
    7998/    2A59 :                     
    7999/    2A59 : 31 00 9F            	LD	SP,STACKM	; reset SP for monitor
    8000/    2A5C : AF                  	xor	a
    8001/    2A5D : 57                  	ld	d, a
    8002/    2A5E : 5F                  	ld	e, a		;clear msg pointer
    8003/    2A5F :                     
    8004/    2A5F :                     
    8005/    2A5F :                     ; check go, end operation
    8006/    2A5F : 3A 47 9F            	ld	a, (tmpb_f)
    8007/    2A62 : B7                  	or	a
    8008/    2A63 : CA 6F 2A            	jp	z, chk_bp	;jr	z, chk_bp
    8009/    2A66 : 11 4B 2B            	ld	de, stpBrk_msg
    8010/    2A69 : 21 48 9F            	ld	hl, tmpb_op
    8011/    2A6C : CD 15 2B            	call	rstr_tpt
    8012/    2A6F :                     
    8013/    2A6F :                     ; check set break point
    8014/    2A6F :                     
    8015/    2A6F :                     chk_bp:
    8016/    2A6F : 3A 43 9F            	ld	a, (bpt2_f)
    8017/    2A72 : B7                  	or	a
    8018/    2A73 : CA 7F 2A            	jp	z, bp_chk1	;jr	z, bp_chk1
    8019/    2A76 : 11 4B 2B            	ld	de, stpBrk_msg
    8020/    2A79 : 21 44 9F            	ld	hl, bpt2_op
    8021/    2A7C : CD 21 2B            	call	rstr_bpt
    8022/    2A7F :                     
    8023/    2A7F :                     bp_chk1:
    8024/    2A7F : 3A 3F 9F            	ld	a, (bpt1_f)
    8025/    2A82 : B7                  	or	a
    8026/    2A83 : CA 8F 2A            	jp	z, tp_chk1	;jr	z, tp_chk1
    8027/    2A86 : 11 4B 2B            	ld	de, stpBrk_msg
    8028/    2A89 : 21 40 9F            	ld	hl, bpt1_op
    8029/    2A8C : CD 21 2B            	call	rstr_bpt
    8030/    2A8F :                     
    8031/    2A8F :                     ; check trace operation
    8032/    2A8F :                     tp_chk1:
    8033/    2A8F : 3A 37 9F            	ld	a, (tpt1_f)
    8034/    2A92 : B7                  	or	a
    8035/    2A93 : CA 9F 2A            	jp	z, tp_chk2	;jr	z, tp_chk2
    8036/    2A96 : 11 54 2B            	ld	de, trace_msg
    8037/    2A99 : 21 38 9F            	ld	hl, tpt1_op
    8038/    2A9C : CD 15 2B            	call	rstr_tpt
    8039/    2A9F :                     
    8040/    2A9F :                     tp_chk2:
    8041/    2A9F : 3A 3B 9F            	ld	a, (tpt2_f)
    8042/    2AA2 : B7                  	or	a
    8043/    2AA3 : CA AF 2A            	jp	z, bp_chk_end	;jr	z, bp_chk_end
    8044/    2AA6 :                     
    8045/    2AA6 : 11 54 2B            	ld	de, trace_msg
    8046/    2AA9 : 21 3C 9F            	ld	hl, tpt2_op
    8047/    2AAC : CD 15 2B            	call	rstr_tpt
    8048/    2AAF :                     
    8049/    2AAF :                     bp_chk_end:
    8050/    2AAF : 7A                  	ld	a, d
    8051/    2AB0 : B3                  	or	e
    8052/    2AB1 : C2 B7 2A            	jp	nz, no_rst38_msg	;jr	nz, no_rst38_msg
    8053/    2AB4 :                     
    8054/    2AB4 :                     	; set RST 38H message
    8055/    2AB4 : 11 41 2B            	LD	de,RST38MSG
    8056/    2AB7 :                     
    8057/    2AB7 :                     no_rst38_msg:
    8058/    2AB7 : 1A                  	ld	a, (de)		; get first char of message
    8059/    2AB8 : FE 54               	cp	'T'		; trace ?
    8060/    2ABA : CA CA 2A            	jp	z, chk_ntrace	;jr	z, chk_ntrace
    8061/    2ABD :                     	
    8062/    2ABD : EB                  	ex	de, hl
    8063/    2ABE : CD 23 28            	CALL	STROUT
    8064/    2AC1 :                     
    8065/    2AC1 :                     	;; R register adjustment
    8066/    2AC1 :                     
    8067/    2AC1 : CD 98 18            	CALL	RDUMP
    8068/    2AC4 : CD 28 2B            	call	dis_call	; list disassemble
    8069/    2AC7 : C3 EA 2A            	jp	backTomon	;jr	backTomon	; goto WBOOT
    8070/    2ACA :                     
    8071/    2ACA :                     ;
    8072/    2ACA :                     ; check continue trace operation
    8073/    2ACA :                     ;
    8074/    2ACA :                     chk_ntrace:
    8075/    2ACA : 3A 30 9F            	ld	a, (TP_mode)
    8076/    2ACD : FE 46               	cp	'F'		; chk
    8077/    2ACF : CA DC 2A            	jp	z, skp_rmsg	;jr	z, skp_rmsg
    8078/    2AD2 :                     
    8079/    2AD2 :                     ;no_trace:
    8080/    2AD2 : EB                  	ex	de, hl
    8081/    2AD3 : CD 23 28            	CALL	STROUT
    8082/    2AD6 :                     
    8083/    2AD6 :                     	;; R register adjustment
    8084/    2AD6 :                     
    8085/    2AD6 : CD 98 18            	CALL	RDUMP
    8086/    2AD9 : CD 28 2B            	call	dis_call	; list disassemble
    8087/    2ADC :                     
    8088/    2ADC :                     skp_rmsg:
    8089/    2ADC : CD F4 30            	call	CONST
    8090/    2ADF : CA F6 2A            	jp	z, t_no_ky	;jr	z, t_no_ky		; no key in
    8091/    2AE2 : CD EA 30            	call	CONIN
    8092/    2AE5 : FE 03               	cp	03h	; chk CTL+C
    8093/    2AE7 : C2 F6 2A            	jp	nz, t_no_ky	;jr	nz, t_no_ky
    8094/    2AEA :                     
    8095/    2AEA :                     	; stop_trace
    8096/    2AEA :                     backTomon:
    8097/    2AEA : AF                  	xor	a
    8098/    2AEB : 32 36 9F            	ld	(fever_t), a	; clear forever flag
    8099/    2AEE : 67                  	ld	h, a
    8100/    2AEF : 6F                  	ld	l, a
    8101/    2AF0 : 22 32 9F            	ld	(TC_cnt), hl
    8102/    2AF3 : C3 CD 00            	JP	WSTART
    8103/    2AF6 :                     	
    8104/    2AF6 :                     	; check trace forever
    8105/    2AF6 :                     t_no_ky:
    8106/    2AF6 : 3A 36 9F            	ld	a, (fever_t)
    8107/    2AF9 : B7                  	or	a
    8108/    2AFA : C2 0C 2B            	jp	nz, repeat_trace
    8109/    2AFD :                     
    8110/    2AFD : 2A 32 9F            	ld	hl, (TC_cnt)
    8111/    2B00 : 2B                  	dec	hl
    8112/    2B01 : 22 32 9F            	ld	(TC_cnt), hl
    8113/    2B04 : 7D                  	ld	a, l
    8114/    2B05 : B4                  	or	h
    8115/    2B06 : C2 0C 2B            	jp	nz, repeat_trace	;jr	nz, repeat_trace
    8116/    2B09 : C3 CD 00            	JP	WSTART
    8117/    2B0C :                     
    8118/    2B0C :                     repeat_trace:
    8119/    2B0C : 2A 22 9F            	ld	hl, (REGPC)
    8120/    2B0F : 22 34 9F            	ld	(tmpT), hl
    8121/    2B12 : C3 A0 04            	jp	t_op_chk
    8122/    2B15 :                     
    8123/    2B15 :                     rstr_tpt:	; HL=buffer point
    8124/    2B15 : E5                  	push	hl
    8125/    2B16 : 7E                  	ld	a, (hl)
    8126/    2B17 : 23                  	inc	hl
    8127/    2B18 : 4E                  	ld	c, (hl)
    8128/    2B19 : 23                  	inc	hl
    8129/    2B1A : 46                  	ld	b, (hl)
    8130/    2B1B :                     
    8131/    2B1B : 02                  	ld	(bc), a		; restor OP CODE
    8132/    2B1C : E1                  	pop	hl
    8133/    2B1D : AF                  	xor	a
    8134/    2B1E : 2B                  	dec	hl
    8135/    2B1F : 77                  	ld	(hl), a		; clear trace flag
    8136/    2B20 : C9                  	ret
    8137/    2B21 :                     
    8138/    2B21 :                     rstr_bpt:	; HL=buffer point
    8139/    2B21 : 7E                  	ld	a, (hl)
    8140/    2B22 : 23                  	inc	hl
    8141/    2B23 : 4E                  	ld	c, (hl)
    8142/    2B24 : 23                  	inc	hl
    8143/    2B25 : 46                  	ld	b, (hl)
    8144/    2B26 :                     
    8145/    2B26 : 02                  	ld	(bc), a		; restor OP CODE
    8146/    2B27 : C9                  	ret
    8147/    2B28 :                     
    8148/    2B28 :                     dis_call:
    8149/    2B28 : 2A 22 9F            	ld	hl, (REGPC)
    8150/    2B2B : 22 6D 9F            	ld	(dasm_adr), hl	; set disasm address
    8151/    2B2E : CD 7D 09            	call	dis_analysis
    8152/    2B31 : CD 3D 09            	call	mk_adr_str	; conout address and machine code
    8153/    2B34 : 21 74 9F            	ld	hl, adr_mc_buf
    8154/    2B37 : CD 23 28            	call	STROUT		; conout disassemble strings
    8155/    2B3A : 2A 22 9F            	ld	hl, (REGPC)
    8156/    2B3D : 22 6D 9F            	ld	(dasm_adr), hl	; restrore disasm address
    8157/    2B40 : C9                  	ret
    8158/    2B41 :                     
    8159/    2B41 :                     RST38MSG:
    8160/    2B41 : 52 53 54 20 33 38   	DB	"RST 38H",CR,LF,00H
             2B47 : 48 0D 0A 00       
    8161/    2B4B :                     stpBrk_msg:	
    8162/    2B4B : 42 72 65 61 6B 21   	db	"Break!",CR,LF,00H
             2B51 : 0D 0A 00          
    8163/    2B54 :                     trace_msg:	
    8164/    2B54 : 54 72 61 63 65 21   	db	"Trace!",CR,LF,00H
             2B5A : 0D 0A 00          
    8165/    2B5D :                     
    8166/    2B5D : =>FALSE              	IF RAM12K
    8167/    2B5D :                     STOPW:
    8168/    2B5D :                     	; (input) A = 0 : start timer, (output) none
    8169/    2B5D :                     	; (input) A = 1 : stop timer,  (output) BC : msec time, DE : Sec time
    8170/    2B5D :                     	; (input) A = 2 : lap timer,   (output) BC : msec time, DE : Sec time
    8171/    2B5D :                     	; (input) A = 3 : clear timer counter,  (output) none
    8172/    2B5D :                     
    8173/    2B5D :                     	push	af
    8174/    2B5D :                     	push	hl
    8175/    2B5D :                     	or	a
    8176/    2B5D :                     	jp	z, start_tim	;jr	z, start_tim
    8177/    2B5D :                     	cp	1
    8178/    2B5D :                     	jp	z, stop_tim	;jr	z, stop_tim
    8179/    2B5D :                     	cp	2
    8180/    2B5D :                     	jp	z, lap_tim	;jr	z, lap_tim
    8181/    2B5D :                     	cp	3
    8182/    2B5D :                     	jp	z, clr_tim	;jr	z, clr_tim
    8183/    2B5D :                     	pop	hl
    8184/    2B5D :                     	pop	af
    8185/    2B5D :                     	ret
    8186/    2B5D :                     
    8187/    2B5D :                     start_tim:
    8188/    2B5D :                     	ld	hl, TIM0_CTL0
    8189/    2B5D :                     	ld	a, 90h
    8190/    2B5D :                     	ld	(hl),a		; enable timer 0
    8191/    2B5D :                     	pop	hl
    8192/    2B5D :                     	pop	af
    8193/    2B5D :                     	ret
    8194/    2B5D :                     	
    8195/    2B5D :                     stop_tim:
    8196/    2B5D :                     	ld	hl, TIM0_CTL0
    8197/    2B5D :                     	ld	a, 10h
    8198/    2B5D :                     	ld	(hl), a		; disable timer 0
    8199/    2B5D :                     
    8200/    2B5D :                     	; save timer counter
    8201/    2B5D :                     
    8202/    2B5D :                     lap_tim:
    8203/    2B5D :                     	ld	a, (TIMER0_CNTL)
    8204/    2B5D :                     	ld	(c16b), a
    8205/    2B5D :                     	ld	a, (TIMER0_CNTH)
    8206/    2B5D :                     	ld	(c16b+1), a
    8207/    2B5D :                     
    8208/    2B5D :                     ; adjust 16bit counter
    8209/    2B5D :                     
    8210/    2B5D :                     	ld	bc, TIMER0_INITC
    8211/    2B5D :                     	ld	hl, (c16b)
    8212/    2B5D :                     	ld	a, h
    8213/    2B5D :                     	or	l	; HL = 0?
    8214/    2B5D :                     	jp	nz, adj_tim1	;jr	nz, adj_tim1
    8215/    2B5D :                     	ld	(c16b), bc
    8216/    2B5D :                     	jp	rd_sec		:jr	rd_sec
    8217/    2B5D :                     
    8218/    2B5D :                     adj_tim1:
    8219/    2B5D :                     	call	sbc_hlbc		;Z80 code sbc hl, bc###########
    8220/    2B5D :                     	ld	(c16b), hl
    8221/    2B5D :                     
    8222/    2B5D :                     ; read seconds counter
    8223/    2B5D :                     
    8224/    2B5D :                     rd_sec:
    8225/    2B5D :                     	ld	a, (TIMER0_SCTL)
    8226/    2B5D :                     	ld	(secb), a
    8227/    2B5D :                     	ld	a, (TIMER0_SCTH)
    8228/    2B5D :                     	ld	(secb+1), a
    8229/    2B5D :                     
    8230/    2B5D :                     	; convert msec from 16bit counter
    8231/    2B5D :                     
    8232/    2B5D :                     	ld	hl,(c16b)
    8233/    2B5D :                     	call	chg_msec	; result BC
    8234/    2B5D :                     	ld	(msecb),bc	; save result
    8235/    2B5D :                     	ld	de,(secb)	; get sec counter
    8236/    2B5D :                     	pop	hl
    8237/    2B5D :                     	pop	af
    8238/    2B5D :                     	ret
    8239/    2B5D :                     
    8240/    2B5D :                     clr_tim:
    8241/    2B5D :                     	xor	a
    8242/    2B5D :                     	ld	h, a
    8243/    2B5D :                     	ld	l, a
    8244/    2B5D :                     	ld	(msecb), hl
    8245/    2B5D :                     	ld	(secb), hl
    8246/    2B5D :                     	ld	(c16b), hl
    8247/    2B5D :                     	
    8248/    2B5D :                     	ld	(TIMER0_SCTL), a
    8249/    2B5D :                     	ld	(TIMER0_SCTH), a
    8250/    2B5D :                     	ld	a, 0e8h
    8251/    2B5D :                     	ld	(TIMER0_CNTL), a
    8252/    2B5D :                     	ld	a, 86H
    8253/    2B5D :                     	ld	(TIMER0_CNTH), a
    8254/    2B5D :                     	pop	hl
    8255/    2B5D :                     	pop	af
    8256/    2B5D :                     	ret
    8257/    2B5D :                     
    8258/    2B5D :                     chg_msec:
    8259/    2B5D :                     	xor	a
    8260/    2B5D :                     	ld	b, a
    8261/    2B5D :                     	ld	c ,a		;cear BC
    8262/    2B5D :                     	ld	hl, (c16b)	; get 16bit counter
    8263/    2B5D :                     	ld	a, l
    8264/    2B5D :                     u_00:
    8265/    2B5D :                     	cp	31
    8266/    2B5D :                     	jp	c, u_1		;jr	c, u_1
    8267/    2B5D :                     	sub	31
    8268/    2B5D :                     u_0:
    8269/    2B5D :                     	ld	l, a
    8270/    2B5D :                     	inc	bc
    8271/    2B5D :                     	jp	u_00		;jr	u_00
    8272/    2B5D :                     
    8273/    2B5D :                     u_1:
    8274/    2B5D :                     	ld	a, h
    8275/    2B5D :                     	or	a
    8276/    2B5D :                     	ret	z	; can't sub
    8277/    2B5D :                     
    8278/    2B5D :                     	ld	a, l
    8279/    2B5D :                     	sub	31
    8280/    2B5D :                     	CPL				;Z80 CODE neg
    8281/    2B5D :                     	INC	A			;flags may be wrong, it's OK here
    8282/    2B5D :                     	dec	h
    8283/    2B5D :                     	jp	u_0		;jr	u_0
    8284/    2B5D :                     
    8285/    2B5D : [8166]               	ENDIF
    8286/    2B5D :                     
    8287/    2B5D :                     ;
    8288/    2B5D :                     ; make decimal string
    8289/    2B5D :                     ;
    8290/    2B5D :                     ; input HL : output string buffer
    8291/    2B5D :                     ;       DE : 16bit binary
    8292/    2B5D :                     ;
    8293/    2B5D :                     ; output (HL) : decimal strings
    8294/    2B5D :                     
    8295/    2B5D :                     DEC_STR:
    8296/    2B5D : F5                  	PUSH	AF
    8297/    2B5E : C5                  	PUSH	BC
    8298/    2B5F : D5                  	PUSH	DE
    8299/    2B60 : E5                  	push	hl
    8300/    2B61 :                     ;	push	ix			;Z80 CODE NOT TRANSLATED YET
    8301/    2B61 :                     
    8302/    2B61 : 22 A0 9F            	LD	(tmp_HL),HL		;push	hl
    8303/    2B64 :                     ;	pop	ix			;Z80 CODE NOT TRANSLATED YET; ix: save buffer top address
    8304/    2B64 :                     
    8305/    2B64 : EB                  	ex	de, hl		; hl: 16bit binary, de: buffer
    8306/    2B65 : E5                  	push	hl		; save 16bit binary
    8307/    2B66 : 21 05 00            	ld	hl, 5
    8308/    2B69 : 19                  	add	hl, de		; hl = buffer + 5
    8309/    2B6A : AF                  	xor	a
    8310/    2B6B : 77                  	ld	(hl), A
    8311/    2B6C : EB                  	ex	de, hl		; de: buffer + 5, hl : buffer
    8312/    2B6D : E1                  	pop	hl		; hl : 16bit binary
    8313/    2B6E : 01 01 00            	LD	BC, 1
    8314/    2B71 :                     
    8315/    2B71 :                     LOOP_DEC:
    8316/    2B71 : 3E 0A               	LD	A, 10
    8317/    2B73 : CD 9B 2B            	CALL	DIV16_8
    8318/    2B76 : F6 30               	OR	30H
    8319/    2B78 : 1B                  	DEC	DE
    8320/    2B79 : 12                  	LD	(DE), A
    8321/    2B7A : 0C                  	INC	C
    8322/    2B7B : 7C                  	LD	A, H
    8323/    2B7C : B5                  	OR	L
    8324/    2B7D : C2 71 2B            	JP	NZ, LOOP_DEC	;JR	NZ, LOOP_DEC
    8325/    2B80 :                     
    8326/    2B80 : 79                  	LD	A, C
    8327/    2B81 : FE 06               	CP	6
    8328/    2B83 : CA 96 2B            	JP	Z, END_DEC	;JR	Z, END_DEC
    8329/    2B86 :                     
    8330/    2B86 :                     ;	push	ix			;Z80 CODE NOT TRANSLATED YET
    8331/    2B86 : 2A A0 9F            	LD	HL,(tmp_HL)		;pop	hl		; hl : buffer top address
    8332/    2B89 : EB                  	EX	DE, HL
    8333/    2B8A : F5                  	PUSH	AF			;Z80 CODE LDIR
    8334/    2B8B : 7E                  LDIR2:	LD	A,(HL)			;###############################
    8335/    2B8C : 12                  	LD	(DE),A			;###############################
    8336/    2B8D : 23                  	INC	HL			;###############################
    8337/    2B8E : 13                  	INC	DE			;###############################
    8338/    2B8F : 0B                  	DEC	BC			;###############################
    8339/    2B90 : 79                  	LD	A,C			;###############################
    8340/    2B91 : B0                  	OR	B			;###############################
    8341/    2B92 : C2 8B 2B            	JP	NZ,LDIR2		;###############################
    8342/    2B95 : F1                  	POP	AF			;###############################
    8343/    2B96 :                     
    8344/    2B96 :                     END_DEC:
    8345/    2B96 :                     ;	pop	ix			;Z80 CODE NOT TRANSLATED YET
    8346/    2B96 : E1                  	pop	hl
    8347/    2B97 : D1                  	POP	DE
    8348/    2B98 : C1                  	POP	BC
    8349/    2B99 : F1                  	POP	AF
    8350/    2B9A : C9                  	RET
    8351/    2B9B :                     
    8352/    2B9B :                     
    8353/    2B9B :                     ; DIV 16bit / 8 bit
    8354/    2B9B :                     ; input
    8355/    2B9B :                     ;	HL, A
    8356/    2B9B :                     ; output
    8357/    2B9B :                     ;	result = HL, mod = A
    8358/    2B9B :                     
    8359/    2B9B :                     DIV16_8:
    8360/    2B9B : C5                  	PUSH	BC
    8361/    2B9C : D5                  	PUSH	DE
    8362/    2B9D :                     
    8363/    2B9D : 4F                  	LD	C, A
    8364/    2B9E : 06 0F               	LD	B, 15
    8365/    2BA0 : AF                  	XOR	A
    8366/    2BA1 : 29                  	ADD	HL, HL
    8367/    2BA2 : 17                  	RLA
    8368/    2BA3 : 91                  	SUB	C
    8369/    2BA4 : DA B7 2B            	JP	C, D16_MINUS_BEFORE	;JR	C, D16_MINUS_BEFORE
    8370/    2BA7 : 29                  	ADD	HL, HL
    8371/    2BA8 : 2C                  	INC	L
    8372/    2BA9 :                     
    8373/    2BA9 :                     D16_PLUS:
    8374/    2BA9 : 17                  	RLA
    8375/    2BAA : 91                  	SUB	C
    8376/    2BAB : DA BD 2B            	JP	C, D16_MINUS_AFTER	;JR	C, D16_MINUS_AFTER
    8377/    2BAE :                     
    8378/    2BAE :                     D16_PLUS_AFTER:
    8379/    2BAE : 29                  	ADD	HL, HL
    8380/    2BAF : 2C                  	INC	L
    8381/    2BB0 : 05                  	DEC	B		;Z80 CODE #####	DJNZ	D16_PLUS
    8382/    2BB1 : C2 A9 2B            	JP	NZ,d16_PLUS	;###############################
    8383/    2BB4 : C3 C3 2B            	JP	D16_END
    8384/    2BB7 :                     
    8385/    2BB7 :                     D16_MINUS_BEFORE:
    8386/    2BB7 : 29                  	ADD	HL, HL
    8387/    2BB8 :                     
    8388/    2BB8 :                     D16_MINUS:
    8389/    2BB8 : 17                  	RLA
    8390/    2BB9 : 81                  	ADD	A, C
    8391/    2BBA : DA AE 2B            	JP	C, D16_PLUS_AFTER	;JR	C, D16_PLUS_AFTER
    8392/    2BBD :                     
    8393/    2BBD :                     D16_MINUS_AFTER:
    8394/    2BBD : 29                  	ADD	HL, HL
    8395/    2BBE : 05                  	DEC	B		;Z80 CODE #####	DJNZ	D16_MINUS
    8396/    2BBF : C2 B8 2B            	JP	NZ,D16_MINUS	;#################################
    8397/    2BC2 : 81                  	ADD	A,C
    8398/    2BC3 :                     D16_END:
    8399/    2BC3 : D1                  	POP	DE
    8400/    2BC4 : C1                  	POP	BC
    8401/    2BC5 : C9                  	RET
    8402/    2BC6 :                     
    8403/    2BC6 :                     ;
    8404/    2BC6 :                     ; input : HL / DE
    8405/    2BC6 :                     ; output : quotient HL
    8406/    2BC6 :                     ;	   remainder DE
    8407/    2BC6 :                     
    8408/    2BC6 :                     DIV16:
    8409/    2BC6 : 22 26 9F            	LD	(DIV16_NA), HL
    8410/    2BC9 : EB                  	EX	HL,DE			;Z80 CODE LD	(DIV16_NB), DE
    8411/    2BCA : 22 28 9F            	LD	(DIV16_NB),HL		;###############################
    8412/    2BCD : EB                  	EX	HL,DE			;###############################
    8413/    2BCE :                     
    8414/    2BCE : AF                  	XOR	A
    8415/    2BCF : 32 2A 9F            	LD	(DIV16_NC), A
    8416/    2BD2 : 32 2B 9F            	LD	(DIV16_NC+1), A
    8417/    2BD5 : 32 2C 9F            	LD	(DIV16_ND), A
    8418/    2BD8 : 32 2D 9F            	LD	(DIV16_ND+1), A
    8419/    2BDB : 06 10               	LD	B, 16
    8420/    2BDD :                     
    8421/    2BDD :                     DIV16_X2:
    8422/    2BDD : 21 2A 9F            	LD	HL, DIV16_NC
    8423/    2BE0 : 7E                  	LD	A,(HL)			;Z80 CODE SLA	(HL) ###########
    8424/    2BE1 : 87                  	ADD	A,A			;###############################
    8425/    2BE2 : 77                  	LD	(HL),A			;###############################
    8426/    2BE3 : 23                  	INC	HL
    8427/    2BE4 : 7E                  	LD	A,(HL)			;Z80 CODE RL	(HL) ###########
    8428/    2BE5 : 8F                  	ADC	A,A			;###############################
    8429/    2BE6 : 77                  	LD	(HL),A			;###############################
    8430/    2BE7 :                     
    8431/    2BE7 : 21 26 9F            	LD	HL, DIV16_NA
    8432/    2BEA : 7E                  	LD	A,(HL)			;Z80 CODE SLA	(HL) ###########
    8433/    2BEB : 87                  	ADD	A,A			;###############################
    8434/    2BEC : 77                  	LD	(HL),A			;###############################
    8435/    2BED : 23                  	INC	HL
    8436/    2BEE : 7E                  	LD	A,(HL)			;Z80 CODE RL	(HL) ###########
    8437/    2BEF : 8F                  	ADC	A,A			;###############################
    8438/    2BF0 : 77                  	LD	(HL),A			;###############################
    8439/    2BF1 : 21 2C 9F            	LD	HL, DIV16_ND
    8440/    2BF4 : 7E                  	LD	A,(HL)			;Z80 CODE RL	(HL) ###########
    8441/    2BF5 : 8F                  	ADC	A,A			;###############################
    8442/    2BF6 : 77                  	LD	(HL),A			;###############################
    8443/    2BF7 : 23                  	INC	HL
    8444/    2BF8 : 7E                  	LD	A,(HL)			;Z80 CODE RL	(HL) ###########
    8445/    2BF9 : 8F                  	ADC	A,A			;###############################
    8446/    2BFA : 77                  	LD	(HL),A			;###############################
    8447/    2BFB :                     
    8448/    2BFB : 2A 28 9F            	LD	HL, (DIV16_NB)
    8449/    2BFE : 5D                  	LD	E, L
    8450/    2BFF : 54                  	LD	D, H
    8451/    2C00 : 2A 2C 9F            	LD	HL, (DIV16_ND)
    8452/    2C03 : AF                  	XOR	A
    8453/    2C04 : CD CF 30            	call	sbc_hlde		;Z80 CODE SBC	HL,DE ##########
    8454/    2C07 : D2 0D 2C            	JP	NC, DIV16_X0	;JR	NC, DIV16_X0
    8455/    2C0A : C3 18 2C            	JP	DIV16_X1	;JR	DIV16_X1
    8456/    2C0D :                     
    8457/    2C0D :                     DIV16_X0:
    8458/    2C0D : 22 2C 9F            	LD	(DIV16_ND), HL
    8459/    2C10 :                     
    8460/    2C10 : 3A 2A 9F            	LD	A, (DIV16_NC)
    8461/    2C13 : F6 01               	OR	1
    8462/    2C15 : 32 2A 9F            	LD	(DIV16_NC), A
    8463/    2C18 :                     
    8464/    2C18 :                     DIV16_X1:
    8465/    2C18 : 05                  	DEC	B			;Z80 CODE DJNZ	DIV16_X2 #######
    8466/    2C19 : C2 DD 2B            	JP	NZ,DIV16_X2		;###############################
    8467/    2C1C : 2A 2C 9F            	LD	HL,(DIV16_ND)		;Z80 COCE LD	DE,(DIV16_ND) ##
    8468/    2C1F : 54                  	LD	D,H			;## HL desttoyed it's ok here ##
    8469/    2C20 : 5D                  	LD	E,L			;## HL desttoyed it's ok here ##
    8470/    2C21 : 2A 2A 9F            	LD	HL,(DIV16_NC)
    8471/    2C24 : C9                  	RET
    8472/    2C25 :                     
    8473/    2C25 :                     ; 8bit * 8bit : ans = 16bit
    8474/    2C25 :                     ; input A , BC
    8475/    2C25 :                     ; output HL
    8476/    2C25 :                     
    8477/    2C25 :                     MUL_8:
    8478/    2C25 : F5                  	PUSH	AF
    8479/    2C26 : C5                  	PUSH	BC
    8480/    2C27 : D5                  	PUSH	DE			;## ADDED ######################
    8481/    2C28 : B7                  	OR	A	; clear carry
    8482/    2C29 : C3 34 2C            	JP	ST_MUL8		;JR	ST_MUL8
    8483/    2C2C :                     
    8484/    2C2C :                     LOOP_M8:
    8485/    2C2C : 57                  	LD	D,A			;##### DO NOT USE PUSH AF ######
    8486/    2C2D : 79                  	LD	A,C			;Z80 CODE SLA	C	########
    8487/    2C2E : 81                  	ADD	A,C			;###############################
    8488/    2C2F : 4F                  	LD	C,A			;###############################
    8489/    2C30 : 78                  	LD	A,B			;Z80 CODE RL	B	########
    8490/    2C31 : 88                  	ADC	A,B			;###############################
    8491/    2C32 : 47                  	LD	B,A			;###############################
    8492/    2C33 : 7A                  	LD	A,D			;##### DO NOT USE POP AF #######
    8493/    2C34 :                     
    8494/    2C34 :                     ST_MUL8:
    8495/    2C34 : 1F                  	RRA
    8496/    2C35 : D2 2C 2C            	JP	NC, LOOP_M8	;JR	NC, LOOP_M8
    8497/    2C38 : 09                  	ADD	HL, BC
    8498/    2C39 : C2 2C 2C            	JP	NZ, LOOP_M8	;JR	NZ, LOOP_M8
    8499/    2C3C : D1                  	POP	DE			;## ADDED ######################
    8500/    2C3D : C1                  	POP	BC
    8501/    2C3E : F1                  	POP	AF
    8502/    2C3F : C9                  	RET
    8503/    2C40 :                     ;;;
    8504/    2C40 :                     ;;; Messages
    8505/    2C40 :                     ;;;
    8506/    2C40 :                     
    8507/    2C40 : 3F 20 3A 43 6F 6D   cmd_hlp:	db	"? :Command Help", CR, LF
             2C46 : 6D 61 6E 64 20 48 
             2C4C : 65 6C 70 0D 0A    
    8508/    2C51 : 23 4C 7C 3C 6E 75   		db	"#L|<num> :Launch program", CR, LF
             2C57 : 6D 3E 20 3A 4C 61 
             2C5D : 75 6E 63 68 20 70 
             2C63 : 72 6F 67 72 61 6D 
             2C69 : 0D 0A             
    8509/    2C6B : 41 5B 3C 61 64 64   		db	"A[<address>] : Mini Assemble mode", CR, LF
             2C71 : 72 65 73 73 3E 5D 
             2C77 : 20 3A 20 4D 69 6E 
             2C7D : 69 20 41 73 73 65 
             2C83 : 6D 62 6C 65 20 6D 
             2C89 : 6F 64 65 0D 0A    
    8510/    2C8E : 42 5B 31 7C 32 5B   		db	"B[1|2[,<adr>]] :Set or List Break Point", CR, LF
             2C94 : 2C 3C 61 64 72 3E 
             2C9A : 5D 5D 20 3A 53 65 
             2CA0 : 74 20 6F 72 20 4C 
             2CA6 : 69 73 74 20 42 72 
             2CAC : 65 61 6B 20 50 6F 
             2CB2 : 69 6E 74 0D 0A    
    8511/    2CB7 : 42 43 5B 31 7C 32   		db	"BC[1|2] :Clear Break Point", CR, LF
             2CBD : 5D 20 3A 43 6C 65 
             2CC3 : 61 72 20 42 72 65 
             2CC9 : 61 6B 20 50 6F 69 
             2CCF : 6E 74 0D 0A       
    8512/    2CD3 : 44 5B 3C 61 64 72   		db	"D[<adr>] :Dump Memory", CR, LF
             2CD9 : 3E 5D 20 3A 44 75 
             2CDF : 6D 70 20 4D 65 6D 
             2CE5 : 6F 72 79 0D 0A    
    8513/    2CEA : 44 49 5B 3C 61 64   		db	"DI[<adr>][,s<steps>|<adr>] :Disassemble", CR, LF
             2CF0 : 72 3E 5D 5B 2C 73 
             2CF6 : 3C 73 74 65 70 73 
             2CFC : 3E 7C 3C 61 64 72 
             2D02 : 3E 5D 20 3A 44 69 
             2D08 : 73 61 73 73 65 6D 
             2D0E : 62 6C 65 0D 0A    
    8514/    2D13 : 47 5B 3C 61 64 72   		db	"G[<adr>][,<stop adr>] :Go and Stop", CR, LF
             2D19 : 3E 5D 5B 2C 3C 73 
             2D1F : 74 6F 70 20 61 64 
             2D25 : 72 3E 5D 20 3A 47 
             2D2B : 6F 20 61 6E 64 20 
             2D31 : 53 74 6F 70 0D 0A 
    8515/    2D37 : 4C 20 3A 4C 6F 61   		db	"L :Load HexFile", CR, LF
             2D3D : 64 20 48 65 78 46 
             2D43 : 69 6C 65 0D 0A    
    8516/    2D48 : 50 5B 49 7C 53 5D   		db	"P[I|S] :Save HexFile(I:Intel,S:Motorola)", CR, LF
             2D4E : 20 3A 53 61 76 65 
             2D54 : 20 48 65 78 46 69 
             2D5A : 6C 65 28 49 3A 49 
             2D60 : 6E 74 65 6C 2C 53 
             2D66 : 3A 4D 6F 74 6F 72 
             2D6C : 6F 6C 61 29 0D 0A 
    8517/    2D72 : 52 5B 3C 72 65 67   		db	"R[<reg>] :Set or Dump register", CR, LF
             2D78 : 3E 5D 20 3A 53 65 
             2D7E : 74 20 6F 72 20 44 
             2D84 : 75 6D 70 20 72 65 
             2D8A : 67 69 73 74 65 72 
             2D90 : 0D 0A             
    8518/    2D92 : 53 5B 3C 61 64 72   		db	"S[<adr>] :Set Memory", CR, LF
             2D98 : 3E 5D 20 3A 53 65 
             2D9E : 74 20 4D 65 6D 6F 
             2DA4 : 72 79 0D 0A       
    8519/    2DA8 : 54 5B 3C 61 64 72   		db	"T[<adr>][,<steps>|-1] : Trace command", CR, LF
             2DAE : 3E 5D 5B 2C 3C 73 
             2DB4 : 74 65 70 73 3E 7C 
             2DBA : 2D 31 5D 20 3A 20 
             2DC0 : 54 72 61 63 65 20 
             2DC6 : 63 6F 6D 6D 61 6E 
             2DCC : 64 0D 0A          
    8520/    2DCF : 54 4D 5B 49 7C 53   		db	"TM[I|S] :Trace Option for CALL", CR, LF
             2DD5 : 5D 20 3A 54 72 61 
             2DDB : 63 65 20 4F 70 74 
             2DE1 : 69 6F 6E 20 66 6F 
             2DE7 : 72 20 43 41 4C 4C 
             2DED : 0D 0A             
    8521/    2DEF : 54 50 5B 4F 4E 7C   		db	"TP[ON|OFF] :Trace Print Mode", CR, LF
             2DF5 : 4F 46 46 5D 20 3A 
             2DFB : 54 72 61 63 65 20 
             2E01 : 50 72 69 6E 74 20 
             2E07 : 4D 6F 64 65 0D 0A 
    8522/    2E0D :                     
    8523/    2E0D :                     OPNMSG:
    8524/    2E0D : 0D 0A               	DB	CR,LF
    8525/    2E0F : 45 4D 55 5A 38 30   	db	"EMUZ80 MONITOR Rev.B03",CR,LF
             2E15 : 20 4D 4F 4E 49 54 
             2E1B : 4F 52 20 52 65 76 
             2E21 : 2E 42 30 33 0D 0A 
    8526/    2E27 : 54 68 69 73 20 6D   	db	"This monitor is based on unimon.",CR,LF,00H
             2E2D : 6F 6E 69 74 6F 72 
             2E33 : 20 69 73 20 62 61 
             2E39 : 73 65 64 20 6F 6E 
             2E3F : 20 75 6E 69 6D 6F 
             2E45 : 6E 2E 0D 0A 00    
    8527/    2E4A :                     
    8528/    2E4A :                     PROMPT:
    8529/    2E4A : 5D 20 00            	DB	"] ",00H
    8530/    2E4D :                     
    8531/    2E4D :                     IHEMSG:
    8532/    2E4D : 45 72 72 6F 72 20   	DB	"Error ihex",CR,LF,00H
             2E53 : 69 68 65 78 0D 0A 
             2E59 : 00                
    8533/    2E5A :                     SHEMSG:
    8534/    2E5A : 45 72 72 6F 72 20   	DB	"Error srec",CR,LF,00H
             2E60 : 73 72 65 63 0D 0A 
             2E66 : 00                
    8535/    2E67 :                     ERRMSG:
    8536/    2E67 : 45 72 72 6F 72 0D   	DB	"Error",CR,LF,00H
             2E6D : 0A 00             
    8537/    2E6F :                     
    8538/    2E6F :                     DSEP0:
    8539/    2E6F : 20 3A 00            	DB	" :",00H
    8540/    2E72 :                     DSEP1:
    8541/    2E72 : 20 7C 20 00         	DB	" | ",00H
    8542/    2E76 :                     
    8543/    2E76 : 20 20 00            dsap	db	"  ", 00
    8544/    2E79 :                     
    8545/    2E79 :                     IHEXER:
    8546/    2E79 : 3A 30 30 30 30 30           DB	":00000001FF",CR,LF,00H
             2E7F : 30 30 31 46 46 0D 
             2E85 : 0A 00             
    8547/    2E87 :                     SRECER:
    8548/    2E87 : 53 39 30 33 30 30           DB	"S9030000FC",CR,LF,00H
             2E8D : 30 30 46 43 0D 0A 
             2E93 : 00                
    8549/    2E94 :                     
    8550/    2E94 :                     	;; Register dump table
    8551/    2E94 : E9 2E 0D 9F         RDTAB:	DW	RDSA,   REGAF+1
    8552/    2E98 : 01                  	DB	1
    8553/    2E99 : ED 2E 0E 9F         	DW	RDSBC,  REGBC
    8554/    2E9D : 02                  	DB	2
    8555/    2E9E : F3 2E 10 9F         	DW	RDSDE,  REGDE
    8556/    2EA2 : 02                  	DB	2
    8557/    2EA3 : F9 2E 12 9F         	DW	RDSHL,  REGHL
    8558/    2EA7 : 02                  	DB	2
    8559/    2EA8 : FF 2E 0C 9F         	DW	RDSF,   REGAF
    8560/    2EAC : 01                  	DB	1
    8561/    2EAD :                     
    8562/    2EAD : 04 2F 1C 9F         	DW	RDSIX,  REGIX
    8563/    2EB1 : 02                  	DB	2
    8564/    2EB2 : 09 2F 1E 9F         	DW	RDSIY,  REGIY
    8565/    2EB6 : 02                  	DB	2
    8566/    2EB7 :                     
    8567/    2EB7 : 0E 2F 15 9F         	DW	RDSAX,  REGAFX+1
    8568/    2EBB : 01                  	DB	1
    8569/    2EBC : 14 2F 16 9F         	DW	RDSBCX, REGBCX
    8570/    2EC0 : 02                  	DB	2
    8571/    2EC1 : 1A 2F 18 9F         	DW	RDSDEX, REGDEX
    8572/    2EC5 : 02                  	DB	2
    8573/    2EC6 : 20 2F 1A 9F         	DW	RDSHLX, REGHLX
    8574/    2ECA : 02                  	DB	2
    8575/    2ECB : 26 2F 14 9F         	DW	RDSFX,  REGAFX
    8576/    2ECF : 01                  	DB	1
    8577/    2ED0 :                     
    8578/    2ED0 : 2B 2F 20 9F         	DW	RDSSP,  REGSP
    8579/    2ED4 : 02                  	DB	2
    8580/    2ED5 : 30 2F 22 9F         	DW	RDSPC,  REGPC
    8581/    2ED9 : 02                  	DB	2
    8582/    2EDA : 35 2F 24 9F         	DW	RDSI,   REGI
    8583/    2EDE : 01                  	DB	1
    8584/    2EDF : 39 2F 25 9F         	DW	RDSR,   REGR
    8585/    2EE3 : 01                  	DB	1
    8586/    2EE4 :                     
    8587/    2EE4 : 00 00 00 00         	DW	0000H,  0000H
    8588/    2EE8 : 00                  	DB	0
    8589/    2EE9 :                     
    8590/    2EE9 : 41 20 3D 00         RDSA:	DB	"A =",00H
    8591/    2EED : 20 42 43 20 3D 00   RDSBC:	DB	" BC =",00H
    8592/    2EF3 : 20 44 45 20 3D 00   RDSDE:	DB	" DE =",00H
    8593/    2EF9 : 20 48 4C 20 3D 00   RDSHL:	DB	" HL =",00H
    8594/    2EFF :                     
    8595/    2EFF : 20 46 20 3D 00      RDSF:	DB	" F =",00H
    8596/    2F04 :                     
    8597/    2F04 : =2EH                 RDSF_H	equ	RDSF >> 8
    8598/    2F04 : =0FFH                RDSF_L	equ	RDSF & 0FFh
    8599/    2F04 :                     
    8600/    2F04 :                     
    8601/    2F04 : 20 49 58 3D 00      RDSIX:	DB	" IX=",00H
    8602/    2F09 : 20 49 59 3D 00      RDSIY:	DB	" IY=",00H
    8603/    2F0E : 0D 0A 41 27 3D 00   RDSAX:	DB	CR,LF,"A'=",00H
    8604/    2F14 : 20 42 43 27 3D 00   RDSBCX:	DB	" BC'=",00H
    8605/    2F1A : 20 44 45 27 3D 00   RDSDEX:	DB	" DE'=",00H
    8606/    2F20 : 20 48 4C 27 3D 00   RDSHLX:	DB	" HL'=",00H
    8607/    2F26 :                     
    8608/    2F26 : 20 46 27 3D 00      RDSFX:	DB	" F'=",00H
    8609/    2F2B :                     
    8610/    2F2B : =2FH                 RDSFX_H	equ	RDSFX >> 8
    8611/    2F2B : =26H                 RDSFX_L	equ	RDSFX & 0FFh
    8612/    2F2B :                     
    8613/    2F2B : 20 53 50 3D 00      RDSSP:	DB	" SP=",00H
    8614/    2F30 : 20 50 43 3D 00      RDSPC:	DB	" PC=",00H
    8615/    2F35 : 20 49 3D 00         RDSI:	DB	" I=",00H
    8616/    2F39 : 20 52 3D 00         RDSR:	DB	" R=",00H
    8617/    2F3D :                     
    8618/    2F3D :                     RNTAB:
    8619/    2F3D : 41 0F               	DB	'A',0FH		; "A?"
    8620/    2F3F : 87 2F 00 00         	DW	RNTABA,0
    8621/    2F43 : 42 0F               	DB	'B',0FH		; "B?"
    8622/    2F45 : 95 2F 00 00         	DW	RNTABB,0
    8623/    2F49 : 43 0F               	DB	'C',0FH		; "C?"
    8624/    2F4B : B7 2F 00 00         	DW	RNTABC,0
    8625/    2F4F : 44 0F               	DB	'D',0FH		; "D?"
    8626/    2F51 : C5 2F 00 00         	DW	RNTABD,0
    8627/    2F55 : 45 0F               	DB	'E',0FH		; "E?"
    8628/    2F57 : E7 2F 00 00         	DW	RNTABE,0
    8629/    2F5B : 46 0F               	DB	'F',0FH		; "F?"
    8630/    2F5D : F5 2F 00 00         	DW	RNTABF,0
    8631/    2F61 : 48 0F               	DB	'H',0FH		; "H?"
    8632/    2F63 : 03 30 00 00         	DW	RNTABH,0
    8633/    2F67 : 49 0F               	DB	'I',0FH		; "I?"
    8634/    2F69 : 33 30 00 00         	DW	RNTABI,0
    8635/    2F6D : 4C 0F               	DB	'L',0FH		; "L?"
    8636/    2F6F : 25 30 00 00         	DW	RNTABL,0
    8637/    2F73 : 50 0F               	DB	'P',0FH		; "P?"
    8638/    2F75 : 47 30 00 00         	DW	RNTABP,0
    8639/    2F79 : 52 01               	DB	'R',1		; "R"
    8640/    2F7B : 25 9F A2 30         	DW	REGR,RNR
    8641/    2F7F : 53 0F               	DB	'S',0FH		; "S?"
    8642/    2F81 : 4F 30 00 00         	DW	RNTABS,0
    8643/    2F85 :                     
    8644/    2F85 : 00 00               	DB	00H,0		; End mark
    8645/    2F87 :                     
    8646/    2F87 :                     RNTABA:
    8647/    2F87 : 00 01               	DB	00H,1		; "A"
    8648/    2F89 : 0D 9F 57 30         	DW	REGAF+1,RNA
    8649/    2F8D : 27 01               	DB	27H,1		; "A'"
    8650/    2F8F :                     ;;	DB	'\'',1		; "A'"
    8651/    2F8F : 15 9F 70 30         	DW	REGAFX+1,RNAX
    8652/    2F93 :                     
    8653/    2F93 : 00 00               	DB	00H,0
    8654/    2F95 :                     	
    8655/    2F95 :                     RNTABB:
    8656/    2F95 : 00 01               	DB	00H,1		; "B"
    8657/    2F97 : 0F 9F 5C 30         	DW	REGBC+1,RNB
    8658/    2F9B : 27 01               	DB	27H,1		; "B'"
    8659/    2F9D :                     ;;	DB	'\'',1		; "B'"
    8660/    2F9D : 17 9F 77 30         	DW	REGBCX+1,RNBX
    8661/    2FA1 : 43 0F               	DB	'C',0FH		; "BC?"
    8662/    2FA3 : A9 2F 00 00         	DW	RNTABBC,0
    8663/    2FA7 :                     
    8664/    2FA7 : 00 00               	DB	00H,0		; End mark
    8665/    2FA9 :                     
    8666/    2FA9 :                     RNTABBC:
    8667/    2FA9 : 00 02               	DB	00H,2		; "BC"
    8668/    2FAB : 0E 9F 59 30         	DW	REGBC,RNBC
    8669/    2FAF : 27 02               	DB	27H,2		; "BC'"
    8670/    2FB1 :                     ;;	DB	'\'',2		; "BC'"
    8671/    2FB1 : 16 9F 73 30         	DW	REGBCX,RNBCX
    8672/    2FB5 :                     
    8673/    2FB5 : 00 00               	DB	00H,0
    8674/    2FB7 :                     	
    8675/    2FB7 :                     RNTABC:
    8676/    2FB7 : 00 01               	DB	00H,1		; "C"
    8677/    2FB9 : 0E 9F 5E 30         	DW	REGBC,RNC
    8678/    2FBD : 27 01               	DB	27H,1		; "C'"
    8679/    2FBF :                     ;;	DB	'\'',1		; "C'"
    8680/    2FBF : 16 9F 7A 30         	DW	REGBCX,RNCX
    8681/    2FC3 :                     
    8682/    2FC3 : 00 00               	DB	00H,0
    8683/    2FC5 :                     	
    8684/    2FC5 :                     RNTABD:
    8685/    2FC5 : 00 01               	DB	00H,1		; "D"
    8686/    2FC7 : 11 9F 63 30         	DW	REGDE+1,RND
    8687/    2FCB : 27 01               	DB	27H,1		; "D'"
    8688/    2FCD :                     ;;	DB	'\'',1		; "D'"
    8689/    2FCD : 19 9F 81 30         	DW	REGDEX+1,RNDX
    8690/    2FD1 : 45 0F               	DB	'E',0FH		; "DE?"
    8691/    2FD3 : D9 2F 00 00         	DW	RNTABDE,0
    8692/    2FD7 :                     
    8693/    2FD7 : 00 00               	DB	00H,0
    8694/    2FD9 :                     
    8695/    2FD9 :                     RNTABDE:
    8696/    2FD9 : 00 02               	DB	00H,2		; "DE"
    8697/    2FDB : 10 9F 60 30         	DW	REGDE,RNDE
    8698/    2FDF : 27 02               	DB	27H,2		; "DE'"
    8699/    2FE1 :                     ;;	DB	'\'',2		; "DE'"
    8700/    2FE1 : 18 9F 7D 30         	DW	REGDEX,RNDEX
    8701/    2FE5 :                     
    8702/    2FE5 : 00 00               	DB	00H,0
    8703/    2FE7 :                     	
    8704/    2FE7 :                     RNTABE:
    8705/    2FE7 : 00 01               	DB	00H,1		; "E"
    8706/    2FE9 : 10 9F 65 30         	DW	REGDE,RNE
    8707/    2FED : 27 01               	DB	27H,1		; "E'"
    8708/    2FEF :                     ;;	DB	'\'',1		; "E'"
    8709/    2FEF : 18 9F 84 30         	DW	REGDEX,RNEX
    8710/    2FF3 :                     
    8711/    2FF3 : 00 00               	DB	00H,0
    8712/    2FF5 :                     	
    8713/    2FF5 :                     RNTABF:
    8714/    2FF5 : 00 01               	DB	00H,1		; "F"
    8715/    2FF7 : 0C 9F 6E 30         	DW	REGAF,RNF
    8716/    2FFB : 27 01               	DB	27H,1		; "F'"
    8717/    2FFD :                     ;;	DB	'\'',1		; "F'"
    8718/    2FFD : 14 9F 91 30         	DW	REGAFX,RNFX
    8719/    3001 :                     
    8720/    3001 : 00 00               	DB	00H,0
    8721/    3003 :                     	
    8722/    3003 :                     RNTABH:
    8723/    3003 : 00 01               	DB	00H,1		; "H"
    8724/    3005 : 13 9F 6A 30         	DW	REGHL+1,RNH
    8725/    3009 : 27 01               	DB	27H,1		; "H'"
    8726/    300B :                     ;;	DB	'\'',1		; "H'"
    8727/    300B : 1B 9F 8B 30         	DW	REGHLX+1,RNHX
    8728/    300F : 4C 0F               	DB	'L',0FH		; "HL?"
    8729/    3011 : 17 30 00 00         	DW	RNTABHL,0
    8730/    3015 :                     
    8731/    3015 : 00 00               	DB	00H,0
    8732/    3017 :                     
    8733/    3017 :                     RNTABHL:
    8734/    3017 : 00 02               	DB	00H,2		; "HL"
    8735/    3019 : 12 9F 67 30         	DW	REGHL,RNHL
    8736/    301D : 27 02               	DB	27H,2		; "HL'"
    8737/    301F :                     ;;	DB	'\'',2		; "HL'"
    8738/    301F : 1A 9F 87 30         	DW	REGHLX,RNHLX
    8739/    3023 :                     
    8740/    3023 : 00 00               	DB	00H,0
    8741/    3025 :                     	
    8742/    3025 :                     RNTABL:
    8743/    3025 : 00 01               	DB	00H,1		; "L"
    8744/    3027 : 12 9F 6C 30         	DW	REGHL,RNL
    8745/    302B : 27 01               	DB	27H,1		; "L'"
    8746/    302D :                     ;;	DB	'\'',1		; "L'"
    8747/    302D : 1A 9F 8E 30         	DW	REGHLX,RNLX
    8748/    3031 :                     
    8749/    3031 : 00 00               	DB	00H,0
    8750/    3033 :                     	
    8751/    3033 :                     RNTABI:
    8752/    3033 : 00 01               	DB	00H,1		; "I"
    8753/    3035 : 24 9F A0 30         	DW	REGI,RNI
    8754/    3039 : 58 02               	DB	'X',2		; "IX"
    8755/    303B : 1C 9F 94 30         	DW	REGIX,RNIX
    8756/    303F : 59 02               	DB	'Y',2		; "IY"
    8757/    3041 : 1E 9F 97 30         	DW	REGIY,RNIY
    8758/    3045 :                     	
    8759/    3045 : 00 00               	DB	00H,0
    8760/    3047 :                     
    8761/    3047 :                     RNTABP:
    8762/    3047 : 43 02               	DB	'C',2		; "PC"
    8763/    3049 : 22 9F 9D 30         	DW	REGPC,RNPC
    8764/    304D :                     
    8765/    304D : 00 00               	DB	00H,0
    8766/    304F :                     
    8767/    304F :                     RNTABS:
    8768/    304F : 50 02               	DB	'P',2		; "SP"
    8769/    3051 : 20 9F 9A 30         	DW	REGSP,RNSP
    8770/    3055 :                     
    8771/    3055 : 00 00               	DB	00H,0
    8772/    3057 :                     
    8773/    3057 : 41 00               RNA:	DB	"A",00H
    8774/    3059 : 42 43 00            RNBC:	DB	"BC",00H
    8775/    305C : 42 00               RNB:	DB	"B",00H
    8776/    305E : 43 00               RNC:	DB	"C",00H
    8777/    3060 : 44 45 00            RNDE:	DB	"DE",00H
    8778/    3063 : 44 00               RND:	DB	"D",00H
    8779/    3065 : 45 00               RNE:	DB	"E",00H
    8780/    3067 : 48 4C 00            RNHL:	DB	"HL",00H
    8781/    306A : 48 00               RNH:	DB	"H",00H
    8782/    306C : 4C 00               RNL:	DB	"L",00H
    8783/    306E : 46 00               RNF:	DB	"F",00H
    8784/    3070 : 41 27 00            RNAX:	DB	"A'",00H
    8785/    3073 : 42 43 27 00         RNBCX:	DB	"BC'",00H
    8786/    3077 : 42 27 00            RNBX:	DB	"B'",00H
    8787/    307A : 43 27 00            RNCX:	DB	"C'",00H
    8788/    307D : 44 45 27 00         RNDEX:	DB	"DE'",00H
    8789/    3081 : 44 27 00            RNDX:	DB	"D'",00H
    8790/    3084 : 45 27 00            RNEX:	DB	"E'",00H
    8791/    3087 : 48 4C 27 00         RNHLX:	DB	"HL'",00H
    8792/    308B : 48 27 00            RNHX:	DB	"H'",00H
    8793/    308E : 4C 27 00            RNLX:	DB	"L'",00H
    8794/    3091 : 46 27 00            RNFX:	DB	"F'",00H
    8795/    3094 : 49 58 00            RNIX:	DB	"IX",00H
    8796/    3097 : 49 59 00            RNIY:	DB	"IY",00H
    8797/    309A : 53 50 00            RNSP:	DB	"SP",00H
    8798/    309D : 50 43 00            RNPC:	DB	"PC",00H
    8799/    30A0 : 49 00               RNI:	DB	"I",00H
    8800/    30A2 : 52 00               RNR:	DB	"R",00H
    8801/    30A4 :                     ;;;
    8802/    30A4 :                     ;;; CPIR for 8085 P/V flag may be wrong. it's ok here.
    8803/    30A4 :                     ;;;
    8804/    30A4 :                     
    8805/    30A4 : BE                  CPIR80:	CP	(HL)
    8806/    30A5 : 23                  	INC	HL
    8807/    30A6 : 0B                  	DEC	BC
    8808/    30A7 : C8                  	RET	Z
    8809/    30A8 : F5                  	PUSH	AF
    8810/    30A9 : 78                  	LD	A,B
    8811/    30AA : B1                  	OR	C
    8812/    30AB : CA B2 30            	JP	Z,CPIR8E
    8813/    30AE : F1                  	POP	AF
    8814/    30AF : C3 A4 30            	JP	CPIR80
    8815/    30B2 : F1                  CPIR8E:	POP	AF
    8816/    30B3 : C9                  	RET
    8817/    30B4 :                     
    8818/    30B4 :                     SBC_HLBC:
    8819/    30B4 : D5                  	PUSH	DE			;Z80 CODE sbc	hl, bc
    8820/    30B5 : 57                  	LD	D,A			;###############################
    8821/    30B6 : 7D                  	LD	A,L			;###############################
    8822/    30B7 : 99                  	SBC	A,C			;###############################
    8823/    30B8 : 6F                  	LD	L,A			;###############################
    8824/    30B9 : 7C                  	LD	A,H			;###############################
    8825/    30BA : 98                  	SBC	A,B			;###############################
    8826/    30BB : 67                  	LD	H,A			;###############################
    8827/    30BC : DA C6 30            	JP	C,SBCHLBC1
    8828/    30BF : FA C6 30            	JP	M,SBCHLBC1
    8829/    30C2 : B5                  	OR	L
    8830/    30C3 : C2 C9 30            	JP	NZ,SBCHLBC2
    8831/    30C6 :                     SBCHLBC1:
    8832/    30C6 : 7A                  	LD	A,D			;###############################
    8833/    30C7 : D1                  	POP	DE			;###############################
    8834/    30C8 : C9                  	RET
    8835/    30C9 :                     SBCHLBC2:
    8836/    30C9 : 3E 01               	LD	A,1
    8837/    30CB : B7                  	OR	A
    8838/    30CC : 7A                  	LD	A,D
    8839/    30CD : D1                  	POP	DE
    8840/    30CE : C9                  	RET
    8841/    30CF :                     
    8842/    30CF :                     SBC_HLDE:
    8843/    30CF : C5                  	PUSH	BC			;Z80 CODE sbc	hl, de
    8844/    30D0 : 47                  	LD	B,A			;###############################
    8845/    30D1 : 7D                  	LD	A,L			;###############################
    8846/    30D2 : 9B                  	SBC	A,E			;###############################
    8847/    30D3 : 6F                  	LD	L,A			;###############################
    8848/    30D4 : 7C                  	LD	A,H			;###############################
    8849/    30D5 : 9A                  	SBC	A,D			;###############################
    8850/    30D6 : 67                  	LD	H,A			;###############################
    8851/    30D7 : DA E1 30            	JP	C,SBCHLDE1
    8852/    30DA : FA E1 30            	JP	M,SBCHLDE1
    8853/    30DD : B5                  	OR	L
    8854/    30DE : C2 E4 30            	JP	NZ,SBCHLDE2
    8855/    30E1 :                     SBCHLDE1:
    8856/    30E1 : 78                  	LD	A,B			;###############################
    8857/    30E2 : C1                  	POP	BC			;###############################
    8858/    30E3 : C9                  	RET
    8859/    30E4 :                     SBCHLDE2:
    8860/    30E4 : 3E 01               	LD	A,1
    8861/    30E6 : B7                  	OR	A
    8862/    30E7 : 78                  	LD	A,B
    8863/    30E8 : C1                  	POP	BC
    8864/    30E9 : C9                  	RET
    8865/    30EA :                     
    8866/    30EA :                     ;;;
    8867/    30EA :                     ;;; Console drivers
    8868/    30EA :                     ;;;
    8869/    30EA :                     
    8870/    30EA : =>FALSE              	IF	UARTMEM
    8871/    30EA :                     CONIN:
    8872/    30EA :                     	LD	A,(UARTCR)
    8873/    30EA :                     	AND	1
    8874/    30EA :                     	JP	Z,CONIN		;JR	Z,CONIN
    8875/    30EA :                     	LD	A,(UARTDR)
    8876/    30EA :                     	RET
    8877/    30EA :                     
    8878/    30EA :                     CONST:
    8879/    30EA :                     	LD	A,(UARTCR)
    8880/    30EA :                     	AND	1
    8881/    30EA :                     	RET
    8882/    30EA :                     
    8883/    30EA :                     CONOUT:
    8884/    30EA :                     	PUSH	AF
    8885/    30EA :                     PCST1:	LD	A,(UARTCR)
    8886/    30EA :                     	AND	2
    8887/    30EA :                     	JP	Z,PCST1		;JR	Z,PCST1
    8888/    30EA :                     	POP	AF
    8889/    30EA :                     	LD	(UARTDR),A
    8890/    30EA :                     	RET
    8891/    30EA :                     
    8892/    30EA : [8870]               	ENDIF
    8893/    30EA :                     
    8894/    30EA : =>FALSE              	IF	UARTPIC
    8895/    30EA :                     
    8896/    30EA :                     UARTDR_PIC	EQU	00h	; UART DATA REGISTOR
    8897/    30EA :                     UARTCR_PIC	EQU	11h	; UART CONTROL REGISTOR
    8898/    30EA :                     
    8899/    30EA :                     CONIN:
    8900/    30EA :                     	IN	A,(UARTCR_PIC)
    8901/    30EA :                     	AND	1
    8902/    30EA :                     	JP	Z,CONIN		;JR	Z,CONIN
    8903/    30EA :                     	IN	A,(UARTDR_PIC)
    8904/    30EA :                     	RET
    8905/    30EA :                     
    8906/    30EA :                     CONST:
    8907/    30EA :                     	IN	A,(UARTCR_PIC)
    8908/    30EA :                     	AND	1
    8909/    30EA :                     	RET
    8910/    30EA :                     
    8911/    30EA :                     CONOUT:
    8912/    30EA :                     	PUSH	AF
    8913/    30EA :                     PCST1:	IN	A,(UARTCR_PIC)
    8914/    30EA :                     	AND	2
    8915/    30EA :                     	JP	Z,PCST1		;JR	Z,PCST1
    8916/    30EA :                     	POP	AF
    8917/    30EA :                     	OUT	(UARTDR_PIC),A
    8918/    30EA :                     	RET
    8919/    30EA :                     
    8920/    30EA : [8894]               	ENDIF
    8921/    30EA :                     
    8922/    30EA : =>TRUE               	IF	UART8251
    8923/    30EA :                     
    8924/    30EA : =0H                  UARTDR_8251	EQU	00h	; UART DATA REGISTOR
    8925/    30EA : =1H                  UARTCR_8251	EQU	01h	; UART CONTROL REGISTOR
    8926/    30EA :                     
    8927/    30EA :                     CONIN:
    8928/    30EA : DB 01               	IN	A,(UARTCR_8251)
    8929/    30EC : E6 02               	AND	2
    8930/    30EE : CA EA 30            	JP	Z,CONIN		;JR	Z,CONIN
    8931/    30F1 : DB 00               	IN	A,(UARTDR_8251)
    8932/    30F3 : C9                  	RET
    8933/    30F4 :                     
    8934/    30F4 :                     CONST:
    8935/    30F4 : DB 01               	IN	A,(UARTCR_8251)
    8936/    30F6 : E6 02               	AND	2
    8937/    30F8 : C9                  	RET
    8938/    30F9 :                     
    8939/    30F9 :                     CONOUT:
    8940/    30F9 : F5                  	PUSH	AF
    8941/    30FA : DB 01               PCST1:	IN	A,(UARTCR_8251)
    8942/    30FC : E6 01               	AND	1
    8943/    30FE : CA FA 30            	JP	Z,PCST1		;JR	Z,PCST1
    8944/    3101 : F1                  	POP	AF
    8945/    3102 : D3 00               	OUT	(UARTDR_8251),A
    8946/    3104 : C9                  	RET
    8947/    3105 :                     
    8948/    3105 : [8922]               	ENDIF
    8949/    3105 :                     
    8950/    3105 : =>FALSE              	IF	Fullram
    8951/    3105 :                     	db	0FE00H - $ dup(0ffH) 
    8952/    3105 : =>TRUE               	ELSE
    8953/    3105 : FF FF FF FF FF FF   	db	BASIC_TOP - $ dup(0ffH) 
             310B : FF FF FF FF FF FF 
             3111 : FF FF FF FF FF FF 
             3117 : FF FF FF FF FF FF 
             311D : FF FF FF FF FF FF 
             3123 : FF FF FF FF FF FF 
             3129 : FF FF FF FF FF FF 
             312F : FF FF FF FF FF FF 
             3135 : FF FF FF FF FF FF 
             313B : FF FF FF FF FF FF 
             3141 : FF FF FF FF FF FF 
             3147 : FF FF FF FF FF FF 
             314D : FF FF FF FF FF FF 
             3153 : FF FF FF FF FF FF 
             3159 : FF FF FF FF FF FF 
             315F : FF FF FF FF FF FF 
             3165 : FF FF FF FF FF FF 
             316B : FF FF FF FF FF FF 
             3171 : FF FF FF FF FF FF 
             3177 : FF FF FF FF FF FF 
             317D : FF FF FF FF FF FF 
             3183 : FF FF FF FF FF FF 
             3189 : FF FF FF FF FF FF 
             318F : FF FF FF FF FF FF 
             3195 : FF FF FF FF FF FF 
             319B : FF FF FF FF FF FF 
             31A1 : FF FF FF FF FF FF 
             31A7 : FF FF FF FF FF FF 
             31AD : FF FF FF FF FF FF 
             31B3 : FF FF FF FF FF FF 
             31B9 : FF FF FF FF FF FF 
             31BF : FF FF FF FF FF FF 
             31C5 : FF FF FF FF FF FF 
             31CB : FF FF FF FF FF FF 
             31D1 : FF FF FF FF FF FF 
             31D7 : FF FF FF FF FF FF 
             31DD : FF FF FF FF FF FF 
             31E3 : FF FF FF FF FF FF 
             31E9 : FF FF FF FF FF FF 
             31EF : FF FF FF FF FF FF 
             31F5 : FF FF FF FF FF FF 
             31FB : FF FF FF FF FF    
    8954/    3200 : [8950]               	ENDIF
    8955/    3200 :                     
    8956/    3200 :                     ;	ORG	BASIC_TOP
    8957/    3200 :                     
    8958/    3200 :                     ;;;
    8959/    3200 :                     ;;; RAM area
    8960/    3200 :                     ;;;
    8961/    3200 :                     
    8962/    3200 :                     	;;
    8963/    3200 :                     	;; Work Area
    8964/    3200 :                     	;;
    8965/    3200 :                     	
    8966/    9F00 :                     	ORG	WORK_B
    8967/    9F00 :                     
    8968/    9F00 : =>FALSE              	IF	BACKDOOR
    8969/    9F00 :                     stealRST08:	ds	2	; hacking RST 08H, set jump address
    8970/    9F00 :                     stealRST10:	ds	2	; hacking RST 10H, set jump address
    8971/    9F00 :                     stealRST18:	ds	2	; hacking RST 18H, set jump address
    8972/    9F00 :                     stealRST20:	ds	2	; hacking RST 20H, set jump address
    8973/    9F00 :                     stealRST28:	ds	2	; hacking RST 28H, set jump address
    8974/    9F00 :                     stealRST30:	ds	2	; hacking RST 30H, set jump address
    8975/    9F00 :                     stealRST38:	ds	2	; hacking RST 38H, set jump address
    8976/    9F00 :                     save_hl:	ds	2
    8977/    9F00 : [8968]               	ENDIF
    8978/    9F00 :                     	
    8979/    9F00 :                     DSADDR:	DS	2	; Dump start address
    8980/    9F02 :                     DEADDR:	DS	2	; Dump end address
    8981/    9F04 :                     DSTATE:	DS	1	; Dump state
    8982/    9F05 :                     GADDR:	DS	2	; Go address
    8983/    9F07 :                     SADDR:	DS	2	; Set address
    8984/    9F09 :                     HEXMOD:	DS	1	; HEX file mode
    8985/    9F0A :                     RECTYP:	DS	1	; Record type
    8986/    9F0B :                     SIZE:	DS	1	; I/O Size 00H,'W','S'
    8987/    9F0C :                     
    8988/    9F0C :                     REG_B:	
    8989/    9F0C :                     REGAF:	DS	2
    8990/    9F0E :                     REGBC:	DS	2
    8991/    9F10 :                     REGDE:	DS	2
    8992/    9F12 :                     REGHL:	DS	2
    8993/    9F14 :                     REGAFX:	DS	2		; Register AF'
    8994/    9F16 :                     REGBCX:	DS	2
    8995/    9F18 :                     REGDEX:	DS	2
    8996/    9F1A :                     REGHLX:	DS	2		; Register HL'
    8997/    9F1C :                     REGIX:	DS	2
    8998/    9F1E :                     REGIY:	DS	2
    8999/    9F20 :                     REGSP:	DS	2
    9000/    9F22 :                     REGPC:	DS	2
    9001/    9F24 :                     REGI:	DS	1
    9002/    9F25 :                     REGR:	DS	1
    9003/    9F26 :                     REG_E:
    9004/    9F26 :                     
    9005/    9F26 : =>FALSE              	IF RAM12K
    9006/    9F26 :                     ; stop watch timer
    9007/    9F26 :                     
    9008/    9F26 :                     c16b:	ds	2	; copy of TIMER0_CNT
    9009/    9F26 :                     secb:	ds	2	; copy of TIMER0_SCTT
    9010/    9F26 :                     msecb:	ds	2
    9011/    9F26 : [9005]               	ENDIF
    9012/    9F26 :                     
    9013/    9F26 :                     ; DIV 16 /16 buffer
    9014/    9F26 :                     DIV16_NA:	ds	2
    9015/    9F28 :                     DIV16_NB:	ds	2
    9016/    9F2A :                     DIV16_NC:	DS	2
    9017/    9F2C :                     DIV16_ND:	DS	2
    9018/    9F2E :                     
    9019/    9F2E :                     ; go command temp start address
    9020/    9F2E :                     goTmp:		ds	2
    9021/    9F30 :                     
    9022/    9F30 :                     ; trace mode switch
    9023/    9F30 :                     TP_mode:	ds	1	; N: display on, F: display off
    9024/    9F31 :                     TM_mode:	ds	1	; 'S':skip call, 'I':trace CALL IN
    9025/    9F32 :                     TC_cnt:		ds	2	; numbers of step
    9026/    9F34 :                     tmpT:		ds	2	; save temp buffer
    9027/    9F36 :                     fever_t:	ds	1	; flag trace forever
    9028/    9F37 :                     
    9029/    9F37 :                     ; break, trace point work area
    9030/    9F37 : =9F37H               dbg_wtop	equ	$
    9031/    9F37 :                     tpt1_f:		ds	1
    9032/    9F38 :                     tpt1_op:	ds	1	; save trace point1 opcode
    9033/    9F39 :                     tpt1_adr:	ds	2
    9034/    9F3B :                     tpt2_f:		ds	1
    9035/    9F3C :                     tpt2_op:	ds	1	; save trace point2 opcode (for branch)
    9036/    9F3D :                     tpt2_adr:	ds	2
    9037/    9F3F :                     
    9038/    9F3F :                     ; break point work area
    9039/    9F3F :                     bpt1_f:		ds	1
    9040/    9F40 :                     bpt1_op:	ds	1
    9041/    9F41 :                     bpt1_adr:	ds	2
    9042/    9F43 :                     bpt2_f:		ds	1
    9043/    9F44 :                     bpt2_op:	ds	1
    9044/    9F45 :                     bpt2_adr:	ds	2
    9045/    9F47 :                     
    9046/    9F47 :                     tmpb_f:		ds	1
    9047/    9F48 :                     tmpb_op:	ds	1
    9048/    9F49 :                     tmpb_adr:	ds	2
    9049/    9F4B : =9F4BH               dbg_wend	equ	$
    9050/    9F4B :                     
    9051/    9F4B :                     ; minimal assembler
    9052/    9F4B :                     
    9053/    9F4B :                     asm_adr:	ds	2
    9054/    9F4D :                     tasm_adr:	ds	2
    9055/    9F4F :                     element_cnt:	ds	1	; Element count of input string
    9056/    9F50 :                     byte_count:	ds	1	; numbers of Machine code
    9057/    9F51 :                     opc_cd:		ds	1	; opecode number
    9058/    9F52 :                     opr1_cd:	ds	1	; 1st operand number
    9059/    9F53 :                     opr2_cd:	ds	1	; 2nd operand number
    9060/    9F54 :                     opr_num25:	ds	2	; save number nnnn
    9061/    9F56 :                     opr_num35:	ds	2	; save number (nnnn)
    9062/    9F58 :                     opr_num37:	ds	1	; save number (IY-nn)
    9063/    9F59 :                     opr_num34:	ds	1	; save number (IY+nn)
    9064/    9F5A :                     opr_num36:	ds	1	; save number (IX-nn)
    9065/    9F5B :                     opr_num33:	ds	1	; save number (IX+nn)
    9066/    9F5C :                     cb_mcw		ds	2	; use BIT, RES, SET
    9067/    9F5E :                     cb_xyw		ds	2	; use BIT, RES, SET
    9068/    9F60 :                     
    9069/    9F60 :                     F_bit:		ds	F_bitSize+1
    9070/    9F69 :                     ky_flg:		ds	1	; b00000ULC ( U: UPPER L: LF C: CR )
    9071/    9F6A :                     				; U=0: Lower To Upper
    9072/    9F6A :                     				; L=0: End of line is added LF
    9073/    9F6A :                     				; C=0: End of line is added CR
    9074/    9F6A :                     ;::::::::::::::::::::::::::
    9075/    9F6A :                     ; DISASEM work area
    9076/    9F6A :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;
    9077/    9F6A :                     dasm_ed:	ds	2
    9078/    9F6C :                     dasm_stpf:	ds	1
    9079/    9F6D :                     dasm_adr:	ds	2
    9080/    9F6F :                     reg_xy:		ds	2	; RNIX or RNIY
    9081/    9F71 :                     xy_srtp		ds	2	; strings pointer
    9082/    9F73 :                     
    9083/    9F73 :                     mc_Size:	ds	1
    9084/    9F74 :                     
    9085/    9F74 :                     ;;;;;;;;;;;;;;;;;;;
    9086/    9F74 :                     ; union area
    9087/    9F74 :                     ;;;;;;;;;;;;;;;;;;;
    9088/    9F74 :                     INBUF: ; Line input buffer
    9089/    9F74 :                     line_buf:
    9090/    9F74 :                     
    9091/    9F74 :                     ;  DidAsm string buffer
    9092/    9F74 :                     ; total 42 bytes
    9093/    9F74 :                     dasm_bs:
    9094/    9F74 :                     adr_mc_buf:	ds	19
    9095/    9F87 :                     dasm_OpcStr:	ds	8
    9096/    9F8F :                     dasm_OprStr:	ds	15 - NUMLEN
    9097/    9F97 :                     num_string:	ds	NUMLEN	; max 65536 or 0FFFFH + null( max 7bytes )
    9098/    9F9E :                     dasm_be:
    9099/    9F9E :                     
    9100/    9F9E :                     alt_AF:		ds	1
    9101/    9F9F :                     alt_A:		ds	1
    9102/    9FA0 :                     tmp_HL:		ds	2
    9103/    9FA2 :                     	END
 AS V1.42 Beta [Bld 232] - Source File emu8085mon_RevB03_8k.asm - Page 2 - 12/29/2022 20:41:37


  Symbol Table (* = unused):
  --------------------------

 ACS_KN2K :                    0C3F C |  ADCSTR :                      130C C |
 ADC_3MC :                        4 - |  ADC_A_ :                      1E06 C |
 ADC_A_A :                     1E37 C |  ADC_A_N :                     1E24 C |
 ADC_A_X :                     1E21 C |  ADC_FD :                      1E56 C |
 ADC_HL_ :                     1E02 C |  ADC_HL_BC :                   1E01 C |
 ADC_HL_DE :                   1DFC C |  ADC_HL_HL :                   1DF7 C |
*ADC_HL_SP :                   1DF2 C |  ADC_MC :                         9 - |
 ADDIXRP_TBL :                 149D C |  ADDIYRP_TBL :                 14A5 C |
 ADDSTR :                      1308 C |  ADD_HL_ :                     1ECC C |
 ADD_HL_BC :                   1EE6 C |  ADD_HL_DE :                   1EEB C |
 ADD_HL_HL :                   1EF0 C | *ADD_HL_SP :                   1EE1 C |
 ADD_IX_ :                     1E8B C |  ADD_IX_IX :                   1EB8 C |
*ADD_IY_ :                     1E86 C |  ADD_IY_IY :                   1EC3 C |
 ADD_OPSTR :                   11B3 C |  ADD_RP_E :                    126D C |
 ADD_RP_S :                    1269 C |  ADD_XY_BC :                   1EAE C |
 ADD_XY_DE :                   1EB3 C | *ADD_XY_SP :                   1EA7 C |
 ADD_XY_XY :                   1EBE C |  ADR_MC_BUF :                  9F74 C |
 ADR_OVR :                     27B5 C |  ALT_A :                       9F9F C |
 ALT_AF :                      9F9E C |  ANALIZE_INPUT :               25EC C |
 ANALIZE_OPR :                 2646 C |  ANDSTR :                      1318 C |
 AND_CP :                      244E C |  AN_ERR :                      263B C |
 APENDTBL :                     17C C |  API01 :                       29F2 C |
 API06 :                       2A39 C |  APITBL :                      29C6 C |
 APITBL_E :                    29F2 C |
*ARCHITECTURE :                                        "i386-unknown-win32" - |
 ASM_ADR :                     9F4B C |  ASM_ERR :                     1B3A C |
*ASM_ERR1 :                    1B3D C |  A_COLON_SP :                  120E C |
 A_CRLF :                      11D4 C |  BACKDOOR :                       0 - |
 BACKTOMON :                   2AEA C |  BASE1 :                       242B C |
 BASIC_CST :                   3200 - |  BASIC_TOP :                   3200 - |
 BASIC_WST :                   3203 - |  BITSTR :                      138B C |
 BIT_IXM :                     1CD4 C |  BIT_IXP :                     1CBF C |
 BIT_IXP1 :                    1CC2 C |  BIT_IYM :                     1CE3 C |
 BIT_IYP :                     1CDA C |  BIT_IYP1 :                    1CDD C |
 BIT_MCB :                     1C51 C |  BIT_MCBE :                    1C59 C |
 BIT_MCBN :                       8 - |  BIT_RES_SET :                 1C6D C |
 BIT_XYT :                     1C59 C |  BI_HEX :                      2752 C |
 BPT1_ADR :                    9F41 C |  BPT1_F :                      9F3F C |
 BPT1_OP :                     9F40 C |  BPT2_ADR :                    9F45 C |
 BPT2_F :                      9F43 C |  BPT2_OP :                     9F44 C |
 BP_CHK1 :                     2A7F C |  BP_CHK_END :                  2AAF C |
 BP_CLR :                       31E C |  BP_CLR1 :                      336 C |
 BP_LOT :                       347 C |  BP_MSG1 :                      367 C |
 BP_MSG2 :                      36B C |  BRK_CMD :                      2B7 C |
 BS :                             8 - |  BUFLEN :                        28 - |
 BYTE_COUNT :                  9F50 C |  B_ACLR :                       33B C |
 B_LIST :                       296 C |  B_LIST1 :                      2A5 C |
 B_MSG_OUT :                    36E C |  CALC_DIS_STEP :                908 C |
 CALC_RELADR :                 2783 C |  CALLSTR :                     12F7 C |
 CALL_MC1T :                   1CE9 C |  CAL_01 :                      27A2 C |
 CAL_1 :                       27A5 C | *CASESENSITIVE :                  0 - |
 CB_MCW :                      9F5C C |  CB_XYW :                      9F5E C |
 CC0 :                         1407 C |  CC1 :                         140A C |
 CC2 :                         140C C |  CC3 :                         140F C |
 CC4 :                         1411 C |  CC5 :                         1414 C |
 CC6 :                         1417 C |  CC7 :                         1419 C |
 CCFSTR :                      1360 C |  CC_NNNN :                     0D31 C |
 CC_OPR :                      142B C |  CHKERR :                       31C C |
 CHK_0CBH :                    0D52 C |  CHK_0DD3OP :                  0EA5 C |
 CHK_0DD4OP :                  0F2C C |  CHK_0DDH :                    0E18 C |
 CHK_0DDH_1 :                  0E2D C |  CHK_0EDH :                    0FD3 C |
 CHK_0FDH :                    10D4 C |  CHK_1MC_BNH :                 0B92 C |
 CHK_2MC :                     0BE1 C |  CHK_3MC :                     0C9F C |
 CHK_ADC :                     0A37 C |  CHK_ADC3MC :                  1E3B C |
 CHK_ADD :                     0A29 C |  CHK_ADD_RP :                  0B06 C |
 CHK_AND :                     0A67 C |  CHK_BP :                      2A6F C |
 CHK_CALCC :                   0D40 C |  CHK_CALLN4 :                  0D14 C |
 CHK_CP :                      0A91 C |  CHK_DD_CB :                   0F7B C |
 CHK_DEC :                     0AB9 C |  CHK_DEC_RP :                  0AEB C |
 CHK_DI1 :                      8A5 C |  CHK_DJNZ :                    0C65 C |
 CHK_EX :                      0B5C C |  CHK_FEVRE :                    48A C |
 CHK_INC :                     0A9F C |  CHK_INC_RP :                  0AD0 C |
 CHK_JPCC :                    0D22 C |  CHK_JPN4 :                    0D06 C |
 CHK_JRCC :                    0C81 C |  CHK_JRNN :                    0C70 C |
 CHK_LD :                       9B0 C |  CHK_LD1 :                      9F5 C |
 CHK_LD16 :                    0CC1 C |  CHK_LOGOP2 :                  0C0B C |
 CHK_NTRACE :                  2ACA C |  CHK_OR :                      0A83 C |
 CHK_POP_RP :                  0B26 C |  CHK_PUSH_RP :                 0B41 C |
 CHK_RET :                     0BA6 C |  CHK_RST :                     0BC1 C |
 CHK_SBC :                     0A56 C |  CHK_STPDI :                    8C9 C |
 CHK_STRINGS :                 26B5 C |  CHK_SUB :                     0A48 C |
 CHK_XOR :                     0A75 C |  CK_ENDMK :                    2728 C |
 CLCC_TBLE :                    68C C |  CLCC_TBLS :                    684 C |
 CLR_CRT :                     287B C |  CMD_HLP :                     2C40 C |
 COLD_ST :                       40 C |  COMMAND_HLP :                  121 C |
*COMPMODE :                       0 - |  COM_ERRM :                    13FA C |
 CONIN :                       30EA C |  CONOUT :                      30F9 C |
 CONST :                       30F4 C | *CONSTPI :        3.141592653589793 - |
 CONT_ASM :                    1BC0 C |  COUT_SP :                     1B4C C |
 COUT_SP1 :                    1B65 C |  COUT_SP2 :                    1B82 C |
 CPDRSTR :                     13DD C |  CPDSTR :                      13B7 C |
 CPIR80 :                      30A4 C |  CPIR8E :                      30B2 C |
 CPIRSTR :                     13C9 C |  CPISTR :                      13A6 C |
 CPLSTR :                      1358 C |  CPSTR :                       1323 C |
 CPSTREND :                    231C C |  CPSTR_CRLF :                  11E5 C |
 CP_IXIY :                     2481 C |  CP_IY :                       248A C |
 CP_XY1 :                      248F C |  CR :                            0D - |
 CRLF :                        2871 C |  CSTART :                        43 C |
 D16_END :                     2BC3 C |  D16_MINUS :                   2BB8 C |
 D16_MINUS_AFTER :             2BBD C |  D16_MINUS_BEFORE :            2BB7 C |
 D16_PLUS :                    2BA9 C |  D16_PLUS_AFTER :              2BAE C |
 DAASTR :                      1354 C |  DASM_ADR :                    9F6D C |
 DASM_BE :                     9F9E C |  DASM_BS :                     9F74 C |
 DASM_ED :                     9F6A C |  DASM_OPCSTR :                 9F87 C |
 DASM_OPRSTR :                 9F8F C |  DASM_STPF :                   9F6C C |
*DATE :                "12/29/2022" - |  DBG_WEND :                    9F4B - |
 DBG_WINI :                      8B C |  DBG_WTOP :                    9F37 - |
 DDLOGTBL :                    14AD C |  DD_21 :                       0F53 C |
 DD_22 :                       0F61 C |  DD_2A :                       0F6A C |
 DD_2A1 :                      0F6F C |  DD_2NDTBL :                    75D C |
 DD_2NDTBL1 :                   761 C |  DD_2NDTBL2 :                   765 C |
 DD_2NDTBL_E :                  767 C |  DD_2OPT :                     1495 C |
 DD_BIT :                      0FC1 C |  DD_BIT_OPTBL :                1291 C |
 DD_BIT_OPTBLE :               12A9 C |  DD_BSR :                      0FB8 C |
 DD_CB_NN_XX :                 0F9C C |  DD_LD :                       0EE7 C |
 DD_LD1 :                      0F00 C |  DD_LDTBL :                    14BB C |
 DD_LD_TBL :                   1275 C |  DD_LD_TBLE :                  1283 C |
 DD_LOG_TBL :                  1283 C |  DD_LOG_TBLE :                 128A C |
 DD_MIX :                      0F14 C |  DD_MIX1 :                     0F20 C |
 DD_MIX2 :                     0F26 C |  DD_MIX3 :                     0F17 C |
 DD_MIX4 :                     0F0C C |  DD_RES :                      0FCA C |
 DD_RT_STR :                   14F3 C |  DD_RT_TBLE :                  1291 C |
 DD_RT_TBLES :                 128A C |  DEADDR :                      9F02 C |
 DECSTR :                      132A C |  DEC_CHR :                     2765 C |
 DEC_NUM :                     2781 C |  DEC_OPCDTBLE :                1261 C |
 DEC_OPCDTBLS :                1259 C |  DEC_OPR :                     24AD C |
 DEC_RP_E :                    1269 C |  DEC_RP_S :                    1265 C |
 DEC_STR :                     2B5D C |  DEL :                           7F - |
 DEX_SP_HL :                   0B89 C |  DIP_TM :                       3C0 C |
 DISASM_GO :                    8D8 C |  DISASSEMBLE :                  87D C |
 DISREGTBL :                   141B C |  DISTR :                       1364 C |
 DIS_ANALYSIS :                 97D C |  DIS_CALL :                    2B28 C |
 DIS_GO1 :                      8E4 C | *DIV16 :                       2BC6 C |
 DIV16_8 :                     2B9B C |  DIV16_NA :                    9F26 C |
 DIV16_NB :                    9F28 C |  DIV16_NC :                    9F2A C |
 DIV16_ND :                    9F2C C |  DIV16_X0 :                    2C0D C |
 DIV16_X1 :                    2C18 C |  DIV16_X2 :                    2BDD C |
 DIXN_TBL :                    24A9 C |  DIX_TBL :                     24A7 C |
 DIYN_TBL :                    24AB C |  DI_3MC :                      2505 C |
 DI_3MC1 :                     250C C |  DI_IXNNUM :                      4 - |
 DI_IXYNUM :                      6 - |  DI_IY :                       2501 C |
 DI_IYNNUM :                      2 - |  DI_NBS :                        12 - |
 DI_NXT :                       887 C |  DJNZSTR :                     12F2 C |
 DJPHL :                        56F C |  DMKST1 :                      11C9 C |
 DMKST2 :                      11CB C |  DMKSTR0 :                     11BD C |
 DMP_DB :                      1B94 C |  DMP_DW :                      1BA0 C |
 DM_BIT :                        80 - |  DONOT_TRACE :                 156A C |
 DP0 :                          77F C |  DP00 :                         790 C |
 DP1 :                          7A7 C |  DPB :                          833 C |
 DPB0 :                         84D C |  DPB1 :                         859 C |
 DPB2 :                         85E C |  DPL :                          7F3 C |
 DPL0 :                         803 C |  DPL1 :                         815 C |
 DPL2 :                         827 C |  DPL3 :                         82C C |
 DPM :                          7C4 C |  DPM0 :                         7CF C |
 DPM1 :                         7ED C |  DPM_C :                        7BE C |
 DSADDR :                      9F00 C |  DSAP :                        2E76 C |
 DSEP0 :                       2E6F C |  DSEP1 :                       2E72 C |
 DSTATE :                      9F04 C |  DUMP :                         767 C |
 D_I_TB :                      249B C |  D_I_TBE :                     24AD C |
 E1S :                           0E - |  E1S1 :                          15 - |
 E1_E :                        2202 C |  E1_E1 :                       2225 C |
 E1_S :                        21F4 C |  E1_S1 :                       2210 C |
 E2S :                           1A - |  E2_E :                        2293 C |
 E2_S :                        2279 C |  ED_4MC :                      10B5 C |
 ED_ADC :                      1061 C |  ED_IM :                       1094 C |
 ED_LD_AI :                    107C C |  ED_LD_AR :                    1073 C |
 ED_LD_IA :                    108E C |  ED_LD_RA :                    1085 C |
 ED_LD_RA1 :                   1088 C |  ED_NOOPR :                    14C9 C |
 ED_NO_OPR :                   10A7 C |  ED_OP_TBL :                   12A9 C |
 ED_OP_TBLE :                  12E1 C |  ED_OUT :                      102F C |
 ED_OUT1 :                     1043 C |  ED_RP_STR :                   1489 C |
 ED_SBC :                      104A C |  ED_SBC1 :                     1059 C |
 EISTR :                       1367 C |  EL2_12 :                      257C C |
 EL2_13 :                      2570 C |  EL2_130 :                     2594 C |
 EL2_16 :                      2576 C |  EL2_17 :                      256A C |
 EL2_18 :                      2564 C |  EL2_19 :                      255E C |
 EL2_20 :                      2558 C |  EL2_23 :                      24D7 C |
 EL2_24 :                      244C C |  EL2_26 :                      24D1 C |
 EL2_27 :                      2447 C |  EL2_28 :                      2442 C |
 EL2_29 :                      243D C |  EL2_41 :                      2438 C |
 EL2_410 :                     246E C |  EL2_411 :                     247C C |
 EL2_42 :                      23FB C |  EL2_43 :                      2397 C |
 EL2_44 :                      237C C |  EL2_441 :                     238D C |
 EL2_45 :                      2360 C |  EL2_451 :                     236A C |
 EL2_46 :                      23D6 C |  EL2_49 :                      23AB C |
 EL2_54 :                      25C8 C |  EL2_541 :                     25E5 C |
 EL2_5411 :                    25E6 C |  EL2_68 :                      2335 C |
 EL2_69 :                      22F4 C |  EL2_691 :                     2320 C |
 EL2_692 :                     230B C |  EL2_70 :                      22DC C |
 EL2_8 :                       2522 C |  EL2_81 :                      2524 C |
 EL2_82 :                      254A C |  EL2_9 :                       251D C |
 EL2_DI :                      24DA C |  EL3_1 :                       1F85 C |
 EL3_11 :                      202E C |  EL3_12 :                      1FB1 C |
 EL3_121 :                     20CF C |  EL3_125 :                     1FB5 C |
 EL3_126 :                     1FCD C |  EL3_13 :                      2103 C |
 EL3_14 :                      2112 C |  EL3_1_2 :                     20B7 C |
 EL3_21 :                      1E5A C |  EL3_211 :                     1E8D C |
 EL3_212 :                     1EA9 C |  EL3_22 :                      1DBD C |
 EL3_221 :                     1DCE C |  EL3_25 :                      1DA9 C |
 EL3_34 :                      1C61 C |  EL3_341 :                     1CBB C |
 EL3_342 :                     1CC5 C |  EL3_35 :                      1C23 C |
 EL3_36 :                      1C42 C |  EL3_42 :                      1CFF C |
 EL3_421 :                     1D02 C |  EL3_43 :                      1D71 C |
 EL3_431 :                     1D92 C |  EL3_45 :                      1CF1 C |
 EL3_55 :                      1D2D C |  EL3_550 :                     1D38 C |
 EL3_551 :                     1D59 C |  EL3_552 :                     1D5C C |
 EL3_6 :                       1EF5 C |  EL3_60 :                      1D20 C |
 EL3_61 :                      1F3E C |  EL3_JTB :                     1BF9 C |
 EL3_S13 :                     21EF C |  EL3_S16 :                     219B C |
 EL3_S161 :                    21C3 C |  EL3_S162 :                    21C8 C |
 EL3_S163 :                    21CD C |  EL3_S1631 :                   21CF C |
 EL3_S164 :                    21D6 C |  EL3_S17 :                     21EA C |
 EL3_S26 :                     21E5 C |  EL3_S261 :                    21E7 C |
 EL3_S27 :                     21E0 C |  EL3_S28 :                     2168 C |
 EL3_S281 :                    218C C |  EL3_S282 :                    2187 C |
 EL3_S283 :                    2184 C |  EL3_S35 :                     212E C |
 EL3_S351 :                    2150 C |  EL3_S352 :                    215D C |
 EL3_S353 :                    2157 C |  EL3_STB :                     1BEC C |
 EL3_STBE :                    1BF9 C |  EL3_UM :                        0D - |
 ELEM1_CD :                    21F4 C |  ELEM1_CD1 :                   2210 C |
 ELEM1_OPCD :                  2202 C |  ELEM1_OPCD1 :                 2225 C |
 ELEM2_CD :                    2279 C |  ELEMENT_CNT :                 9F4F C |
 END_DEC :                     2B96 C |  END_INS_TC :                   5E7 C |
 ENTRY :                         40 - |  ENT_EL2 :                     2293 C |
 ERR :                          118 C |  ERRMSG :                      2E67 C |
 ERR_TRACE_SEQ :                5EA C |  ER_OPMSG :                    13FA C |
 ESC :                           1B - |  ESC_CRT_CLR :                 2884 C |
 EXP_MSB :                      60F C |  EXSTR :                       1337 C |
 EXT_ASM :                     1B29 C |  EXXSTR :                      133A C |
 EX_AF_ :                      1F2B C |  EX_AF_AF :                    0B7A C |
 EX_DE_ :                      1F36 C |  EX_SP_HL :                    1F27 C |
 EX_SP_IX :                    1F21 C |  EX_SR_ :                      1F61 C |
 EX_SR_NUM :                      4 - | *E_CSTART :                       0 C |
*E_WSTART :                       3 C | *FALSE :                          0 - |
 FEVER_T :                     9F36 C |  FLG_LOOP :                    18F9 C |
 FLG_NXT :                     1909 C |  FLG_OFF :                     1905 C |
*FULLPMMU :                       1 - |  FULLRAM :                        0 - |
 F_BIT :                       9F60 C |  F_BITSIZE :                      8 - |
 F_BIT_OFF :                   1927 C |  F_BIT_ON :                    191F C |
 G0 :                          1548 C |  GADDR :                       9F05 C |
 GETLIN :                      2888 C |  GET_BI :                       267 C |
 GET_DI1 :                      89D C |  GET_DISASM_ST :                917 C |
 GET_DNUM :                     238 C |  GET_N4 :                      0CED C |
 GET_N4CRLF :                  0CBB C |  GET_NNNN :                    1117 C |
 GET_NUM :                      240 C |  GET_NUM0 :                     243 C |
 GET_NUMBER :                  2708 C |  GET_RSTG_OFF :                112B C |
 GET_R_NUM :                    9A7 C |  GET_STRBUFPOINT :             112E C |
 GL0 :                         288D C |  GL00 :                        2893 C |
 GL001 :                       28B9 C |  GL1 :                         28EB C |
 GLB :                         28F0 C |  GLE :                         2909 C |
 GLE_END :                     27DC C |  GLE_END1 :                    27DA C |
 GM80_CST :                    5400 - |  GM80_WST :                    5403 - |
 GO :                          1501 C |  GO1 :                         1542 C |
 GOSTMP :                      1517 C |  GOTMP :                       9F2E C |
 G_STPADR :                    1522 C |  H2SA_1 :                      118A C |
 H2S_N1 :                      11A1 C |  H2S_N2 :                      11A5 C |
 H4SA_1 :                      1178 C |  H4SA_2 :                      117B C |
*HAS64 :                          0 - | *HASFPU :                         0 - |
*HASPMMU :                        0 - |  HEX2STR :                     1198 C |
 HEX2STR_ASM :                 1180 C |  HEX4STR :                     1190 C |
 HEX4STR_ASM :                 116E C |  HEXIN :                       2849 C |
 HEXMOD :                      9F09 C |  HEXOUT1 :                     283B C |
 HEXOUT2 :                     2832 C |  HEXOUT4 :                     282D C |
 HEX_CHR :                     2770 C |  HI0 :                         2851 C |
 HI1 :                         286C C |  HIR :                         286F C |
 HLTSTR :                      1303 C |  HL_CRLF :                     11E2 C |
 IB1 :                          622 C |  IB2 :                          621 C |
 IB3 :                          620 C |  ICKA1 :                        660 C |
 ICKA_END :                     66B C |  IHEMSG :                      2E4D C |
 IHEXER :                      2E79 C |  IKK_1 :                       122A C |
 IMSTR :                       1397 C |  INADR_CHK_AND_WRT :            641 C |
 INBUF :                       9F74 C |  INCSTR :                      1326 C |
 INC_DEC :                     0AB3 C |  INC_DEC_ADDRP :               1443 C |
 INC_ELEMENT :                 263E C |  INC_OPCDTBLE :                1259 C |
 INC_OPCDTBLS :                1251 C |  INC_OPR :                     24BF C |
 INC_RP_E :                    1265 C |  INC_RP_S :                    1261 C |
 INDRSTR :                     13E2 C |  INDSTR :                      13BB C |
 INIRSTR :                     13CE C |  INISTR :                      13AA C |
 INS2 :                         694 C |  INSBRK_1OP :                   611 C |
 INSBRK_2OP :                   617 C |  INSBRK_3OP :                   61D C |
 INSBRK_BRP :                   627 C |  INSBRK_SP :                    633 C |
 INSPOSTSTR :                  11E8 C |  INSTC1 :                       520 C |
*INSTC2 :                       4A4 C |  INSTR :                       136E C |
*INSUPMODE :                      0 - |  INS_EX_OPC :                  0B74 C |
 INS_HLKK :                    0CF7 C |  INS_HL_OPR :                  0B71 C |
 INS_IXRP :                    0E8F C |  INS_JPIX :                    0E64 C |
*INS_JPIX1 :                   0E69 C |  INS_KAKKOL :                  1223 C |
 INS_KAKKOR :                  1228 C |  INS_KKA :                     0CE1 C |
 INS_KKHL :                    0CDB C |  INS_KMR :                     123C C |
 INS_KN2K :                    0C48 C |  INS_KN4KCS :                  1147 C |
 INS_KSPKIX :                  0E77 C |  INS_MISR :                    1237 C |
 INS_N2CRLF :                  0C34 C |  INS_PLSR :                    1232 C |
 INS_RSTG :                    0DFD C |  INS_SPCR :                    122D C |
 INS_SPIX :                    0E86 C |  IN_A_NN :                     1D5F C |
 IN_SELM :                        6 - |  IN_SELT :                     1F42 C |
 IO_B :                       0E000 - |  IR0 :                           64 C |
 IR00 :                          7D C |  IX_CRLF :                     11DA C |
 JPCC_TBLE :                    684 C |  JPCC_TBLS :                    67C C |
 JPHL :                        2422 C |  JPIX :                        241B C |
 JPNNNN :                      2426 C |  JPSTR :                       12EC C |
 JP_EACH :                     1BE5 C |  JP_MC1T :                     1CF7 C |
 JP_MC1TE :                    1CFF C |  JP_MC1TM :                       8 - |
 JRCC_OPR1 :                   143B C |  JRCC_TBLE :                    67C C |
 JRCC_TBLS :                    677 C |  JRCC_TBLS1 :                   678 C |
 JRSTR :                       12EF C |  JR_CCT :                      1D6D C |
 JR_N4CRLF :                   0C78 C |  KCKSTR :                      13FE C |
 KIXYPNK_CRLF :                10F0 C |  KIXYPNK_CS :                  10E7 C |
 KN2K :                        0C54 C |  KN4HK :                       0CE7 C |
 KN4KCRLF :                    0CFD C |  KRNHL :                       1402 C |
 KY_FLG :                      9F69 C |  LANCH1 :                       19C C |
 LANCH10 :                      236 C |  LANCH11 :                      236 C |
 LANCH12 :                      236 C |  LANCH13 :                      236 C |
 LANCH14 :                      236 C |  LANCH15 :                      236 C |
 LANCH16 :                      236 C |  LANCH2 :                       1B0 C |
 LANCH3 :                       1C6 C |  LANCH4 :                       1E8 C |
 LANCH5 :                       20C C |  LANCH6 :                       220 C |
 LANCH7 :                       236 C |  LANCH8 :                       236 C |
 LANCH9 :                       236 C |  LAUNCHER :                     12A C |
 LD1OP :                       0A0A C |  LD1_BASE :                    1F6A C |
*LDA_SP :                      1F65 C |  LDA_SPE :                     1F6A C |
 LDDRSTR :                     13D8 C |  LDDSTR :                      13B3 C |
 LDIR1 :                        929 C |  LDIR2 :                       2B8B C |
 LDIRSTR :                     13C4 C |  LDISTR :                      13A2 C |
 LDNR_C :                      2127 C |  LDNR_N :                         7 - |
 LDNR_T :                      2120 C |  LDSTR :                       1300 C |
 LD_A_KBCK :                    9D2 C |  LD_A_KDEK :                    9E0 C |
 LD_A_KXXK :                    9D5 C | *LD_BC_N4 :                    204B C |
 LD_BC_N40 :                   2051 C |  LD_BC_N41 :                   2063 C |
 LD_BC_N42 :                   206A C |  LD_DE_N4 :                    2075 C |
 LD_E2_TBL :                   1F41 C |  LD_E2_TBL1 :                  1F48 C |
 LD_E2_TBL2 :                  1F4D C |  LD_E2_TBL3 :                  1F51 C |
 LD_E2_TBLE :                  1F58 C |  LD_EN1 :                         7 - |
 LD_EN2 :                         5 - |  LD_EN3 :                         4 - |
 LD_EN4 :                         7 - |  LD_HL_N4 :                    207E C |
 LD_IX_N4 :                    2097 C |  LD_IX_N40 :                   2099 C |
 LD_IX_N42 :                   20AB C |  LD_IY_N4 :                    20B2 C |
 LD_KBCK_A :                    9E6 C |  LD_KDEK_A :                    9EF C |
 LD_KXXK_A :                    9E9 C |  LD_R13 :                      1FEA C |
 LD_R17 :                      1FE5 C |  LD_R171 :                     1FE7 C |
 LD_R25 :                      201C C |  LD_R251 :                     2020 C |
 LD_R26 :                      1FF4 C |  LD_R27 :                      1FEF C |
 LD_R33 :                      2016 C |  LD_R34 :                      2007 C |
 LD_R35 :                      1FD3 C |  LD_R36 :                      200D C |
 LD_R361 :                     2010 C |  LD_R37 :                      1FF9 C |
 LD_R371 :                     1FFC C |  LD_R372 :                     1FFF C |
 LD_RRN :                         8 - |  LD_RR_ :                      1F60 C |
 LD_RXYN_SP :                    0A - |  LD_R_JT :                     1F71 C |
 LD_R_NN_E :                    74B C |  LD_R_NN_S :                    743 C |
 LD_XYNLN :                    20F3 C |  LF :                            0A - |
 LF_OUT :                      1B35 C |  LH0 :                         164A C |
*LH1 :                         1652 C |  LH2 :                         1657 C |
 LH3 :                         1661 C |  LHI0 :                        1667 C |
 LHI1 :                        168B C |  LHI2 :                        169F C |
 LHI20 :                       169E C |  LHI3 :                        16A3 C |
 LHIE :                        16B4 C |  LHS0 :                        16BD C |
 LHS1 :                        16DB C |  LHS2 :                        16EF C |
 LHS20 :                       16F0 C |  LHS3 :                        16F4 C |
 LHSE :                        1712 C |  LHSR :                        1718 C |
 LINE_ASM :                    1AC1 C |  LINE_BUF :                    9F74 C |
*LISTON :                         1 - |  LOADH :                       162C C |
 LOGOP2STR :                   146D C |  LOGOP3STR :                   1481 C |
 LOG_OP_E :                     755 C |  LOG_OP_S :                     74B C |
 LOOP_DEC :                    2B71 C |  LOOP_M8 :                     2C2C C |
 LOP_GNUM :                    2715 C |  LST_END :                      179 C |
 LST_PRG :                      15E C |  LST_PRG1 :                     161 C |
 L_B2 :                         361 C | *MACEXP :                         7 - |
 MAS_1 :                        954 C |  MAS_2 :                        967 C |
 MAS_3 :                        974 C |  MC2_77 :                      20EE C |
 MC_END :                      2254 C |  MC_END2 :                     2274 C |
 MC_END3 :                     2377 C | *MC_END4 :                     25C3 C |
 MC_END41 :                    25B9 C |  MC_SIZE :                     9F73 C |
 MEET_DD :                      6C6 C |  MEET_ED :                      6F0 C |
 MEET_OP1 :                     713 C |  MEET_OP2 :                     71E C |
 MEET_OP3 :                     729 C |  MEET_OP4 :                     734 C |
 MKMC_SH :                     1D95 C |  MKMC_SHED :                   1DA8 C |
 MKOPCSTR :                    11B6 C |  MKREL_STR :                   115F C |
 MK_2NDOPR :                   0A16 C |  MK_2NDOPR1 :                  0A21 C |
 MK_ADR_STR :                   93D C |  MK_BITR :                     0DE0 C |
 MK_BITR_STR :                 0DF8 C |  MK_E1 :                       223A C |
 MK_E11 :                      225A C |  MK_E2 :                       22C7 C |
*MK_E3 :                       1BD3 C |  MK_KIXPNK :                   0EDC C |
 MK_KIXYPNK :                  10F6 C | *MK_KIYPNK :                   0EE1 C |
 MK_KN4K :                     1156 C |  MK_KRK :                      11F6 C |
 MK_KRKCS :                    11FF C |  MK_KRK_1 :                    11F3 C |
 MK_N2CRLF :                   113B C |  MK_N4CRLF :                   1141 C |
 MK_RCS :                      1211 C |  MK_RESR :                     0DE9 C |
 MK_RLCR :                     0DA1 C |  MK_RLR :                      0DB3 C |
 MK_RRCR :                     0DAA C |  MK_RRR :                      0DBC C |
 MK_SLAR :                     0DC5 C |  MK_SRAR :                     0DCE C |
 MK_SRLR :                     0DD7 C |  MK_STR :                      1122 C |
*MOMCPU :                        80 - | *MOMCPUNAME :                 "Z80" - |
 MUL_10 :                       278 C |  MUL_8 :                       2C25 C |
 M_NUM :                          5 - |  NEGSTR :                      1393 C |
*NESTMAX :                      100 - |  NEXT_ASM :                    1AE1 C |
 NEXT_BC1 :                     4C3 C |  NEXT_BC10 :                    5B9 C |
 NEXT_BC11 :                    5C9 C | *NEXT_BC111 :                   5E1 C |
 NEXT_BC2 :                     4E8 C |  NEXT_BC21 :                    4F9 C |
 NEXT_BC22 :                    517 C | *NEXT_BC221 :                   515 C |
 NEXT_BC222 :                   50F C |  NEXT_BC3 :                     530 C |
 NEXT_BC4 :                     547 C |  NEXT_BC5 :                     563 C |
 NEXT_BC6 :                     558 C |  NEXT_BC7 :                     57A C |
 NEXT_BC8 :                     58C C |  NEXT_BC9 :                     5A2 C |
 NEXT_CHAR :                   27E8 C |  NOPSTR :                      133E C |
 NO_API :                      29C3 C |  NO_CR :                          1 - |
 NO_LF :                          2 - |  NO_NUM :                      276E C |
 NO_OPERATE :                  29C2 C |  NO_RAM_AREA :                  66D C |
 NO_RST38_MSG :                2AB7 C |  NO_UPPER :                       4 - |
 NUMLEN :                         7 - |  NUMPLUS :                     1111 C |
 NUM_STRING :                  9F97 C |  NXCHR :                       2809 C |
 NXT_A1 :                      269B C |  NXT_A2 :                      2671 C |
 NXT_A21 :                     2679 C |  NXT_A22 :                     267F C |
 NXT_A3 :                      2682 C |  NXT_A31 :                     268A C |
 NXT_A4 :                      2695 C |  NXT_SR :                      259A C |
 N_END :                       2705 C |  OKRAM :                       2356 C |
 OK_MATCH :                    2700 C |  ONLY_NUM :                    26C1 C |
 OPC_CD :                      9F51 C |  OPERAND_CDS :                 1A4C C |
 OPE_CDS :                     192F C |  OPNMSG :                      2E0D C |
 OPR1_CD :                     9F52 C |  OPR2_CD :                     9F53 C |
 OPR_CD1 :                     1AAC C |  OPR_NUM25 :                   9F54 C |
 OPR_NUM33 :                   9F5B C |  OPR_NUM34 :                   9F59 C |
 OPR_NUM35 :                   9F56 C |  OPR_NUM36 :                   9F5A C |
 OPR_NUM37 :                   9F58 C |  OP_ERR :                      0DF2 C |
 ORSTR :                       1320 C |  OTDRSTR :                     13E7 C |
 OTH_1OP_E :                   1251 C |  OTH_1OP_S :                   1244 C |
 OTH_1OP_TBL :                 1453 C |  OTIRSTR :                     13D3 C |
 OUTDSTR :                     13BF C |  OUTISTR :                     13AE C |
 OUTSTR :                      136A C | *PADDING :                        1 - |
 PATB_CST :                    5B00 - | *PATB_TOP :                    5B00 - |
 PATB_WST :                    5B03 - |  PCST1 :                       30FA C |
 POPSTR :                      132E C |  POP_PUSHRP :                  144B C |
 POP_RP_E :                    1271 C |  POP_RP_S :                    126D C |
 PP_BASE :                     2517 C |  PP_IXIY :                        2 - |
 PP_IXY :                      2515 C |  PP_NO :                          6 - |
 PP_TBL :                      2511 C |  PP_TBLE :                     2517 C |
 PROMPT :                      2E4A C |  PRTDMP :                      1BA8 C |
 PUSHSTR :                     1332 C |  PUSH_RP_E :                   1275 C |
 PUSH_RP_S :                   1271 C |  RAM12K :                         0 - |
 RAM8K :                          1 - |  RAM_B :                       8000 - |
 RAM_E :                       9FFF - |  RAM_SIZ :                     2000 - |
 RD0 :                         189B C |  RD1 :                         18DA C |
 RD10 :                        18C6 C |  RD101 :                       18BA C |
 RD20 :                        18E8 C |  RDHEX :                       294C C |
 RDSA :                        2EE9 C |  RDSAX :                       2F0E C |
 RDSBC :                       2EED C |  RDSBCX :                      2F14 C |
 RDSDE :                       2EF3 C |  RDSDEX :                      2F1A C |
 RDSF :                        2EFF C |  RDSFX :                       2F26 C |
 RDSFX_H :                       2F - |  RDSFX_L :                       26 - |
 RDSF_H :                        2E - |  RDSF_L :                       0FF - |
 RDSHL :                       2EF9 C |  RDSHLX :                      2F20 C |
 RDSI :                        2F35 C |  RDSIX :                       2F04 C |
 RDSIY :                       2F09 C |  RDSPC :                       2F30 C |
 RDSR :                        2F39 C |  RDSSP :                       2F2B C |
 RDTAB :                       2E94 C |  RDUMP :                       1898 C |
 RECORR :                      27E0 C |  RECORR1 :                     27E2 C |
 RECORRECT :                   27B9 C |  RECTYP :                      9F0A C |
 REG :                         1806 C |  REGAF :                       9F0C C |
 REGAFX :                      9F14 C |  REGBC :                       9F0E C |
 REGBCX :                      9F16 C |  REGDE :                       9F10 C |
 REGDEX :                      9F18 C |  REGHL :                       9F12 C |
 REGHLX :                      9F1A C |  REGI :                        9F24 C |
 REGIX :                       9F1C C |  REGIY :                       9F1E C |
 REGPC :                       9F22 C |  REGR :                        9F25 C |
 REGSP :                       9F20 C |  REG_B :                       9F0C C |
 REG_E :                       9F26 C |  REG_XY :                      9F6F C |
*RELAXED :                        0 - |  REL_ADR_C :                    5FE C |
 REPEAT_TRACE :                2B0C C |  RESSTR :                      138F C |
 RES_MCB :                     1C32 C |  RES_XYT :                     1C3A C |
 RETCC_TBLE :                   677 C |  RETCC_TBLS :                   66F C |
 RETISTR :                     13EC C |  RETNSTR :                     13F1 C |
 RETSTR :                      12E8 C |  RET_CD :                      23F3 C |
 RET_NO :                      23EB C |  RG0 :                         1814 C |
 RG1 :                         1818 C |  RG2 :                         182B C |
 RG3 :                         183C C |  RG4 :                         1864 C |
 RG5 :                         1870 C |  RG6 :                         188F C |
 RG7 :                         1892 C |  RGE :                         1895 C |
 RGR :                         1892 C |  RH0 :                         2951 C |
 RH1 :                         2968 C |  RHE :                         2999 C |
 RHE1 :                        29A5 C |  RHLNNXY :                       0D - |
 RLASTR :                      134C C |  RLCASTR :                     1342 C |
 RLCSTR :                      1371 C |  RLC_OR :                         0 - |
 RLDSTR :                      139E C |  RLSTR :                       1379 C |
 RL_OR :                         10 - |  RNA :                         3057 C |
 RNAF :                        12E1 C |  RNAFX :                       12E4 C |
 RNAX :                        3070 C |  RNB :                         305C C |
 RNBC :                        3059 C |  RNBCX :                       3073 C |
 RNBX :                        3077 C |  RNC :                         305E C |
 RNCX :                        307A C |  RND :                         3063 C |
 RNDE :                        3060 C |  RNDEX :                       307D C |
 RNDX :                        3081 C |  RNE :                         3065 C |
 RNEX :                        3084 C |  RNF :                         306E C |
 RNFX :                        3091 C |  RNH :                         306A C |
 RNHL :                        3067 C |  RNHLX :                       3087 C |
 RNHX :                        308B C |  RNI :                         30A0 C |
 RNIX :                        3094 C |  RNIY :                        3097 C |
 RNL :                         306C C |  RNLX :                        308E C |
 RNPC :                        309D C |  RNR :                         30A2 C |
 RNSP :                        309A C |  RNTAB :                       2F3D C |
 RNTABA :                      2F87 C |  RNTABB :                      2F95 C |
 RNTABBC :                     2FA9 C |  RNTABC :                      2FB7 C |
 RNTABD :                      2FC5 C |  RNTABDE :                     2FD9 C |
 RNTABE :                      2FE7 C |  RNTABF :                      2FF5 C |
 RNTABH :                      3003 C |  RNTABHL :                     3017 C |
 RNTABI :                      3033 C |  RNTABL :                      3025 C |
 RNTABP :                      3047 C |  RNTABS :                      304F C |
 ROM_B :                          0 - |  RRASTR :                      1350 C |
 RRCASTR :                     1347 C |  RRCSTR :                      1375 C |
 RRC_OR :                         8 - |  RRDSTR :                      139A C |
 RRSTR :                       137C C |  RR_OR :                         18 - |
 RST30H_IN :                   29A7 C |  RST38H_IN :                   2A3B C |
 RST38MSG :                    2B41 C |  RSTR_BPT :                    2B21 C |
 RSTR_TPT :                    2B15 C |  RSTSTR :                      12FC C |
 RST_CD :                      23CE C |  RST_NO :                      23C6 C |
 RST_TBLE :                     694 C |  RST_TBLS :                     68C C |
 R_HL_NN :                     1F58 C |  R_HL_NNE :                    1F65 C |
 SADDR :                       9F07 C |  SAVEH :                       171B C |
 SBCHLBC1 :                    30C6 C |  SBCHLBC2 :                    30C9 C |
 SBCHLDE1 :                    30E1 C |  SBCHLDE2 :                    30E4 C |
 SBCSTR :                      1314 C |  SBC_HLBC :                    30B4 C |
 SBC_HLDE :                    30CF C |  SCFSTR :                      135C C |
 SCH_NEXT :                    26EA C |  SCH_OPECODE :                 26D9 C |
 SCH_OPERAND1 :                26CD C |  SCH_OPERAND1_1 :              26D3 C |
 SETBPADR :                     305 C |  SETBYTEC :                    1BB8 C |
 SETDSADR :                    1BAE C |  SETM :                        15AC C |
 SETSTR :                      13F6 C |  SET_BITNO :                   0E0A C |
 SET_BP :                      15A0 C |  SET_BP1 :                      2D7 C |
 SET_MCB :                     1C13 C |  SET_TM :                       3DA C |
 SET_XYT :                     1C1B C |  SH0 :                         1727 C |
 SH1 :                         172B C |  SH2 :                         1759 C |
 SH3 :                         1762 C |  SH4 :                         177B C |
 SHE :                         1756 C |  SHEMSG :                      2E5A C |
 SHL0 :                        1791 C |  SHL00 :                       1784 C |
 SHLI0 :                       17BC C |  SHLS :                        17D2 C |
 SHLS0 :                       17F1 C |  SH_0 :                        26DF C |
 SH_1 :                        26E0 C | *SIZE :                        9F0B C |
 SKIPSP :                      293B C |  SKIP_CR :                     291E C |
 SKIP_LF :                     292F C |  SKIP_NEXT :                   26EF C |
 SKIP_UPPER :                  28EA C |  SKPA_ADR :                    1ADB C |
 SKP_OUTM :                    1B8E C |  SKP_RMSG :                    2ADC C |
 SKP_SP :                      275D C |  SKP_TBP :                     1585 C |
 SLASTR :                      137F C |  SLA_OR :                        20 - |
 SM0 :                         15C8 C |  SM1 :                         15C9 C |
 SM2 :                         15F1 C |  SM3 :                         15FE C |
 SM4 :                         160A C |  SRASTR :                      1383 C |
 SRA_OR :                        28 - |  SRECER :                      2E87 C |
 SRLSTR :                      1387 C |  SRL_OR :                        38 - |
 SR_BASE :                     2550 C |  SR_IY1 :                      25B0 C |
 SR_LOOKFOR :                  257F C |  SR_NUM :                         8 - |
 STACK :                       9EC0 - |  STACKM :                      9F00 - |
*START :                          0 C |  STPBRK_MSG :                  2B4B C |
 STP_CHK :                      469 C |  STROUT :                      2823 C |
 ST_COPY :                     121A C |  ST_MC1 :                      224C C |
 ST_MC11 :                     224E C |  ST_MUL8 :                     2C34 C |
 SUBSTR :                      1310 C |  SV_NNKR :                     110B C |
 SX_ERR :                      263C C |  TADR_CHK :                     455 C |
 TASM_ADR :                    9F4D C |  TC_CNT :                      9F32 C |
 TERR_MSG :                     5F4 C |  THREE_OPTBL :                  755 C |
 THREE_OPTBLE :                 759 C |  THREE_OPTBL_E :                75D C |
*TIME :                  "20:41:37" - |  TMPB_ADR :                    9F49 C |
 TMPB_F :                      9F47 C |  TMPB_OP :                     9F48 C |
 TMPT :                        9F34 C |  TMP_HL :                      9FA0 C |
 TM_MODE :                     9F31 C |  TM_MSG_0 :                     3EB C |
 TM_MSG_I :                     3FA C |  TM_MSG_S :                     400 C |
 TPT1_ADR :                    9F39 C |  TPT1_F :                      9F37 C |
 TPT1_OP :                     9F38 C |  TPT2_ADR :                    9F3D C |
 TPT2_F :                      9F3B C |  TPT2_OP :                     9F3C C |
 TP_CHK1 :                     2A8F C |  TP_CHK2 :                     2A9F C |
 TP_CMD :                       408 C |  TP_MD_ON :                     42F C |
 TP_MODE :                     9F30 C |  TP_MSG_0 :                     440 C |
 TP_MSG_OFF :                   44F C |  TP_MSG_ON :                    44A C |
 TP_N1 :                        416 C |  TP_N2 :                        41F C |
 TRACE_CMD :                    388 C |  TRACE_MSG :                   2B54 C |
*TRUE :                           1 - |  TWO_OPTBL :                    743 C |
 TWO_OPTBL_E :                  755 C |  T_NO_KY :                     2AF6 C |
 T_OP1 :                        484 C |  T_OP11 :                       47C C |
 T_OP_CHK :                     4A0 C |  UART8251 :                       1 - |
*UARTCR :                     0E001 - |  UARTCR_8251 :                    1 - |
*UARTDR :                     0E000 - |  UARTDR_8251 :                    0 - |
 UARTMEM :                        0 - |  UARTPIC :                        0 - |
 UPPER :                       2943 C |  UP_BI :                        276 C |
*VERSION :                     142F - |  WORK_B :                      9F00 - |
 WSTART :                       0CD C |  WS_CHK1 :                     2A02 C |
 WS_CHK2 :                     2A0F C |  WS_CHK3 :                     2A1C C |
 WS_CHK4 :                     2A29 C |  WS_CHK5 :                     2A36 C |
 XORSTR :                      131C C |  XY_SRTP :                     9F71 C |

   1166 symbols
     44 unused symbols

 AS V1.42 Beta [Bld 232] - Source File emu8085mon_RevB03_8k.asm - Page 3 - 12/29/2022 20:41:37


  Code Pages:
  ----------

STANDARD (0 changed characters)

1 code page

0.17 seconds assembly time

   9104 lines source file
      2 passes
      0 errors
      0 warnings
